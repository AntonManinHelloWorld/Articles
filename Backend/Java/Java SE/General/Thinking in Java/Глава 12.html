<!DOCTYPE html>
<html dir="ltr" class="client-nojs" lang="ru"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8"><title>Глава 12 Thinking in Java 4th edition — WikiJava: Wiki of Java: викифицированные книги и статьи по Java</title>
<meta name="generator" content="MediaWiki 1.22.2">
<link rel="shortcut icon" href="http://wikijava.it-cache.net/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="http://wikijava.it-cache.net/opensearch_desc.php" title="WikiJava: Wiki of Java: викифицированные книги и статьи по Java (ru)">
<link rel="EditURI" type="application/rsd+xml" href="http://wikijava.it-cache.net/api.php@action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="WikiJava: Wiki of Java: викифицированные книги и статьи по Java&nbsp;— Atom-лента" href="http://wikijava.it-cache.net/index.php@title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F%253A%D0%A1%D0%B2%D0%B5%D0%B6%D0%B8%D0%B5_%D0%BF%D1%80%D0%B0%D0%B2%D0%BA%D0%B8&amp;feed=atom">
<link rel="stylesheet" href="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2012_files/style3.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<style>a:lang(ar),a:lang(ckb),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wjava2-wj_:resourceloader:filter:minify-css:7:32e7e505403c81fe0a24e297ef166436 */</style>

<script src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2012_files/style1.css"></script><script src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2012_files/load.html"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Глава_12_Thinking_in_Java_4th_edition","wgTitle":"Глава 12 Thinking in Java 4th edition","wgCurRevisionId":36,"wgRevisionId":36,"wgArticleId":26,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Книги","Java"],"wgBreakFrames":false,"wgPageContentLanguage":"ru","wgPageContentModel":"wikitext","wgSeparatorTransformTable":[",\t."," \t,"],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],"wgMonthNamesShort":["","янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"],"wgRelevantPageName":"Глава_12_Thinking_in_Java_4th_edition","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgVectorEnabledModules":{"collapsiblenav":true,"collapsibletabs":true,"editwarning":true,"expandablesearch":false,"footercleanup":false,"sectioneditlinks":false,"simplesearch":true,"experiments":true}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"vector-simplesearch":1,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,
"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"useeditwarning":1,"prefershttps":1,"language":"ru","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"variant":"ru"});},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: wjava2-wj_:resourceloader:filter:minify-js:7:07bb1f4d2452379e70abca47c4cde6d9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-java5 {line-height: normal;}
.source-java5 li, .source-java5 pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for java5
 * CSS class: source-java5, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.java5.source-java5 .de1, .java5.source-java5 .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.java5.source-java5  {font-family:monospace;}
.java5.source-java5 .imp {font-weight: bold; color: red;}
.java5.source-java5 li, .java5.source-java5 .li1 {font-weight: normal; vertical-align:top;}
.java5.source-java5 .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.java5.source-java5 .li2 {font-weight: bold; vertical-align:top;}
.java5.source-java5 .kw1 {color: #000000;  font-weight: bold;}
.java5.source-java5 .kw2 {color: #000000; font-weight: bold;}
.java5.source-java5 .kw3 {color: #006600; font-weight: bold;}
.java5.source-java5 .kw4 {color: #006600; font-weight: bold;}
.java5.source-java5 .kw5 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw6 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw7 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw8 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw9 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw10 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw11 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw12 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw13 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw14 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw15 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw16 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw17 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw18 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw19 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw20 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw21 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw22 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw23 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw24 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw25 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw26 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw27 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw28 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw29 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw30 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw31 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw32 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw33 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw34 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw35 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw36 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw37 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw38 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw39 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw40 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw41 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw42 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw43 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw44 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw45 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw46 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw47 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw48 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw49 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw50 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw51 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw52 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw53 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw54 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw55 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw56 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw57 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw58 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw59 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw60 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw61 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw62 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw63 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw64 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw65 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw66 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw67 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw68 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw69 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw70 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw71 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw72 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw73 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw74 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw75 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw76 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw77 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw78 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw79 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw80 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw81 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw82 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw83 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw84 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw85 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw86 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw87 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw88 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw89 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw90 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw91 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw92 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw93 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw94 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw95 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw96 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw97 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw98 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw99 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw100 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw101 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw102 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw103 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw104 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw105 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw106 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw107 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw108 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw109 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw110 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw111 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw112 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw113 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw114 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw115 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw116 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw117 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw118 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw119 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw120 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw121 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw122 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw123 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw124 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw125 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw126 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw127 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw128 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw129 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw130 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw131 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw132 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw133 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw134 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw135 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw136 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw137 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw138 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw139 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw140 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw141 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw142 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw143 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw144 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw145 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw146 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw147 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw148 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw149 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw150 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw151 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw152 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw153 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw154 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw155 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw156 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw157 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw158 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw159 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw160 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw161 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw162 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw163 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw164 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw165 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw166 {color: #003399; font-weight: bold;}
.java5.source-java5 .co1 {color: #666666; font-style: italic;}
.java5.source-java5 .co2 {color: #006699;}
.java5.source-java5 .co3 {color: #008000; font-style: italic; font-weight: bold;}
.java5.source-java5 .coMULTI {color: #666666; font-style: italic;}
.java5.source-java5 .es0 {color: #000099; font-weight: bold;}
.java5.source-java5 .br0 {color: #009900;}
.java5.source-java5 .sy0 {color: #339933;}
.java5.source-java5 .st0 {color: #0000ff;}
.java5.source-java5 .nu0 {color: #cc66cc;}
.java5.source-java5 .me1 {color: #006633;}
.java5.source-java5 .me2 {color: #006633;}
.java5.source-java5 .ln-xtra, .java5.source-java5 li.ln-xtra, .java5.source-java5 div.ln-xtra {background-color: #ffc;}
.java5.source-java5 span.xtra { display:block; }

/*]]>*/
</style><!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Глава_12_Thinking_in_Java_4th_edition skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<h1 id="firstHeading" class="firstHeading" lang="ru"><span dir="auto">Глава 12 Thinking in Java 4th edition</span></h1>
			<div id="bodyContent">
								<div id="siteSub">Материал из WikiJava: Wiki of Java: викифицированные книги и статьи по Java</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Перейти к:					<a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#mw-navigation">навигация</a>, 					<a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#p-search">поиск</a>
				</div>
				<div id="mw-content-text" dir="ltr" class="mw-content-ltr" lang="ru"><table style="clear: right; margin-bottom: .5em; float: right; padding: .5em 0 .8em 1.4em; background: none; width: auto;" cellpadding="0" cellspacing="0">
<tbody><tr>
<td> <div id="toc" class="toc"><div id="toctitle"><h2>Содержание</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.9E.D0.91.D0.A0.D0.90.D0.91.D0.9E.D0.A2.D0.9A.D0.90_.D0.9E.D0.A8.D0.98.D0.91.D0.9E.D0.9A_.D0.98_.D0.98.D0.A1.D0.9A.D0.9B.D0.AE.D0.A7.D0.95.D0.9D.D0.98.D0.99"><span class="tocnumber">1</span> <span class="toctext"><b>ОБРАБОТКА ОШИБОК И ИСКЛЮЧЕНИЙ</b></span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.9E.D1.81.D0.BD.D0.BE.D0.B2.D0.BD.D1.8B.D0.B5_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D1.8F"><span class="tocnumber">1.1</span> <span class="toctext">Основные исключения</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.90.D1.80.D0.B3.D1.83.D0.BC.D0.B5.D0.BD.D1.82.D1.8B_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D1.8F"><span class="tocnumber">1.2</span> <span class="toctext">Аргументы исключения</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.9F.D0.B5.D1.80.D0.B5.D1.85.D0.B2.D0.B0.D1.82_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9"><span class="tocnumber">1.3</span> <span class="toctext">Перехват исключений</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.9E.D0.B1.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D1.87.D0.B8.D0.BA.D0.B8_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9"><span class="tocnumber">1.4</span> <span class="toctext">Обработчики исключений</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.9F.D1.80.D0.B5.D1.80.D1.8B.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B2_.D1.81.D1.80.D0.B0.D0.B2.D0.BD.D0.B5.D0.BD.D0.B8.D0.B8_.D1.81_.D0.B2.D0.BE.D0.B7.D0.BE.D0.B1.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5.D0.BC"><span class="tocnumber">1.5</span> <span class="toctext">Прерывание в сравнении с возобновлением</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D1.81.D0.BE.D0.B1.D1.81.D1.82.D0.B2.D0.B5.D0.BD.D0.BD.D1.8B.D1.85_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9"><span class="tocnumber">1.6</span> <span class="toctext">Создание собственных исключений</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.A0.D0.B5.D0.B3.D0.B8.D1.81.D1.82.D1.80.D0.B0.D1.86.D0.B8.D1.8F_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9"><span class="tocnumber">1.7</span> <span class="toctext">Регистрация исключений</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.A1.D0.BF.D0.B5.D1.86.D0.B8.D1.84.D0.B8.D0.BA.D0.B0.D1.86.D0.B8.D0.B8_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9"><span class="tocnumber">1.8</span> <span class="toctext">Спецификации исключений</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.9F.D0.B5.D1.80.D0.B5.D1.85.D0.B2.D0.B0.D1.82_.D0.BF.D1.80.D0.BE.D0.B8.D0.B7.D0.B2.D0.BE.D0.BB.D1.8C.D0.BD.D1.8B.D1.85_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9"><span class="tocnumber">1.9</span> <span class="toctext">Перехват произвольных исключений</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.A2.D1.80.D0.B0.D1.81.D1.81.D0.B8.D1.80.D0.BE.D0.B2.D0.BA.D0.B0_.D1.81.D1.82.D0.B5.D0.BA.D0.B0"><span class="tocnumber">1.10</span> <span class="toctext">Трассировка стека</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.9F.D0.BE.D0.B2.D1.82.D0.BE.D1.80.D0.BD.D0.BE.D0.B5_.D0.B2.D0.BE.D0.B7.D0.B1.D1.83.D0.B6.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D1.8F"><span class="tocnumber">1.11</span> <span class="toctext">Повторное возбуждение исключения</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.A6.D0.B5.D0.BF.D0.BE.D1.87.D0.BA.D0.B8_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9"><span class="tocnumber">1.12</span> <span class="toctext">Цепочки исключений</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.A1.D1.82.D0.B0.D0.BD.D0.B4.D0.B0.D1.80.D1.82.D0.BD.D1.8B.D0.B5_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D1.8F_Java"><span class="tocnumber">1.13</span> <span class="toctext">Стандартные исключения <i>Java</i></span></a></li>
<li class="toclevel-2 tocsection-15"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.97.D0.B0.D0.B2.D0.B5.D1.80.D1.88.D0.B5.D0.BD.D0.B8.D0.B5_.D1.81_.D0.BF.D0.BE.D0.BC.D0.BE.D1.89.D1.8C.D1.8E_finally"><span class="tocnumber">1.14</span> <span class="toctext">Завершение с помощью finally</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.94.D0.BB.D1.8F_.D1.87.D0.B5.D0.B3.D0.BE_.D0.BD.D1.83.D0.B6.D0.B5.D0.BD_.D0.B1.D0.BB.D0.BE.D0.BA_finally.3F"><span class="tocnumber">1.15</span> <span class="toctext">Для чего нужен блок finally?</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_finally_.D1.81_return"><span class="tocnumber">1.16</span> <span class="toctext">Использование finally с return</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.9F.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D0.B0_.D0.BF.D0.BE.D1.82.D0.B5.D1.80.D1.8F.D0.BD.D0.BD.D1.8B.D1.85_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9"><span class="tocnumber">1.17</span> <span class="toctext">Проблема потерянных исключений</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.9E.D0.B3.D1.80.D0.B0.D0.BD.D0.B8.D1.87.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BF.D1.80.D0.B8_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B8_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9"><span class="tocnumber">1.18</span> <span class="toctext">Ограничения при использовании исключений</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.9A.D0.BE.D0.BD.D1.81.D1.82.D1.80.D1.83.D0.BA.D1.82.D0.BE.D1.80.D1.8B"><span class="tocnumber">1.19</span> <span class="toctext">Конструкторы</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.98.D0.B4.D0.B5.D0.BD.D1.82.D0.B8.D1.84.D0.B8.D0.BA.D0.B0.D1.86.D0.B8.D1.8F_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9"><span class="tocnumber">1.20</span> <span class="toctext">Идентификация исключений</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.90.D0.BB.D1.8C.D1.82.D0.B5.D1.80.D0.BD.D0.B0.D1.82.D0.B8.D0.B2.D0.BD.D1.8B.D0.B5_.D1.80.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D1.8F"><span class="tocnumber">1.21</span> <span class="toctext">Альтернативные решения</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.9F.D0.B5.D1.80.D0.B5.D0.B4.D0.B0.D1.87.D0.B0_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9_.D0.BD.D0.B0_.D0.BA.D0.BE.D0.BD.D1.81.D0.BE.D0.BB.D1.8C"><span class="tocnumber">1.22</span> <span class="toctext">Передача исключений на консоль</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.9F.D1.80.D0.B5.D0.BE.D0.B1.D1.80.D0.B0.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BA.D0.BE.D0.BD.D1.82.D1.80.D0.BE.D0.BB.D0.B8.D1.80.D1.83.D0.B5.D0.BC.D1.8B.D1.85_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9_.D0.B2_.D0.BD.D0.B5.D0.BA.D0.BE.D0.BD.D1.82.D1.80.D0.BE.D0.BB.D0.B8.D1.80.D1.83.D0.B5.D0.BC.D1.8B.D0.B5"><span class="tocnumber">1.23</span> <span class="toctext">Преобразование контролируемых исключений в неконтролируемые</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.9E.D1.81.D0.BD.D0.BE.D0.B2.D0.BD.D1.8B.D0.B5_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D0.B0_.D0.BE.D0.B1.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.BA.D0.B8_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9"><span class="tocnumber">1.24</span> <span class="toctext">Основные правила обработки исключений</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#.D0.A0.D0.B5.D0.B7.D1.8E.D0.BC.D0.B5"><span class="tocnumber">1.25</span> <span class="toctext">Резюме</span></a></li>
</ul>
</li>
</ul>
</div>

</td></tr></tbody></table>
<h1><span class="mw-headline" id=".D0.9E.D0.91.D0.A0.D0.90.D0.91.D0.9E.D0.A2.D0.9A.D0.90_.D0.9E.D0.A8.D0.98.D0.91.D0.9E.D0.9A_.D0.98_.D0.98.D0.A1.D0.9A.D0.9B.D0.AE.D0.A7.D0.95.D0.9D.D0.98.D0.99"><b>ОБРАБОТКА ОШИБОК И ИСКЛЮЧЕНИЙ</b></span></h1>
<p>Один из основополагающих принципов философии <i>Java</i> состоит в том, что «плохо написанная программа не должна запускаться
</p><p>В идеале ошибки должны обнаруживаться во время компиляции, перед 
запуском программы. Однако не все ошибки удается выявить в это время. 
Остальные проблемы приходйтся решать во время работы программы, с 
помощью механизма, который позволяет источнику ошибки передать 
необходимую информацию о ней получателю — а последний справляется с 
возникшими трудностями.
Усовершенствованная система восстановления после ошибок входит в число 
важнейших факторов, влияющих на надежность кода. Восстановление особенно
 важно в языке <i>Java</i>, на котором часто пишутся программные 
компоненты, используемые другими сторонами. Надежная система может быть 
построена только из надежных компонентов. Унифицированная модель 
передачи информации об ошибках в <i>Java</i> позволяет компонентам 
передавать информацию о возникших проблемах в клиентский код.
Механизм исключений значительно упрощает создание больших надежных 
программ, уменьшает объем необходимого кода и повышает уверенность в 
том, что в приложении не будет необработанной ошибки. Освоить работу с 
исключениями несложно, и это. одна из языковых возможностей, способных 
принести немедленную и значительную выгоду в ваших проектах. В этой 
главе будет показано, как правильно организовать обработку исключений в 
программе, а также как сгенерировать собственное исключение, если 
какой-то из ваших методов сталкивается с непредусмотренными трудностями.
</p>
<h2><span class="mw-headline" id=".D0.9E.D1.81.D0.BD.D0.BE.D0.B2.D0.BD.D1.8B.D0.B5_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D1.8F">Основные исключения</span></h2>
<p>Исключительной ситуацией называется проблема, из-за которой 
нормальное продолжение работы метода или части программы, выполняющихся в
 данный момент, становится невозможным. Важно отличать исключительную 
ситуацию от «обычных» ошибок, когда в текущем контексте имеется 
достаточно информации для преодоления затруднений. В исключительной 
ситуации обработать исключение в текущем контексте невозможно, потому 
что вы не располагаете необходимой информацией. Остается единственный 
выход — покинуть текущий контекст и передать проблему на более высокий 
уровень. Именно это и происходит при выдаче исключения.
</p><p>Простейшим примером является деление. Потенциальное деление на 
нуль может быть выявлено проверкой соответствующего условия. Но что 
делать, если знаменатель оказался нулем? Возможно, в контексте текущей 
задачи известно, как следует поступить с нулевым знаменателем. Но, если 
нулевой знаменатель возник неожиданно, деление в принципе невозможно, и 
тогда необходимо возбудить исключение, а не продолжать исполнение 
программы.
</p><p>При возбуждении исключения происходит сразу несколько вещей. 
Во-первых, создается объект, представляющий исключение, — точно так же, 
как и любой другой объект в <i>Java</i> (в куче, оператором <i><b>new</b></i>).
 Далее текущий поток исполнения (тот самый, где произошла ошибка) 
останавливается, и ссылка на объект, представляющий исключение, 
извлекается из текущего контекста. С этого момента включается механизм 
обработки исключений, который начинает поиск подходящего места программы
 для передачи исключения. Таким местом является обработчик исключений, 
который пытается решить возникшую проблему так, чтобы программа могла 
снова попытаться выполнить проблемную операцию или просто продолжила 
свое выполнение.
</p><p>В качестве простого примера выдачи исключения представьте ссылку на объект <i><b>t</b></i>.
 Возможно, полученная вами ссылка не была инициализирована; стоит 
проверить это обстоятельство, прежде чем вызывать методы с 
использованием этой ссылки. Чтобы передать информацию об ошибке на более
 высокий уровень, создайте объект, представляющий передаваемую 
информацию, и «запустите» его из текущего контекста. Тем самым вы 
возбудите исключение. Вот как это выглядит:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"> <span class="kw1">if</span><span class="br0">(</span>t == <span class="kw4">null</span><span class="br0">)</span> <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">NullPointerException</span><span class="br0">(</span> <span class="br0">)</span><span class="sy0">;</span></pre></div></div>
<p>Вырабатывается исключение, которое позволяет вам — в текущем 
контексте — переложить с себя ответственность, не задумываясь о будущем.
 Ошибка, словно по волшебству, обрабатывается где-то в другом месте 
(вскоре мы узнаем, где именно).
</p><p>Один из основополагающих аспектов исключений состоит в том, что 
при возникновении нежелательных ситуаций выполнение программы не 
продолжается по обычному пути. Исключения позволяют вам (в крайнем 
случае) остановить программу и сообщить о возникших трудностях или (в 
идеале) разобраться с проблемой и вернуть программу в стабильное 
состояние.
</p>
<h2><span class="mw-headline" id=".D0.90.D1.80.D0.B3.D1.83.D0.BC.D0.B5.D0.BD.D1.82.D1.8B_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D1.8F">Аргументы исключения</span></h2>
<p>Исключения, как и любые объекты <i>Java</i>, создаются в куче оператором <i><b>new</b></i>,
 который выделяет память и вызывает конструктор. У всех стандартных 
исключений существует два конструктора: стандартный (по умолчанию) и 
другой, со строковым аргументом, в котором можно разместить подходящую 
информацию об исключении:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"> <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">NullPointerException</span><span class="br0">(</span><span class="st0">"t = null"</span><span class="br0">)</span><span class="sy0">;</span></pre></div></div>
<p>Переданная строка потом может быть извлечена различными способами, о чем будет рассказано позже.Ключевое слово <i><b>throw</b></i> влечет за собой ряд довольно интересных действий. Как правило, сначала <i><b>new</b></i> используется для создания объекта, представляющего условие происшедшей ошибки. Ссылка на указанный объект передается команде <i><b>throw</b></i>.
 Фактически этот объект «возвращается» методом, несмотря на то что для 
возвращаемого объекта обычно предусмотрен совсем другой тип. Таким 
образом, упрощенно можно говорить об обработке исключений как об 
альтернативном механизме возврата из исполняемого метода (впрочем, с 
этой аналогией не стоит заходить слишком далеко). Возбуждение исключений
 также позволяет выходить из простых блоков видимости. В обоих случаях 
возвращается объект исключения и происходит выход из текущего метода или
 блока.
Но все сходство с обычным возвратом из метода на этом заканчивается, 
поскольку при возврате из исключения вы попадаете совсем не туда, куда 
попали бы при нормальном вызове метода. (Обработчик исключения может 
находиться очень «далеко» — на расстоянии нескольких уровней в стеке 
вызова — от метода, где возникла исключительная ситуация.)
</p><p>Вообще говоря, можно возбудить любой тип исключений, происходящих от объекта <i><b>Throwable</b></i>
 (корневой класс иерархии исключений). Обычно для разных типов ошибок 
возбуждаются разные типы исключений. Информация о случившейся ошибке как
 содержится внутри объекта исключения, так и указывается косвенно в 
самом типе этого объекта, чтобы кто-то на более высоком уровне сумел 
выяснить, как поступить с исключением. (Нередко именно тип объекта 
исключения является единственно доступной информацией об ошибке, в то 
время как внутри объекта никакой полезной информации нет.)
</p>
<h2><span class="mw-headline" id=".D0.9F.D0.B5.D1.80.D0.B5.D1.85.D0.B2.D0.B0.D1.82_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9">Перехват исключений</span></h2>
<p>Чтобы увидеть, как перехватываются ошибки, сначала следует усвоить 
понятие защищенной секции — той части программы, в которой могут 
произойти исключения и за которой следует специальный блок, отвечающий 
за обработку этих исключений.
</p><p><b>Блок try</b>
</p><p>Если вы «находитесь» внутри метода и инициируете исключение (или 
это делает другой вызванный метод), этот метод завершит работу при 
возникновении исключения. Но если вы не хотите, чтобы оператор <i><b>throw</b></i> завершил работу метода, разместите в методе специальный блок для перехвата исключения — так называемый блок <i><b>try</b></i>. Этот блок представляет собой простую область действия, которой предшествует ключевое слово 
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="kw2">try</span>:
     <span class="kw2">try</span> <span class="br0">{</span>
          <span class="co1">// Фрагмент, способный возбуждать исключения</span>
    <span class="br0">}</span></pre></div></div>
<p>Если бы не обработка исключений, для тщательной проверки ошибок вам 
пришлось бы добавить к вызову каждого метода дополнительный код для 
проверки ошибок — даже при многократном вызове одного метода. С 
обработкой исключений весь код размещается в блоке <i><b>try</b></i>, 
который и перехватывает все возможные исключения в одном месте. А это 
означает, что вашу программу становится значительно легче писать и 
читать, поскольку выполняемая задача не сме­шивается с обработкой 
ошибок.
</p>
<h2><span class="mw-headline" id=".D0.9E.D0.B1.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D1.87.D0.B8.D0.BA.D0.B8_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9">Обработчики исключений</span></h2>
<p>Конечно, возбужденное исключение в конечном итоге должно быть где-то 
обработано. Этим местом является обработчик исключений, который 
создается для каждого исключения, которое вы хотите перехватить. 
Обработчики исключений размещаются прямо за блоком <i><b>try</b></i> и обозначаются ключевым словом <i><b>catch</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"> <span class="kw2">try</span> <span class="br0">{</span>
      <span class="co1">// Часть программы, способная возбуждать исключения </span>
      <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>Typel idl<span class="br0">)</span> <span class="br0">{</span>
      <span class="co1">// Обработка исключения Typel </span>
      <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>Туре<span class="nu0">2</span> id2<span class="br0">)</span> <span class="br0">{</span>
      <span class="co1">// Обработка исключения Type2 </span>
      <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>ТуреЗ id3<span class="br0">)</span> <span class="br0">{</span>
      <span class="co1">// Обработка исключения ТуреЗ</span>
      <span class="br0">}</span> <span class="co1">//И Т.д.</span></pre></div></div>
<p>Каждое предложение <i><b>catch</b></i> (обработчик исключения) напоминает маленький метод, принимающий один и только один аргумент определенного типа. Идентификатор (<i><b>idl, id2</b></i>
 и т. д.) может использоваться внутри обработчика точно так же, как и 
метод распоряжается своими аргументами. Иногда этот идентификатор 
остается невостребованным, так как тип исключения дает достаточно 
информации для его обработки, но тем не менее присутствует он всегда.
Обработчики всегда следуют прямо за блоком <i><b>try</b></i>. При 
возникновении исключения механизм обработки исключений ищет первый из 
обработчиков исключений, аргумент которого соответствует текущему типу 
исключения. После этого он передает управление в блок <i><b>catch</b></i>, и таким образом исключение считается обработанным. После выполнения предложения <i><b>catch</b></i> поиск обработчиков исключения прекращается. Выполняется только одна секция <i><b>catch</b></i>, соответствующая типу исключения; в этом отношении обработка исключений отличается от команды <i><b>switch</b></i>, где нужно дописывать <i><b>break</b></i> после каждого <i><b>case</b></i>, чтобы предотвратить исполнение всех прочих <i><b>case</b></i>.
Заметьте также, что внутри блока <i><b>try</b></i> могут вызываться различные методы, способные породить одинаковые типы исключения, но обработчик понадобится всего один.
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.9F.D1.80.D0.B5.D1.80.D1.8B.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B2_.D1.81.D1.80.D0.B0.D0.B2.D0.BD.D0.B5.D0.BD.D0.B8.D0.B8_.D1.81_.D0.B2.D0.BE.D0.B7.D0.BE.D0.B1.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5.D0.BC">Прерывание в сравнении с возобновлением</span></h2>
<p>В теории обработки исключений имеется две основные модели. Модель прерывания (которое используется в <i>Java</i> и <i>C++</i>)
 предполагает, что ошибка настолько серьезна, что при возникновении 
исключения продолжить исполнение невозможно. Кто бы ни возбудил 
исключение, сам факт его выдачи означает, что исправить ситуацию «на 
месте» невозможно и возвращать управление обратно не нужно.
Альтернативная модель называется возобновлением. Она подразумевает, что 
обработчик ошибок сделает что-то для исправления ситуации, после чего 
предпринимается попытка повторить неудавшуюся операцию в надежде на 
успешный исход. В таком случае исключение больше напоминает вызов метода
 — чтобы применить модель возобновления в <i>Java</i>, вам придется 
пойти именно по этому пути (то есть не возбуждать исключение, а вызвать 
метод, способный решить проблему). Также можно создать блок <i><b>try</b></i> внутри цикла <i><b>while</b></i>,
 который станет снова и снова обращаться к этому блоку, пока не будет 
достигнут нужный результат.
Исторически сложилось, что программисты, использующие операционные 
системы с поддержкой возобновления, со временем переходили к модели 
прерывания, забывая другую модель. Хотя идея возобновления выглядит 
привлекательно, она не настолько полезна на практике. Основная причина 
кроется в обратной связи: обработчик ошибки часто должен знать, где 
произошло исключение и содержать специальный код для каждого отдельного 
места ошибки. А это усложняет написание и поддержку программ, особенно 
для больших систем, где исключения могут быть сгенерированы во многих 
различных местах.
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D1.81.D0.BE.D0.B1.D1.81.D1.82.D0.B2.D0.B5.D0.BD.D0.BD.D1.8B.D1.85_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9">Создание собственных исключений</span></h2>
<p>Ваш выбор не ограничивается использованием уже существующих в <i>Java</i> исключений. Иерархия исключений <i>JDK</i>
 не может предусмотреть все возможные ошибки, поэтому вы вправе 
создавать собственные типы исключений для обозначения специфических 
ошибок вашей программы.
Для создания собственного класса исключения вам придется определить его 
производным от уже существующего типа — желательно наиболее близкого к 
вашей ситуации (хоть это и не всегда возможно). В простейшем случае 
создается класс с конструктором по умолчанию:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/InheritingExceptions.java</span>
<span class="co1">// Создание собственного исключения</span>
&nbsp;
<span class="kw2">class</span> SimpleException <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span><span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> InheritingExceptions <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw3">void</span> f<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> SimpleException <span class="br0">{</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Возбуждаем SimpleException из f()"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">throw</span> <span class="kw2">new</span> SimpleException<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    InheritingExceptions sed = <span class="kw2">new</span> InheritingExceptions<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      sed.<span class="me1">f</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>SimpleException e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Перехвачено!"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>Возбуждаем SimpleExceptі on из f() 
Перехвачено! 
</pre>
<p>&lt;/spoiler&gt;
Компилятор создает конструктор по умолчанию, который автоматически 
вызывает конструктор базового класса. Конечно, в этом случае вы 
лишаетесь конструктора вида <i><b>SimpleException(String)</b></i>, но на
 практике он не слишком часто используется. Как вы еще увидите, наиболее
 важно в исключении именно имя класса, так что в основном исключений, 
похожих на созданное выше, будет достаточно.
В примере результаты работы выводятся на консоль. Впрочем, их также 
можно направить в стандартный поток ошибок, что достигается 
использованием класса <i><b>System.err</b></i>. Обычно это правильнее, чем выводить в поток <i><b>System.out</b></i>, который может быть перенаправлен. При выводе результатов с помощью <i><b>System.err</b></i> пользователь заметит их скорее, чем при выводе в <i><b>System.out</b></i>.
Также можно создать класс исключения с конструктором, получающим аргумент <i><b>String</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/FullConstructors.java</span>
&nbsp;
<span class="kw2">class</span> MyException <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span>
  <span class="kw2">public</span> MyException<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span><span class="br0">}</span>
  <span class="kw2">public</span> MyException<span class="br0">(</span><span class="kw21">String</span> msg<span class="br0">)</span> <span class="br0">{</span> <span class="kw2">super</span><span class="br0">(</span>msg<span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
<span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> FullConstructors <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> f<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> MyException <span class="br0">{</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Возбуждаем MyException изf()"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">throw</span> <span class="kw2">new</span> MyException<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> g<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> MyException <span class="br0">{</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Возбуждаем MyException из g()"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">throw</span> <span class="kw2">new</span> MyException<span class="br0">(</span><span class="st0">"Создано в g()"</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      f<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>MyException e<span class="br0">)</span> <span class="br0">{</span>
      e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      g<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>MyException e<span class="br0">)</span> <span class="br0">{</span>
      e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>Возбуждаем MyException из f()                                                                            
MyException
  at Ful1 Constructors.f(Ful1 Constructors.java:11) 
  at Full Constructors main(FullConstructors.java:19) 
Возбуждаем MyException из g() 
MyException: Создано в g()
  at Full Constructors g(Ful1Constructors.java:15) 
  at FullConstructors.main(FullConstructors.java 24)
</pre>
<p>&lt;/spoiler&gt;
Изменения незначительны — появилось два конструктора, определяющие способ создания объекта <i><b>MyException</b></i>. Во втором конструкторе используется конструктор родительского класса с аргументом <i><b>String</b></i>, вызываемый ключевым словом <i><b>super</b></i>.
В обработчике исключений вызывается метод <i><b>printStackTrace()</b></i> класса <i><b>Throwable</b></i> (базового для <i><b>Exception</b></i>).
 Этот метод выводит информацию о последовательности вызовов, которая 
привела к точке возникновения исключения. В нашем примере информация 
направляется в <i><b>System.out</b></i>, но вызов по умолчанию направляет информацию в стандартный поток ошибок:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"> e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span></pre></div></div>
<h2><span class="mw-headline" id=".D0.A0.D0.B5.D0.B3.D0.B8.D1.81.D1.82.D1.80.D0.B0.D1.86.D0.B8.D1.8F_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9">Регистрация исключений</span></h2>
<p>Вспомогательное пространство имен <i><b>java.util.logging</b></i> позволяет зарегистрировать информацию об исключениях в журнале. Базовые средства регистрации достаточно просты:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/LoggingExceptions.java</span>
<span class="co1">// Регистрация исключений с использованием Logger</span>
<span class="kw2">import</span> <span class="co2">java.util.logging.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">java.io.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> LoggingException <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span>
  <span class="kw2">private</span> <span class="kw2">static</span> <span class="kw51">Logger</span> logger =
    <span class="kw51">Logger</span>.<span class="me1">getLogger</span><span class="br0">(</span><span class="st0">"LoggingException"</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="kw2">public</span> LoggingException<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw20">StringWriter</span> trace = <span class="kw2">new</span> <span class="kw20">StringWriter</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    printStackTrace<span class="br0">(</span><span class="kw2">new</span> <span class="kw20">PrintWriter</span><span class="br0">(</span>trace<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    logger.<span class="me1">severe</span><span class="br0">(</span>trace.<span class="me1">toString</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> LoggingExceptions <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      <span class="kw2">throw</span> <span class="kw2">new</span> LoggingException<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>LoggingException e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">err</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Caught "</span> + e<span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      <span class="kw2">throw</span> <span class="kw2">new</span> LoggingException<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>LoggingException e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">err</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Caught "</span> + e<span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt; (85% match)
</p>
<pre>Aug 30, 2005 4:02:31 PM LoggingException &lt;init&gt;
SEVERE: LoggingException
       at LoggingExceptions.main(LoggingExceptions.java:19)

Caught LoggingException
Aug 30, 2005 4:02:31 PM LoggingException &lt;init&gt;
SEVERE: LoggingException
       at LoggingExceptions.main(LoggingExceptions.java:24)
</pre>
<p>Caught LoggingException
&lt;/spoiler&gt;
Статический метод <i><b>Logger.getLogger()</b></i> создает объект <i><b>Logger</b></i>, ассоциируемый с аргументом <i><b>String</b></i> (обычно имя пакета и класса, к которому относятся ошибки); объект передает свой вывод в <i><b>System.err</b></i>. Простейший способ записи ин­формации в <i><b>Logger</b></i> заключается в вызове метода, соответствующего уровню ошибки; в нашем примере используется метод <i><b>severe()</b></i>. Нам хотелось бы создать String для регистрируемого сообщения из результатов трассировки стека, но метод <i><b>printStackTrace()</b></i> по умолчанию не создает <i><b>String</b></i>. Для получения <i><b>String</b></i> необходимо использовать перегруженную версию <i><b>printStackTrace()</b></i> с аргументом <i><b>java.io.PrintWriter</b></i> (за подробными объяснениями обращайтесь к главе «Ввод/вывод»). Если передать конструктору <i><b>PrintWriter</b></i> объект <i><b>java.io.StringWriter</b></i>, для получения вывода в формате <i><b>String</b></i> достаточно вызвать <i><b>toString()</b></i>.
</p><p>Подход <i><b>LoggingException</b></i> чрезвычайно удобен (вся 
инфраструктура регистрации встроена в само исключение, и все работает 
автоматически без вмешательства со стороны клиента), однако на практике 
чаще применяется перехват и реги­страция «сторонних» исключений, поэтому
 сообщение должно генерироваться в обработчике исключения:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/LoggingExceptions2.java</span>
<span class="co1">// Регистрация перехваченных исключений</span>
<span class="kw2">import</span> <span class="co2">java.util.logging.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">java.io.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> LoggingExceptions2 <span class="br0">{</span>
  <span class="kw2">private</span> <span class="kw2">static</span> <span class="kw51">Logger</span> logger =
    <span class="kw51">Logger</span>.<span class="me1">getLogger</span><span class="br0">(</span><span class="st0">"LoggingExceptions2"</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="kw2">static</span> <span class="kw3">void</span> logException<span class="br0">(</span><span class="kw21">Exception</span> e<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw20">StringWriter</span> trace = <span class="kw2">new</span> <span class="kw20">StringWriter</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw2">new</span> <span class="kw20">PrintWriter</span><span class="br0">(</span>trace<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    logger.<span class="me1">severe</span><span class="br0">(</span>trace.<span class="me1">toString</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">NullPointerException</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">NullPointerException</span> e<span class="br0">)</span> <span class="br0">{</span>
      logException<span class="br0">(</span>e<span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<pre>&lt;spoiler text="Output:"&gt; (90% match)
Aug 30, 2005 4:07:54 PM LoggingExceptions2 logException
SEVERE: java.lang.NullPointerException
       at LoggingExceptions2.main(LoggingExceptions2.java:16)
</pre>
<p>&lt;/spoiler&gt;
На этом процесс создания собственных исключений не заканчивается — 
исключение можно снабдить дополнительными конструкторами и элементами:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/ExtraFeatures.java</span>
<span class="co1">// Дальнейшее расширение классов исключений</span>
<span class="kw2">import</span> <span class="kw2">static</span> <span class="co2">net.mindview.util.Print.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> MyException2 <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span>
  <span class="kw2">private</span> <span class="kw3">int</span> x<span class="sy0">;</span>
  <span class="kw2">public</span> MyException2<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span><span class="br0">}</span>
  <span class="kw2">public</span> MyException2<span class="br0">(</span><span class="kw21">String</span> msg<span class="br0">)</span> <span class="br0">{</span> <span class="kw2">super</span><span class="br0">(</span>msg<span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
  <span class="kw2">public</span> MyException2<span class="br0">(</span><span class="kw21">String</span> msg, <span class="kw3">int</span> x<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">super</span><span class="br0">(</span>msg<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">this</span>.<span class="me1">x</span> = x<span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw3">int</span> val<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> x<span class="sy0">;</span> <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw21">String</span> getMessage<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">return</span> <span class="st0">"Detail Message: "</span>+ x + <span class="st0">" "</span>+ <span class="kw2">super</span>.<span class="me1">getMessage</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> ExtraFeatures <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> f<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> MyException2 <span class="br0">{</span>
    print<span class="br0">(</span><span class="st0">"Throwing MyException2 from f()"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">throw</span> <span class="kw2">new</span> MyException2<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> g<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> MyException2 <span class="br0">{</span>
    print<span class="br0">(</span><span class="st0">"Throwing MyException2 from g()"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">throw</span> <span class="kw2">new</span> MyException2<span class="br0">(</span><span class="st0">"Originated in g()"</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> h<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> MyException2 <span class="br0">{</span>
    print<span class="br0">(</span><span class="st0">"Throwing MyException2 from h()"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">throw</span> <span class="kw2">new</span> MyException2<span class="br0">(</span><span class="st0">"Originated in h()"</span>, <span class="nu0">47</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      f<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>MyException2 e<span class="br0">)</span> <span class="br0">{</span>
      e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      g<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>MyException2 e<span class="br0">)</span> <span class="br0">{</span>
      e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      h<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>MyException2 e<span class="br0">)</span> <span class="br0">{</span>
      e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"e.val() = "</span> + e.<span class="me1">val</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>Throwing MyException2 from f()
MyException2: Detail Message: 0 null
       at ExtraFeatures.f(ExtraFeatures.java:22)
       at ExtraFeatures.main(ExtraFeatures.java:34)
Throwing MyException2 from g()
MyException2: Detail Message: 0 Originated in g()
       at ExtraFeatures.g(ExtraFeatures.java:26)
       at ExtraFeatures.main(ExtraFeatures.java:39)
Throwing MyException2 from h()
MyException2: Detail Message: 47 Originated in h()
       at ExtraFeatures.h(ExtraFeatures.java:30)
       at ExtraFeatures.main(ExtraFeatures.java:44)
e.val() = 47
</pre>
<p>&lt;/spoiler&gt;
Было добавлено поле данных х вместе с методом, считывающим его значение, а также дополнительный конструктор для инициализации <i><b>х</b></i>. Переопределенный метод <i><b>Throwable.getMessage()</b></i> выводит более содержательную информацию об исключении. Метод <i><b>getMessage()</b></i> для классов исключений — аналог <i><b>toString()</b></i>
 в обычных классах.
Так как исключение является просто видом объекта, расширение 
возможностей классов исключений можно продолжить. Однако следует 
помнить, что все эти программисты, использующие ваши библиотеки, могут 
попросту проигно­рировать все «украшения» — нередко программисты 
ограничиваются проверкой типа исключения (как чаще всего бывает со 
стандартными исключениями <i>Java</i>).
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.A1.D0.BF.D0.B5.D1.86.D0.B8.D1.84.D0.B8.D0.BA.D0.B0.D1.86.D0.B8.D0.B8_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9">Спецификации исключений</span></h2>
<p>В языке <i>Java</i> желательно сообщать программисту, вызывающему ваш
 метод, об исключениях, которые данный метод способен возбуждать. 
Пользователь, вызывающий метод, сможет написать весь необходимый код для
 перехвата возможных исключений. Конечно, когда доступен исходный код, 
программист- клиент может пролистать его в поиске предложений <i><b>throw</b></i>, но библиотеки не всегда поставляются с исходными текстами. Чтобы библиотека не превращалась в «черный ящик», в <i>Java</i>
 добавили синтаксис (обязательный для использования), при помощи 
которого вы сообщаете клиенту об исключениях, возбуждаемых методом, 
чтобы он сумел правильно обработать их. Этот синтаксис называется 
спецификацией исключений (<i>exception specification</i>), входит в объявление метода и следует сразу за списком аргументов.
</p><p>Спецификация исключений состоит из ключевого слова <i><b>throws</b></i>, за которым перечисляются все возможные типы исключений. Примерное определение метода будет выглядеть так:
</p>
<pre>void f() throws TooBig, TooSmall. DivZero { //...
</pre>
<p>Однако запись
</p>
<pre>void f() { // ...
</pre>
<p>означает, что метод не вырабатывает исключений. (Кроме исключений, производных от <i><b>RuntimeException</b></i>, которые могут быть возбуждены практически в любом месте — об этом еще будет сказано.)
</p><p>Обойти спецификацию исключений невозможно — если ваш метод 
возбуждает исключения и не обрабатывает их, компилятор предложит либо 
обработать исключение, либо включить его в спецификацию. Жестким 
контролем за соблюдением правил сверху донизу <i>Java</i> гарантирует правильность использования механизма исключений во время компиляции программы.
</p><p>Впрочем, «обмануть» компилятор все же можно: вы вправе объявить о
 возбуждении исключения, которого на самом деле нет. Компилятор верит 
вам на слово и заставляет пользователей метода поступать так, как будто 
им и в самом деле необходимо перехватывать исключение. Таким образом 
можно «зарезервировать» исключение на будущее и уже потом возбуждать 
его, не изменяя описания готовой программы. Такая возможность может 
пригодиться и для создания абстрактных базовых классов и интерфейсов, в 
производных классах которых может возникнуть необходимость в возбуждении
 исключений.
Исключения, которые проверяются и навязываются еще на этапе компиляции 
программы, называют контролируемыми (<i>checked</i>).
</p>
<h2><span class="mw-headline" id=".D0.9F.D0.B5.D1.80.D0.B5.D1.85.D0.B2.D0.B0.D1.82_.D0.BF.D1.80.D0.BE.D0.B8.D0.B7.D0.B2.D0.BE.D0.BB.D1.8C.D0.BD.D1.8B.D1.85_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9">Перехват произвольных исключений</span></h2>
<p>Можно создать универсальный обработчик, перехватывающий любые типы 
исключения. Осуществляется это перехватом базового класса всех 
исключений <i><b>Exception</b></i> (существуют и другие базовые типы исключений, но класс <i><b>Exception</b></i> является базовым практически для всех программных исключительных ситуаций):
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">Exception</span> е<span class="br0">)</span> <span class="br0">{</span><span class="kw21">System</span>.<span class="me1">out</span> println<span class="br0">(</span><span class="st0">"nepexвaчeно исключение"</span><span class="br0">)</span><span class="sy0">;</span><span class="br0">}</span></pre></div></div>
<p>Подобная конструкция не упустит ни одного исключения, поэтому ее 
следует размещать в самом конце списка обработчиков, во избежание 
блокировки следующих за ней обработчиков исключений. Поскольку класс <i><b>Exception</b></i>
 является базовым для всех классов исключений, интересных программисту, 
сам он не предоставит никакой полезной информации об исключительной 
ситуации, но можно вызвать методы из его базового типа <i><b>Throwable</b></i>:
</p>
<hr>
<ul>
<li><span style="color:#800000"><i><b>String getMessage(), String getLocalizedMessage()</b></i> возвращают подробное сообщение об ошибке (или сообщение, локализованное для текущего контекста);</span>
</li>
</ul>
<ul>
<li><span style="color:#800000"><i><b>String toString()</b></i> возвращает короткое описание объекта Throwable, включая подробное сообщение, если оно присутствует;</span>
</li>
</ul>
<ul>
<li><span style="color:#800000"><i><b>void printStackTrace(), void printStackTrace(PrintStream), void printStackTrace(java.io.PrintWriter)</b></i> выводят информацию об объекте <i><b>Throwable</b></i>
 и трассировку стека вызовов для этого объекта. Трассировка стека 
вызовов показывает последовательность вызова методов, которая привела к 
точке возникновения исключения. Первый вариант отправляет информацию в 
стандартный поток ошибок, второй и третий — в поток по вашему выбору (в 
главе «Ввод/вывод» вы поймете, почему типов потоков два);</span>
</li>
</ul>
<ul>
<li><span style="color:#800000"><i><b>Throwable fillInStackTrace()</b></i> записывает в объект <i><b>Throwable</b></i> информацию о текущем состоянии стека. Метод используется при повторном  возбуждении ошибок или исключений.</span>
</li>
</ul>
<hr>
<p>Вдобавок в вашем распоряжении находятся методы типа <i><b>Object</b></i>, базового для <i><b>Throwable</b></i> (и для всех остальных классов). При использовании исключений может пригодиться метод <i><b>getClass()</b></i>, который возвращает информацию о классе объекта. Эта информация заключена в объекте типа <i><b>Class</b></i>. Например, вы можете узнать имя класса вместе с информацией о пакете методом <i><b>getName()</b></i> или получить только имя класса методом <i><b>getSimpleName()</b></i>.
</p><p>Рассмотрим пример с использованием основных методов класса <i><b>Exception</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/ExceptionMethods.java</span>
<span class="co1">// Демонстрация методов класса Exception</span>
<span class="kw2">import</span> <span class="kw2">static</span> <span class="co2">net.mindview.util.Print.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> ExceptionMethods <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">Exception</span><span class="br0">(</span><span class="st0">"My Exception"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">Exception</span> e<span class="br0">)</span> <span class="br0">{</span>
      print<span class="br0">(</span><span class="st0">"Caught Exception"</span><span class="br0">)</span><span class="sy0">;</span>
      print<span class="br0">(</span><span class="st0">"getMessage():"</span> + e.<span class="me1">getMessage</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
      print<span class="br0">(</span><span class="st0">"getLocalizedMessage():"</span> +
        e.<span class="me1">getLocalizedMessage</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
      print<span class="br0">(</span><span class="st0">"toString():"</span> + e<span class="br0">)</span><span class="sy0">;</span>
      print<span class="br0">(</span><span class="st0">"printStackTrace():"</span><span class="br0">)</span><span class="sy0">;</span>
      e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>Caught Exception
getMessage():My Exception
getLocalizedMessage():My Exception
toString():java.lang.Exception: My Exception
printStackTrace():
java.lang.Exception: My Exception
       at ExceptionMethods.main(ExceptionMethods.java:8)
</pre>
<p>&lt;/spoiler&gt;
Как видите, методы последовательно расширяют объем выдаваемой информации
 — всякий последующий фактически является продолжением предыдущего.
</p>
<h2><span class="mw-headline" id=".D0.A2.D1.80.D0.B0.D1.81.D1.81.D0.B8.D1.80.D0.BE.D0.B2.D0.BA.D0.B0_.D1.81.D1.82.D0.B5.D0.BA.D0.B0">Трассировка стека</span></h2>
<p>Информацию, предоставляемую методом <i><b>printStackTrace()</b></i>, также можно получить напрямую вызовом <i><b>getStackTrace()</b></i>.
 Метод возвращает массив элементов трассировки, каждый из которых 
представляет один кадр стека. Нулевой элемент представляет вершину 
стека, то есть последний вызванный метод последовательности (точка, в 
которой был создан и инициирован объект <i><b>Throwable</b></i>).
</p><p>Соответственно, последний элемент массива представляет «низ» 
стека, то есть первый вызванный элемент последовательности. Рассмотрим 
простой пример:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/WhoCalled.java</span>
<span class="co1">// Программный доступ к данным трассировки стека</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> WhoCalled <span class="br0">{</span>
  <span class="kw2">static</span> <span class="kw3">void</span> f<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="co1">// Generate an exception to fill in the stack trace</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">Exception</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span> <span class="br0">(</span><span class="kw21">Exception</span> e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw1">for</span><span class="br0">(</span><span class="kw21">StackTraceElement</span> ste&nbsp;: e.<span class="me1">getStackTrace</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>
        <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>ste.<span class="me1">getMethodName</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
  <span class="kw2">static</span> <span class="kw3">void</span> g<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> f<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
  <span class="kw2">static</span> <span class="kw3">void</span> h<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> g<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    f<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"--------------------------------"</span><span class="br0">)</span><span class="sy0">;</span>
    g<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"--------------------------------"</span><span class="br0">)</span><span class="sy0">;</span>
    h<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>f
main
--------------------------------
f
g
main
--------------------------------
f
g
h
main
</pre>
<p>&lt;/spoiler&gt;
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.9F.D0.BE.D0.B2.D1.82.D0.BE.D1.80.D0.BD.D0.BE.D0.B5_.D0.B2.D0.BE.D0.B7.D0.B1.D1.83.D0.B6.D0.B4.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D1.8F">Повторное возбуждение исключения</span></h2>
<p>В некоторых ситуациях требуется заново возбудить уже перехваченное исключение; чаще всего это происходит при использовании <i><b>Exception</b></i>
 для перехвата всех исключений. Так как ссылка на текущее исключение уже
 имеется, вы попросту возбуждаете исключение по этой ссылке:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">Exception</span> е<span class="br0">)</span> <span class="br0">{</span><span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"повторно возбуждено исключение"</span><span class="br0">)</span><span class="sy0">;</span> <span class="kw2">throw</span> e<span class="sy0">;</span><span class="br0">}</span></pre></div></div>
<p>При повторном возбуждении исключение передается в распоряжение 
обработчика более высокого уровня. Все остальные предложения catch 
текущего блока <i><b>try</b></i> игнорируются. Вся информация из 
объекта, представляющего исключение, сохраняется, и обработчик более 
высокого уровня, перехватывающий подобные исключения, сможет ее извлечь.
</p><p>Если вы просто заново возбуждаете исключение, информация о нем, выводимая методом <i><b>printStackTrace()</b></i>,
 будет по-прежнему относиться к месту возникновения исключения, но не к 
месту его повторного возбуждения. Если вам понадобится использовать 
новую трассировку стека, вызовите метод <i><b>fillInStaсkTrасe()</b></i>, который возвращает исключение (объект <i><b>Throwable</b></i>), созданное на базе старого с помещением туда текущей информации о стеке. Вот как это выглядит:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/Rethrowing.java</span>
<span class="co1">// // Демонстрация метода fillInStackTrace()</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> Rethrowing <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> f<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> <span class="kw21">Exception</span> <span class="br0">{</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"originating the exception in f()"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">Exception</span><span class="br0">(</span><span class="st0">"thrown from f()"</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> g<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> <span class="kw21">Exception</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      f<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">Exception</span> e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Inside g(),e.printStackTrace()"</span><span class="br0">)</span><span class="sy0">;</span>
      e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw2">throw</span> e<span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> h<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> <span class="kw21">Exception</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      f<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">Exception</span> e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Inside h(),e.printStackTrace()"</span><span class="br0">)</span><span class="sy0">;</span>
      e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw2">throw</span> <span class="br0">(</span><span class="kw21">Exception</span><span class="br0">)</span>e.<span class="me1">fillInStackTrace</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      g<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">Exception</span> e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"main: printStackTrace()"</span><span class="br0">)</span><span class="sy0">;</span>
      e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      h<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">Exception</span> e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"main: printStackTrace()"</span><span class="br0">)</span><span class="sy0">;</span>
      e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>originating the exception in f()
Inside g(),e.printStackTrace()
java.lang.Exception: thrown from f()
       at Rethrowing.f(Rethrowing.java:7)
       at Rethrowing.g(Rethrowing.java:11)
       at Rethrowing.main(Rethrowing.java:29)
main: printStackTrace()
java.lang.Exception: thrown from f()
       at Rethrowing.f(Rethrowing.java:7)
       at Rethrowing.g(Rethrowing.java:11)
       at Rethrowing.main(Rethrowing.java:29)
originating the exception in f()
Inside h(),e.printStackTrace()
java.lang.Exception: thrown from f()
       at Rethrowing.f(Rethrowing.java:7)
       at Rethrowing.h(Rethrowing.java:20)
       at Rethrowing.main(Rethrowing.java:35)
main: printStackTrace()
java.lang.Exception: thrown from f()
       at Rethrowing.h(Rethrowing.java:24)
       at Rethrowing.main(Rethrowing.java:35)
</pre>
<p>&lt;/spoiler&gt;
Строка с вызовом <i><b>fillInStackTrace()</b></i> становится новой 
точкой выдачи исключения.
Выдаваемое исключение также может отличаться от исходного. В этом случае
 эффект получается примерно таким же, как при использовании <i><b>fillInStackTrace()</b></i> — информация о месте зарождения исключения теряется, а остается информация, относящаяся к новой команде <i><b>throw</b></i>.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/RethrowNew.java</span>
<span class="co1">// Повторное возбуждение объекта, </span>
<span class="co1">// отличающегося от первоначального</span>
<span class="kw2">class</span> OneException <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span>
  <span class="kw2">public</span> OneException<span class="br0">(</span><span class="kw21">String</span> s<span class="br0">)</span> <span class="br0">{</span> <span class="kw2">super</span><span class="br0">(</span>s<span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
<span class="br0">}</span>
&nbsp;
<span class="kw2">class</span> TwoException <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span>
  <span class="kw2">public</span> TwoException<span class="br0">(</span><span class="kw21">String</span> s<span class="br0">)</span> <span class="br0">{</span> <span class="kw2">super</span><span class="br0">(</span>s<span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
<span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> RethrowNew <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> f<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> OneException <span class="br0">{</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"originating the exception in f()"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">throw</span> <span class="kw2">new</span> OneException<span class="br0">(</span><span class="st0">"thrown from f()"</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      <span class="kw2">try</span> <span class="br0">{</span>
        f<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>OneException e<span class="br0">)</span> <span class="br0">{</span>
        <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>
          <span class="st0">"Caught in inner try, e.printStackTrace()"</span><span class="br0">)</span><span class="sy0">;</span>
        e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw2">throw</span> <span class="kw2">new</span> TwoException<span class="br0">(</span><span class="st0">"from inner try"</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>TwoException e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>
        <span class="st0">"Caught in outer try, e.printStackTrace()"</span><span class="br0">)</span><span class="sy0">;</span>
      e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>originating the exception in f()
Caught in inner try, e.printStackTrace()
OneException: thrown from f()
       at RethrowNew.f(RethrowNew.java:15)
       at RethrowNew.main(RethrowNew.java:20)
Caught in outer try, e.printStackTrace()
TwoException: from inner try
       at RethrowNew.main(RethrowNew.java:25)
</pre>
<p>&lt;/spoiler&gt;
О последнем исключении известно только то, что оно поступило из внутреннего блока <i><b>try</b></i>, но не из метода <i><b>f()</b></i>.
Вам никогда не придется заботиться об удалении предыдущих исключений, и 
исключений вообще. Все они являются объектами, созданными в общей куче 
оператором new, и сборщик мусора уничтожает их автоматически.
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.A6.D0.B5.D0.BF.D0.BE.D1.87.D0.BA.D0.B8_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9">Цепочки исключений</span></h2>
<p>Зачастую необходимо перехватить одно исключение и возбудить 
следующее, не потеряв при этом информации о первом исключении — это 
называется цепочкой исключений (<i>exception chaining</i>). До выпуска пакета <i>JDK</i>
 1.4 программистам приходилось самостоятельно писать код, сохраняющий 
информацию о предыдущем исключении, однако теперь конструкторам всех 
подклассов <i><b>Throwable</b></i> может передаваться объект-причина (<i>cause</i>).
 Предполагается, что причиной является изначальное исключение и передача
 ее в новый объект обеспечивает трассировку стека вплоть до самого его 
начала, хотя при этом создается и возбуждается новое исключение.
Интересно отметить, что единственными подклассами класса <i><b>Throwable</b></i>, принимающими объект-причину в качестве аргумента конструктора, являются три основополагающих класса исключений: <i><b>Error</b></i> (используется виртуальной машиной (<i>JVM</i>) для сообщений о системных ошибках), <i><b>Exception</b></i> и <i><b>RuntimeException</b></i>. Для организации цепочек из других типов исключений придется использовать метод <i><b>initCause()</b></i>, а не конструктор.
Следующий пример демонстрирует динамическое добавление полей в объект <i><b>DynamicFields</b></i> во время работы программы:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/DynamicFields.java</span>
<span class="co1">// Динамическое добавление полей в класс.</span>
<span class="co1">// Пример использования цепочки исключений</span>
<span class="kw2">import</span> <span class="kw2">static</span> <span class="co2">net.mindview.util.Print.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> DynamicFieldsException <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span><span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> DynamicFields <span class="br0">{</span>
  <span class="kw2">private</span> <span class="kw166">Object</span><span class="br0">[</span><span class="br0">]</span><span class="br0">[</span><span class="br0">]</span> fields<span class="sy0">;</span>
  <span class="kw2">public</span> DynamicFields<span class="br0">(</span><span class="kw3">int</span> initialSize<span class="br0">)</span> <span class="br0">{</span>
    fields = <span class="kw2">new</span> <span class="kw166">Object</span><span class="br0">[</span>initialSize<span class="br0">]</span><span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> initialSize<span class="sy0">;</span> i++<span class="br0">)</span>
      fields<span class="br0">[</span>i<span class="br0">]</span> = <span class="kw2">new</span> <span class="kw166">Object</span><span class="br0">[</span><span class="br0">]</span> <span class="br0">{</span> <span class="kw4">null</span>, <span class="kw4">null</span> <span class="br0">}</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw21">String</span> toString<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw21">StringBuilder</span> result = <span class="kw2">new</span> <span class="kw21">StringBuilder</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw166">Object</span><span class="br0">[</span><span class="br0">]</span> obj&nbsp;: fields<span class="br0">)</span> <span class="br0">{</span>
      result.<span class="me1">append</span><span class="br0">(</span>obj<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span>
      result.<span class="me1">append</span><span class="br0">(</span><span class="st0">": "</span><span class="br0">)</span><span class="sy0">;</span>
      result.<span class="me1">append</span><span class="br0">(</span>obj<span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span>
      result.<span class="me1">append</span><span class="br0">(</span><span class="st0">"<span class="es0">\n</span>"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw2">return</span> result.<span class="me1">toString</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">private</span> <span class="kw3">int</span> hasField<span class="br0">(</span><span class="kw21">String</span> id<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> fields.<span class="me1">length</span><span class="sy0">;</span> i++<span class="br0">)</span>
      <span class="kw1">if</span><span class="br0">(</span>id.<span class="me1">equals</span><span class="br0">(</span>fields<span class="br0">[</span>i<span class="br0">]</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span>
        <span class="kw2">return</span> i<span class="sy0">;</span>
    <span class="kw2">return</span> -<span class="nu0">1</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">private</span> <span class="kw3">int</span>
  getFieldNumber<span class="br0">(</span><span class="kw21">String</span> id<span class="br0">)</span> <span class="kw2">throws</span> <span class="kw21">NoSuchFieldException</span> <span class="br0">{</span>
    <span class="kw3">int</span> fieldNum = hasField<span class="br0">(</span>id<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">if</span><span class="br0">(</span>fieldNum == -<span class="nu0">1</span><span class="br0">)</span>
      <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">NoSuchFieldException</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">return</span> fieldNum<span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">private</span> <span class="kw3">int</span> makeField<span class="br0">(</span><span class="kw21">String</span> id<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> fields.<span class="me1">length</span><span class="sy0">;</span> i++<span class="br0">)</span>
      <span class="kw1">if</span><span class="br0">(</span>fields<span class="br0">[</span>i<span class="br0">]</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> == <span class="kw4">null</span><span class="br0">)</span> <span class="br0">{</span>
        fields<span class="br0">[</span>i<span class="br0">]</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> = id<span class="sy0">;</span>
        <span class="kw2">return</span> i<span class="sy0">;</span>
      <span class="br0">}</span>
    <span class="co1">// No empty fields. Add one:</span>
    <span class="kw166">Object</span><span class="br0">[</span><span class="br0">]</span><span class="br0">[</span><span class="br0">]</span> tmp = <span class="kw2">new</span> <span class="kw166">Object</span><span class="br0">[</span>fields.<span class="me1">length</span> + <span class="nu0">1</span><span class="br0">]</span><span class="br0">[</span><span class="nu0">2</span><span class="br0">]</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> fields.<span class="me1">length</span><span class="sy0">;</span> i++<span class="br0">)</span>
      tmp<span class="br0">[</span>i<span class="br0">]</span> = fields<span class="br0">[</span>i<span class="br0">]</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = fields.<span class="me1">length</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> tmp.<span class="me1">length</span><span class="sy0">;</span> i++<span class="br0">)</span>
      tmp<span class="br0">[</span>i<span class="br0">]</span> = <span class="kw2">new</span> <span class="kw166">Object</span><span class="br0">[</span><span class="br0">]</span> <span class="br0">{</span> <span class="kw4">null</span>, <span class="kw4">null</span> <span class="br0">}</span><span class="sy0">;</span>
    fields = tmp<span class="sy0">;</span>
    <span class="co1">// Recursive call with expanded fields:</span>
    <span class="kw2">return</span> makeField<span class="br0">(</span>id<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw166">Object</span>
  getField<span class="br0">(</span><span class="kw21">String</span> id<span class="br0">)</span> <span class="kw2">throws</span> <span class="kw21">NoSuchFieldException</span> <span class="br0">{</span>
    <span class="kw2">return</span> fields<span class="br0">[</span>getFieldNumber<span class="br0">(</span>id<span class="br0">)</span><span class="br0">]</span><span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw166">Object</span> setField<span class="br0">(</span><span class="kw21">String</span> id, <span class="kw166">Object</span> value<span class="br0">)</span>
  <span class="kw2">throws</span> DynamicFieldsException <span class="br0">{</span>
    <span class="kw1">if</span><span class="br0">(</span>value == <span class="kw4">null</span><span class="br0">)</span> <span class="br0">{</span>
      <span class="co1">// Most exceptions don't have a "cause" constructor.</span>
      <span class="co1">// In these cases you must use initCause(),</span>
      <span class="co1">// available in all Throwable subclasses.</span>
      DynamicFieldsException dfe =
        <span class="kw2">new</span> DynamicFieldsException<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      dfe.<span class="me1">initCause</span><span class="br0">(</span><span class="kw2">new</span> <span class="kw21">NullPointerException</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw2">throw</span> dfe<span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw3">int</span> fieldNumber = hasField<span class="br0">(</span>id<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">if</span><span class="br0">(</span>fieldNumber == -<span class="nu0">1</span><span class="br0">)</span>
      fieldNumber = makeField<span class="br0">(</span>id<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw166">Object</span> result = <span class="kw4">null</span><span class="sy0">;</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      result = getField<span class="br0">(</span>id<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Get old value</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">NoSuchFieldException</span> e<span class="br0">)</span> <span class="br0">{</span>
      <span class="co1">// Use constructor that takes "cause":</span>
      <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">RuntimeException</span><span class="br0">(</span>e<span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    fields<span class="br0">[</span>fieldNumber<span class="br0">]</span><span class="br0">[</span><span class="nu0">1</span><span class="br0">]</span> = value<span class="sy0">;</span>
    <span class="kw2">return</span> result<span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    DynamicFields df = <span class="kw2">new</span> DynamicFields<span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span>df<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      df.<span class="me1">setField</span><span class="br0">(</span><span class="st0">"d"</span>, <span class="st0">"A value for d"</span><span class="br0">)</span><span class="sy0">;</span>
      df.<span class="me1">setField</span><span class="br0">(</span><span class="st0">"number"</span>, <span class="nu0">47</span><span class="br0">)</span><span class="sy0">;</span>
      df.<span class="me1">setField</span><span class="br0">(</span><span class="st0">"number2"</span>, <span class="nu0">48</span><span class="br0">)</span><span class="sy0">;</span>
      print<span class="br0">(</span>df<span class="br0">)</span><span class="sy0">;</span>
      df.<span class="me1">setField</span><span class="br0">(</span><span class="st0">"d"</span>, <span class="st0">"A new value for d"</span><span class="br0">)</span><span class="sy0">;</span>
      df.<span class="me1">setField</span><span class="br0">(</span><span class="st0">"number3"</span>, <span class="nu0">11</span><span class="br0">)</span><span class="sy0">;</span>
      print<span class="br0">(</span><span class="st0">"df: "</span> + df<span class="br0">)</span><span class="sy0">;</span>
      print<span class="br0">(</span><span class="st0">"df.getField(<span class="es0">\"</span>d<span class="es0">\"</span>)&nbsp;: "</span> + df.<span class="me1">getField</span><span class="br0">(</span><span class="st0">"d"</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw166">Object</span> field = df.<span class="me1">setField</span><span class="br0">(</span><span class="st0">"d"</span>, <span class="kw4">null</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Exception</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">NoSuchFieldException</span> e<span class="br0">)</span> <span class="br0">{</span>
      e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>DynamicFieldsException e<span class="br0">)</span> <span class="br0">{</span>
      e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>null: null
null: null
null: null

d: A value for d
number: 47
number2: 48

df: d: A new value for d
number: 47
number2: 48
number3: 11

df.getField("d")&nbsp;: A new value for d
DynamicFieldsException
       at DynamicFields.setField(DynamicFields.java:64)
       at DynamicFields.main(DynamicFields.java:94)
Caused by: java.lang.NullPointerException
       at DynamicFields.setField(DynamicFields.java:66)
       ... 1 more
</pre>
<p>&lt;/spoiler&gt;
Каждый объект <i><b>DynamicFields</b></i> содержит массив пар <i><b>Object-Object</b></i>. Первый объект содержит идентификатор поля (<i><b>String</b></i>),
 а второй объект — значение поля, которое может быть любого типа, кроме 
неупакованных примитивов. При создании объекта необходимо оценить 
примерное количество полей. Метод <i><b>setField()</b></i> либо находит 
уже существующее поле с заданным именем, либо создает новое поле и 
сохраняет значение. Когда пространство для полей заканчивается, метод 
наращивает его, создавая массив размером на единицу больше и копируя в 
него старые элементы. При попытке размещения пустой ссылки <i><b>null</b></i> метод инициирует исключение <i><b>DynamicFieldsException</b></i>, создавая объект нужного типа и передавая методу <i><b>initCause()</b></i> в качестве причины исключение <i><b>NullPointerException</b></i>.
Для возвращаемого значения метод <i><b>setField()</b></i> использует старое значение поля, получая его методом <i><b>getField()</b></i>, который может возбудить исключение <i><b>NoSuchFieldException</b></i>. Если метод <i><b>getField()</b></i> вызывает программист-клиент, то он ответственен за обработку возможного исключения <i><b>NoSuchFieldException</b></i>, однако, если последнее возникает в методе <i><b>setField()</b></i>, это является ошибкой программы; соответственно, полученное исключение преобразуется в исключение <i><b>RuntimeException</b></i> с помощью конструктора, принимающего аргумент-причину.
</p><p>Для создания результата <i><b>toString()</b></i> использует объект <i><b>StringBuilder</b></i>. Этот класс будет подробно рассмотрен при описании работы со строками.
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.A1.D1.82.D0.B0.D0.BD.D0.B4.D0.B0.D1.80.D1.82.D0.BD.D1.8B.D0.B5_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D1.8F_Java">Стандартные исключения <i>Java</i></span></h2>
<p>Класс <i>Java</i> <i><b>Throwable</b></i> описывает все объекты, которые могут возбуждаться как исключения. Существует две основные разновидности объектов <i><b>Throwable</b></i> (то есть ветви наследования). Тип <i><b>Error</b></i>
 представляет системные ошибки и ошибки времени компиляции, которые 
обычно не перехватываются (кроме нескольких особых случаев). Тип <i><b>Exception</b></i> может быть возбужден из любого метода стандартной библиотеки классов <i>Java</i>
 или пользовательского метода в случае неполадок при исполнении 
программы. Таким образом, для программистов интерес представляет прежде 
всего тип <i><b>Exception</b></i>.
Лучший способ получить представление об исключениях — просмотреть документацию <i>JDK</i>.
 Стоит сделать это хотя бы раз, чтобы получить представление о различных
 видах исключений, но вскоре вы убедитесь в том, что наиболее 
принципиальным различием между разными исключениями являются их имена. К
 тому же количество исключений в <i>Java</i> постоянно растет, и едва ли
 имеет смысл описывать их в книге. Любая программная библиотека от 
стороннего про­изводителя, скорее всего, также будет иметь собственный 
набор исключений. Здесь важнее понять принцип работы и поступать с 
исключениями сообразно.
Основной принцип заключается в том, что имя исключения относительно 
полно объясняет суть возникшей проблемы. Не все исключения определены в 
пакете <i><b>java.lang</b></i>, некоторые из них созданы для поддержки других библиотек, таких как <i><b>util, net</b></i> и <i><b>io</b></i>, как можно видеть из полных имен их классов или из базовых классов. Например, все исключения, связанные с вводом/выводом (<i>I/O</i>), унаследованы от <i><b>java.io.IOException</b></i>.
</p><p>Особый случай: <i><b>RuntimeException</b></i>
</p><p>Вспомним первый пример в этой главе:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"> <span class="kw1">if</span><span class="br0">(</span>t == <span class="kw4">null</span><span class="br0">)</span> <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">NullPointerException</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span></pre></div></div>
<p>Только представьте, как ужасно было бы проверять таким образом каждую
 ссылку, переданную вашему методу. К счастью, делать это не нужно — 
такая проверка автоматически выполняется во время исполнения <i>Java</i>-программы, и при попытке использования <i><b>null</b></i>-ссылок автоматически возбуждается <i><b>NullPointerException</b></i>. Таким образом, использованная в примере конструкция избыточна.
</p><p>Есть целая группа исключений, принадлежащих к этой категории. Они всегда возбуждаются в <i>Java</i> автоматически, и вам не придется включать их в спецификацию исключений. Все они унаследованы от одного базового класса <i><b>RuntimeException</b></i>,
 что дает нам идеальный пример наследования: семейство классов, имеющих 
общие характеристики и поведение. Вам также не придется создавать 
спецификацию исключений, указывающую на возбуждение методом <i><b>RuntimeException</b></i> (или любого унаследованного от него исключения), так как эти исключения относятся к неконтролируемым (<i>unchecked</i>).
 Такие исключения означают ошибки в программе, и фактически вам никогда 
не придется перехватывать их — это делается автоматически. Проверка <i><b>RuntimeException</b></i> привела бы к излишнему загромождению программы. И хотя вам обычно не требуется перехватывать <i><b>RuntimeException</b></i>, возможно, вы посчитаете нужным возбуждать некоторые из них в своих собственных библиотеках программ.
</p><p>Что же происходит, когда подобные исключения не перехватываются? 
Так как компилятор не заставляет перечислять такие исключения в 
спецификациях, можно предположить, что исключение <i><b>RuntimeException</b></i> проникнет прямо в метод <i><b>main()</b></i>, и не будет перехвачено. Чтобы увидеть все в действии, испытайте следующий пример:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/NeverCaught.java</span>
<span class="co1">// Игнорирование RuntimeExceptions.</span>
<span class="co1">// {ThrowsException}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> NeverCaught <span class="br0">{</span>
  <span class="kw2">static</span> <span class="kw3">void</span> f<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">RuntimeException</span><span class="br0">(</span><span class="st0">"From f()"</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">static</span> <span class="kw3">void</span> g<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    f<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    g<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>Можно сразу заметить, что <i><b>RuntimeException</b></i> (и все от 
него унаследованное) является специальным случаем, так как компилятор не
 требует для него спецификации исключения. Выходные данные выводятся в <i><b>System.err</b></i>&nbsp;:
</p>
<dl>
<dd><i>Exception in thread "main" java.lang.RuntimeException- Из f() at 
NeverCaught.f(NeverCaught.java:7) at NeverCaught.g(NeverCaught.java:10) 
at NeverCaught.main(NeverCaught.java-13)</i>
</dd>
</dl>
<p>Мы приходим к ответу на поставленный вопрос: если <i><b>RuntimeException</b></i> добирается до <i><b>main()</b></i> без перехвата, то работа программы завершается с вызовом метода <i><b>printStackTrace()</b></i>.
</p><p>Помните, что только исключения типа <i><b>RuntimeException</b></i>
 (и производных классов) могут игнорироваться во время написания текста 
программы, в то время как остальные действия компилятор осуществляет в 
обязательном порядке. Это объясняется тем, что <i><b>RuntimeException</b></i> является следствием ошибки программиста, например:
</p>
<hr>
<ul>
<li><span style="color:#800000">ошибки, которую невозможно предвидеть (к примеру, получение <i><b>null</b></i>- ссылки в вашем методе, переданной снаружи);</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">ошибки, которую вы как программист должны были проверить в вашей программе (подобной <i><b>ArraylndexOutOfBoundsException</b></i>, с проверкой  размера массива). Ошибки первого вида часто становятся причиной ошибок второго вида.</span>
</li>
</ul>
<hr>
<p>В подобных ситуациях исключения оказывают неоценимую помощь в отладочном процессе.
Назвать механизм исключений <i>Java</i> узкоспециализированным 
инструментом было бы неверно. Да, он помогает справиться с досадными 
ошибками на стадии исполнения программы, которые невозможно 
предусмотреть заранее, но при этом данный механизм помогает выявлять 
многие ошибки программирования, выходящие за пределы возможностей 
компилятора.
</p>
<h2><span class="mw-headline" id=".D0.97.D0.B0.D0.B2.D0.B5.D1.80.D1.88.D0.B5.D0.BD.D0.B8.D0.B5_.D1.81_.D0.BF.D0.BE.D0.BC.D0.BE.D1.89.D1.8C.D1.8E_finally">Завершение с помощью finally</span></h2>
<p>Часто встречается ситуация, когда некоторая часть программы должна 
выполняться независимо от того, было или нет возбуждено исключение 
внутри блока try. Обычно это имеет отношение к операциям, не связанным с
 освобождением памяти (так как это входит в обязанности сборщика 
мусора). Для достижения желаемой цели необходимо разместить блок <i><b>finally</b></i> после всех обработчиков исключений. Таким образом, полная конструкция обработки исключения выглядит так:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="kw2">try</span> <span class="br0">{</span>
       <span class="co1">// Защищенная секция: рискованные операции, </span>
       <span class="co1">// которые могут породить исключения А, В. или С </span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>A al<span class="br0">)</span> <span class="br0">{</span>
       <span class="co1">// Обработчик для ситуации А </span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>B bl<span class="br0">)</span> <span class="br0">{</span>
       <span class="co1">// Обработчик для ситуации В </span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>C cl<span class="br0">)</span> <span class="br0">{</span>
       <span class="co1">// Обработчик для ситуации С </span>
    <span class="br0">}</span> <span class="kw2">finally</span> <span class="br0">{</span>
      <span class="co1">// Действия, производимые в любом случае</span>
    <span class="br0">}</span></pre></div></div>
<p>Чтобы продемонстрировать, что блок <i><b>finally</b></i> выполняется всегда, рассмотрим следующую программу:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/FinallyWorks.java</span>
<span class="co1">// Блок finally выполняется всегда</span>
<span class="kw2">class</span> ThreeException <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span><span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> FinallyWorks <span class="br0">{</span>
  <span class="kw2">static</span> <span class="kw3">int</span> count = <span class="nu0">0</span><span class="sy0">;</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw1">while</span><span class="br0">(</span><span class="kw4">true</span><span class="br0">)</span> <span class="br0">{</span>
      <span class="kw2">try</span> <span class="br0">{</span>
        <span class="co1">// Post-increment is zero first time:</span>
        <span class="kw1">if</span><span class="br0">(</span>count++ == <span class="nu0">0</span><span class="br0">)</span>
          <span class="kw2">throw</span> <span class="kw2">new</span> ThreeException<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"No exception"</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>ThreeException e<span class="br0">)</span> <span class="br0">{</span>
        <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"ThreeException"</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span> <span class="kw2">finally</span> <span class="br0">{</span>
        <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"In finally clause"</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw1">if</span><span class="br0">(</span>count == <span class="nu0">2</span><span class="br0">)</span> <span class="kw2">break</span><span class="sy0">;</span> <span class="co1">// out of "while"</span>
      <span class="br0">}</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>ThreeException
In finally clause
No exception
In finally clause
</pre>
<p>&lt;/spoiler&gt;
Результат работы программы показывает, что вне зависимости от того, было ли возбуждено исключение, предложение <i><b>finally</b></i> выполняется всегда.
Данный пример также подсказывает, как справиться с тем фактом, что <i>Java</i> не позволяет вернуться к месту возникновения исключения, о чем говорилось ранее. Если расположить блок <i><b>try</b></i>
 в цикле, можно также определить условие, на основании которого будет 
решено, должна ли программа продолжаться. Также можно добавить 
статический счетчик или иной механизм для проверки нескольких разных 
решений, прежде чем отказаться от попыток восстановления. Это один из 
способов обеспечения повышенной отказоустойчивости программ.
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.94.D0.BB.D1.8F_.D1.87.D0.B5.D0.B3.D0.BE_.D0.BD.D1.83.D0.B6.D0.B5.D0.BD_.D0.B1.D0.BB.D0.BE.D0.BA_finally.3F">Для чего нужен блок finally?</span></h2>
<p>В языках без сборки мусора и без автоматических вызовов деструкторов блок <i><b>finally</b></i> гарантирует освобождение ресурсов и памяти независимо от того, что случилось в блоке <i><b>try</b></i>. В <i>Java</i>
 существует сборщик мусора, поэтому с освобожде­нием памяти проблем не 
бывает. Также нет необходимости вызывать деструкторы, их просто нет. 
Когда же нужно использовать <i><b>finally</b></i> в <i>Java</i>?
</p><p>Блок <i><b>finally</b></i> необходим тогда, когда в исходное 
состояние вам необходимо вернуть что-то другое, а не память. Это может 
быть, например, открытый файл или сетевое подключение, часть изображения
 на экране или даже какой-то физический переключатель, вроде 
смоделированного в следующем примере:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/Switch.java</span>
<span class="kw2">import</span> <span class="kw2">static</span> <span class="co2">net.mindview.util.Print.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> Switch <span class="br0">{</span>
  <span class="kw2">private</span> <span class="kw3">boolean</span> state = <span class="kw4">false</span><span class="sy0">;</span>
  <span class="kw2">public</span> <span class="kw3">boolean</span> read<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> state<span class="sy0">;</span> <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw3">void</span> on<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> state = <span class="kw4">true</span><span class="sy0">;</span> print<span class="br0">(</span><span class="kw2">this</span><span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw3">void</span> off<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> state = <span class="kw4">false</span><span class="sy0">;</span> print<span class="br0">(</span><span class="kw2">this</span><span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw21">String</span> toString<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> state <span class="sy0">?</span> <span class="st0">"on"</span>&nbsp;: <span class="st0">"off"</span><span class="sy0">;</span> <span class="br0">}</span>
<span class="br0">}</span>
&nbsp;
<span class="co1">//: exceptions/OnOffException1.java</span>
<span class="kw2">public</span> <span class="kw2">class</span> OnOffException1 <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span><span class="br0">}</span> 
&nbsp;
<span class="co1">//: exceptions/OnOffException2.java</span>
<span class="kw2">public</span> <span class="kw2">class</span> OnOffException2 <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span><span class="br0">}</span> 
&nbsp;
&nbsp;
<span class="co1">//: exceptions/OnOffSwitch.java</span>
<span class="co1">// Зачем использовать finally?</span>
<span class="kw2">public</span> <span class="kw2">class</span> OnOffSwitch <span class="br0">{</span>
  <span class="kw2">private</span> <span class="kw2">static</span> Switch sw = <span class="kw2">new</span> Switch<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> f<span class="br0">(</span><span class="br0">)</span>
  <span class="kw2">throws</span> OnOffException1,OnOffException2 <span class="br0">{</span><span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      sw.<span class="me1">on</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="co1">// Code that can throw exceptions...</span>
      f<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      sw.<span class="me1">off</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>OnOffException1 e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"OnOffException1"</span><span class="br0">)</span><span class="sy0">;</span>
      sw.<span class="me1">off</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>OnOffException2 e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"OnOffException2"</span><span class="br0">)</span><span class="sy0">;</span>
      sw.<span class="me1">off</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>on
off
</pre>
<p>&lt;/spoiler&gt;
Наша цель — убедиться в том, что переключатель был выключен по завершении метода <i><b>main()</b></i>, поэтому в конце блока <i><b>try</b></i> и в конце каждого обработчика исключения помещается вызов <i><b>sw.off()</b></i>. Однако в программе может возникнуть неперехватываемое исключение, и тогда вызов <i><b>sw.off()</b></i> будет пропущен. Однако благодаря <i><b>finally</b></i> завершающий код можно поместить в одном определенном месте:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/WithFinally.java</span>
<span class="co1">// Finally гарантирует выполнение завершающего кода.</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> WithFinally <span class="br0">{</span>
  <span class="kw2">static</span> Switch sw = <span class="kw2">new</span> Switch<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      sw.<span class="me1">on</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="co1">// Code that can throw exceptions...</span>
      OnOffSwitch.<span class="me1">f</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>OnOffException1 e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"OnOffException1"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>OnOffException2 e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"OnOffException2"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">finally</span> <span class="br0">{</span>
      sw.<span class="me1">off</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>on
off
</pre>
<p>&lt;/spoiler&gt;
Здесь вызов метода <i><b>sw.off()</b></i> просто перемещен в то место, где он гарантированно будет выполнен.
</p><p>Даже если исключение не перехватывается в текущем наборе условий <i><b>catch</b></i>, блок <i><b>finally</b></i> отработает перед тем, как механизм обработки исключений продолжит поиск обработчика на более высоком уровне:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/AlwaysFinally.java</span>
<span class="co1">// Finally выполняется всегда</span>
<span class="kw2">import</span> <span class="kw2">static</span> <span class="co2">net.mindview.util.Print.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> FourException <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span><span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> AlwaysFinally <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    print<span class="br0">(</span><span class="st0">"Entering first try block"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      print<span class="br0">(</span><span class="st0">"Entering second try block"</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw2">try</span> <span class="br0">{</span>
        <span class="kw2">throw</span> <span class="kw2">new</span> FourException<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span> <span class="kw2">finally</span> <span class="br0">{</span>
        print<span class="br0">(</span><span class="st0">"finally in 2nd try block"</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>FourException e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>
        <span class="st0">"Caught FourException in 1st try block"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">finally</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"finally in 1st try block"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>Entering first try block
Entering second try block
finally in 2nd try block
Caught FourException in 1st try block
finally in 1st try block
</pre>
<p>&lt;/spoiler&gt;
Блок <i><b>finally</b></i> также исполняется при использовании команд <i><b>break</b></i> и <i><b>continue</b></i>. Заметьте, что комбинация <i><b>finally</b></i> в сочетании с <i><b>break</b></i> и <i><b>continue</b></i> с метками снимает в <i>Java</i> всякую необходимость в операторе <i><b>goto</b></i>.
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_finally_.D1.81_return">Использование finally с return</span></h2>
<p>Поскольку секция <i><b>finally</b></i> выполняется всегда, важные завершающие действия будут выполнены даже при возврате из нескольких точек метода:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/MultipleReturns.java</span>
<span class="kw2">import</span> <span class="kw2">static</span> <span class="co2">net.mindview.util.Print.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> MultipleReturns <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> f<span class="br0">(</span><span class="kw3">int</span> i<span class="br0">)</span> <span class="br0">{</span>
    print<span class="br0">(</span><span class="st0">"Initialization that requires cleanup"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      print<span class="br0">(</span><span class="st0">"Point 1"</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw1">if</span><span class="br0">(</span>i == <span class="nu0">1</span><span class="br0">)</span> <span class="kw2">return</span><span class="sy0">;</span>
      print<span class="br0">(</span><span class="st0">"Point 2"</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw1">if</span><span class="br0">(</span>i == <span class="nu0">2</span><span class="br0">)</span> <span class="kw2">return</span><span class="sy0">;</span>
      print<span class="br0">(</span><span class="st0">"Point 3"</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw1">if</span><span class="br0">(</span>i == <span class="nu0">3</span><span class="br0">)</span> <span class="kw2">return</span><span class="sy0">;</span>
      print<span class="br0">(</span><span class="st0">"End"</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw2">return</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">finally</span> <span class="br0">{</span>
      print<span class="br0">(</span><span class="st0">"Performing cleanup"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">1</span><span class="sy0">;</span> i <span class="sy0">&lt;</span>= <span class="nu0">4</span><span class="sy0">;</span> i++<span class="br0">)</span>
      f<span class="br0">(</span>i<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>Initialization that requires cleanup
Point 1
Performing cleanup
Initialization that requires cleanup
Point 1
Point 2
Performing cleanup
Initialization that requires cleanup
Point 1
Point 2
Point 3
Performing cleanup
Initialization that requires cleanup
Point 1
Point 2
Point 3
End
Performing cleanup
</pre>
<p>&lt;/spoiler&gt;
Из выходных данных видно, что выполнение <i><b>finally</b></i> не зависит от того, в какой точке защищенной секции была выполнена команда <i><b>return</b></i>.
</p>
<h2><span class="mw-headline" id=".D0.9F.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D0.B0_.D0.BF.D0.BE.D1.82.D0.B5.D1.80.D1.8F.D0.BD.D0.BD.D1.8B.D1.85_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9">Проблема потерянных исключений</span></h2>
<p>К сожалению, реализация механизма исключений в <i>Java</i> не 
обошлась без изъяна. Хотя исключение сигнализирует об аварийной ситуации
 в программе и никогда не должно игнорироваться, оно может быть 
потеряно. Это происходит при использовании <i><b>finally</b></i> в конструкции определенного вида:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/LostMessage.java</span>
 <span class="co1">// Как теряются исключения.</span>
&nbsp;
<span class="kw2">class</span> VeryImportantException <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw21">String</span> toString<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">return</span> <span class="st0">"A very important exception!"</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span>
&nbsp;
<span class="kw2">class</span> HoHumException <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw21">String</span> toString<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">return</span> <span class="st0">"A trivial exception"</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> LostMessage <span class="br0">{</span>
  <span class="kw3">void</span> f<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> VeryImportantException <span class="br0">{</span>
    <span class="kw2">throw</span> <span class="kw2">new</span> VeryImportantException<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw3">void</span> dispose<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> HoHumException <span class="br0">{</span>
    <span class="kw2">throw</span> <span class="kw2">new</span> HoHumException<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      LostMessage lm = <span class="kw2">new</span> LostMessage<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw2">try</span> <span class="br0">{</span>
        lm.<span class="me1">f</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span> <span class="kw2">finally</span> <span class="br0">{</span>
        lm.<span class="me1">dispose</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">Exception</span> e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>e<span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>A trivial exception
</pre>
<p>&lt;/spoiler&gt;
В выводе нет никаких признаков <i><b>VeryImportantException</b></i>, оно было просто замещено исключением <i><b>HoHumException</b></i> в предложении <i><b>finally</b></i>.
 Это очень серьезный недочет, так как потеря исключения может произойти в
 гораздо более скрытой и трудно диагностируемой ситуации, в отличие от 
той, что показана в примере. Например, в <i>C++</i> подобная ситуация 
(возбуждение второго исключения без обработки первого) рассматривается 
как грубая ошибка программиста. Возможно, в новых версиях <i>Java</i> эта проблема будет решена (впрочем, любой метод, способный возбуждать исключения — такой, как <i><b>dispose()</b></i> в приведенном примере — обычно заключается в конструкцию <i><b>try-catch</b></i>).
</p><p>Еще проще потерять исключение простым возвратом из finally:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/ExceptionSilencer.java</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> ExceptionSilencer <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">RuntimeException</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">finally</span> <span class="br0">{</span>
      <span class="co1">// Команда 'return' в блоке finally </span>
      <span class="co1">// прерывает обработку исключения</span>
      <span class="kw2">return</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>Запустив эту программу, вы увидите, что она ничего не выводит — несмотря на исключение.
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.9E.D0.B3.D1.80.D0.B0.D0.BD.D0.B8.D1.87.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BF.D1.80.D0.B8_.D0.B8.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B8_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9">Ограничения при использовании исключений</span></h2>
<p>В переопределенном методе можно возбуждать только те исключения, 
которые были описаны в методе базового класса. Это полезное ограничение 
означает, что программа, работающая с базовым классом, автоматически 
сможет работать и с объектом, произошедшим от базового (конечно, это 
фундаментальный принцип ООП), включая и исключения.
Следующий пример демонстрирует виды ограничений (во время компиляции), 
наложенные на исключения:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/StormyInning.java</span>
<span class="co1">// Переопределенные методы могут возбуждать только </span>
<span class="co1">// исключения, описанные в версии базового класса, </span>
<span class="co1">// или исключения, унаследованные от исключений </span>
<span class="co1">// базового класса.</span>
&nbsp;
<span class="kw2">class</span> BaseballException <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span><span class="br0">}</span>
<span class="kw2">class</span> Foul <span class="kw2">extends</span> BaseballException <span class="br0">{</span><span class="br0">}</span>
<span class="kw2">class</span> Strike <span class="kw2">extends</span> BaseballException <span class="br0">{</span><span class="br0">}</span>
&nbsp;
<span class="kw2">abstract</span> <span class="kw2">class</span> Inning <span class="br0">{</span>
  <span class="kw2">public</span> Inning<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> BaseballException <span class="br0">{</span><span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw3">void</span> event<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> BaseballException <span class="br0">{</span>
    <span class="co1">// Doesn't actually have to throw anything</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">abstract</span> <span class="kw3">void</span> atBat<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> Strike, Foul<span class="sy0">;</span>
  <span class="kw2">public</span> <span class="kw3">void</span> walk<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span><span class="br0">}</span> <span class="co1">// Throws no checked exceptions</span>
<span class="br0">}</span>
&nbsp;
<span class="kw2">class</span> StormException <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span><span class="br0">}</span>
<span class="kw2">class</span> RainedOut <span class="kw2">extends</span> StormException <span class="br0">{</span><span class="br0">}</span>
<span class="kw2">class</span> PopFoul <span class="kw2">extends</span> Foul <span class="br0">{</span><span class="br0">}</span>
&nbsp;
<span class="kw2">interface</span> Storm <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw3">void</span> event<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> RainedOut<span class="sy0">;</span>
  <span class="kw2">public</span> <span class="kw3">void</span> rainHard<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> RainedOut<span class="sy0">;</span>
<span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> StormyInning <span class="kw2">extends</span> Inning <span class="kw2">implements</span> Storm <span class="br0">{</span>
  <span class="co1">// OK to add new exceptions for constructors, but you</span>
  <span class="co1">// must deal with the base constructor exceptions:</span>
  <span class="kw2">public</span> StormyInning<span class="br0">(</span><span class="br0">)</span>
    <span class="kw2">throws</span> RainedOut, BaseballException <span class="br0">{</span><span class="br0">}</span>
  <span class="kw2">public</span> StormyInning<span class="br0">(</span><span class="kw21">String</span> s<span class="br0">)</span>
    <span class="kw2">throws</span> Foul, BaseballException <span class="br0">{</span><span class="br0">}</span>
  <span class="co1">// Regular methods must conform to base class:</span>
<span class="co1">//! void walk() throws PopFoul {} //Compile error</span>
  <span class="co1">// Interface CANNOT add exceptions to existing</span>
  <span class="co1">// methods from the base class:</span>
<span class="co1">//! public void event() throws RainedOut {}</span>
  <span class="co1">// If the method doesn't already exist in the</span>
  <span class="co1">// base class, the exception is OK:</span>
  <span class="kw2">public</span> <span class="kw3">void</span> rainHard<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> RainedOut <span class="br0">{</span><span class="br0">}</span>
  <span class="co1">// You can choose to not throw any exceptions,</span>
  <span class="co1">// even if the base version does:</span>
  <span class="kw2">public</span> <span class="kw3">void</span> event<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span><span class="br0">}</span>
  <span class="co1">// Overridden methods can throw inherited exceptions:</span>
  <span class="kw2">public</span> <span class="kw3">void</span> atBat<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> PopFoul <span class="br0">{</span><span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      StormyInning si = <span class="kw2">new</span> StormyInning<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      si.<span class="me1">atBat</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>PopFoul e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Pop foul"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>RainedOut e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Rained out"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>BaseballException e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Generic baseball exception"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="co1">// Strike not thrown in derived version.</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      <span class="co1">// What happens if you upcast?</span>
      Inning i = <span class="kw2">new</span> StormyInning<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      i.<span class="me1">atBat</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="co1">// You must catch the exceptions from the</span>
      <span class="co1">// base-class version of the method:</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>Strike e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Strike"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>Foul e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Foul"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>RainedOut e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Rained out"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>BaseballException e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Generic baseball exception"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>В классе <i><b>Inning</b></i> и конструктор, и метод <i><b>event()</b></i>
 объявляют, что будут возбуждать исключения, но в действительности этого
 не делают. Это допустимо, поскольку подобный подход заставляет 
пользователя перехватывать все виды исключений, которые потом могут быть
 добавлены в переопределенные версии метода <i><b>event()</b></i>. Данный принцип распространяется и на абстрактные методы, что и показано для метода <i><b>atBat()</b></i>.
Интерфейс <i><b>Storm</b></i> интересен тем, что содержит один метод (<i><b>event()</b></i>), уже определенный в классе <i><b>Inning</b></i>, и один уникальный. Оба метода возбуждают новый тип исключения <i><b>RainedOut</b></i>. Когда класс <i><b>StormyInning</b></i> расширяет <i><b>Inning</b></i> и реализует интерфейс <i><b>Storm</b></i>, выясняется, что метод <i><b>event()</b></i> из <i><b>Storm</b></i> не способен изменить тип исключения для метода <i><b>event()</b></i> класса <i><b>Inning</b></i>.
 Опять-таки это вполне разумно, так как иначе вы бы никогда не знали, 
перехватываете ли нужное исключение в случае работы с базовым классом. 
Конечно, когда метод, описанный в интерфейсе, отсутствует в базовом 
классе (как <i><b>rainHard()</b></i>), никаких проблем с возбуждением исключений нет.
Метод <i><b>StormyInning.walk()</b></i> не компилируется из-за того, что он возбуждает исключение, тогда как <i><b>Inning.walk()</b></i> такого не делает. Если бы это позволялось, вы могли бы написать код, вызывающий метод <i><b>Inning.walk()</b></i>
 и не перехватывающий никаких исключений, а потом при подстановке 
объекта класса, производного от Inning, возникли бы исключения, 
нарушающие работу программы. Таким образом, принудительно обеспечивая 
соответствие спецификаций исключений в производных и базовых версиях 
методов, <i>Java</i> добивается взаимозаменяемости объектов.
Переопределенный метод <i><b>event()</b></i> показывает, что метод 
производного класса может вообще не возбуждать исключений, даже если это
 делается в базовой версии. Опять-таки это нормально, так как не влияет 
на уже написанный код — подразумевается, что метод базового класса 
возбуждает исключения. Аналогичная логика применима для метода <i><b>atBat()</b></i>, возбуждающего исключение <i><b>PopFoul</b></i>, производное от <i><b>Foul</b></i>, которое возбуждается базовой версией <i><b>atBat()</b></i>. Итак, если вы пишете код, работающий с <i><b>Inning</b></i> и вызывающий <i><b>atBat()</b></i>, то он должен перехватывать исключение <i><b>Foul</b></i>. Так как <i><b>PopFoul</b></i> наследует от <i><b>Foul</b></i>, обработчик исключения для <i><b>Foul</b></i> перехватит и <i><b>PopFoul</b></i>.
Последний интересный момент встречается в методе <i><b>main()</b></i>. Мы видим, что при работе именно с объектом <i><b>StormyInning</b></i>
 компилятор заставляет перехватывать только те исключения, которые 
характерны для этого класса, но при восходящем преобразовании к базовому
 типу компилятор заставляет перехватывать исключения из базового класса.
 Все эти ограничения значительно повышают ясность и надежность кода 
обработки исключений.
Хотя компилятор заставляет описывать исключения при наследовании, 
спецификация исключений не является частью объявления (сигнатуры) 
метода, которое состоит только из имени метода и типов аргументов. 
Соответственно, нельзя переопределять методы только по спецификациям 
исключений. Вдобавок, даже если спецификация исключения присутствует в 
методе базового класса, это вовсе не гарантирует его существования в 
методе производного класса. Данная практика сильно отличается от правил 
наследования, по которым метод базового класса обязательно присутствует и
 в производном классе. Другими словами, «интерфейс спецификации 
исключений» для определенного метода может сузиться в процессе 
наследования и переопределения, но никак не расшириться — и это прямая 
противоположность интерфейсу класса во время наследования.
</p>
<h2><span class="mw-headline" id=".D0.9A.D0.BE.D0.BD.D1.81.D1.82.D1.80.D1.83.D0.BA.D1.82.D0.BE.D1.80.D1.8B">Конструкторы</span></h2>
<p>При программировании обработки исключений всегда спрашивайте себя: 
«Если произойдет исключение, будет ли все корректно завершено?» Чаще все
 идет более или менее безопасно, но с конструкторами возникает проблема.
 Конструктор приводит объект в определенное начальное состояние, но 
может начать выполнять какое-либо действие — такое как открытие файла — 
которое не будет правильно завершено, пока пользователь не освободит 
объект, вызвав специальный завершающий метод. Если исключение произойдет
 в конструкторе, эти финальные действия могут быть исполнены ошибочно. А
 это означает, что при написании конструкторов необходимо быть особенно 
внимательным.
</p><p>Казалось бы, блок <i><b>finally</b></i> решает все проблемы. Но в действительности все сложнее — ведь <i><b>finally</b></i>
 выполняется всегда, и даже тогда, когда завершающий код не должен 
активизироваться до вызова какого-то метода. Если сбой в конструкторе 
произойдет где-то на середине, может оказаться, что часть объекта, 
освобождаемая в <i><b>finally</b></i>, еще не была создана.
</p><p>В следующем примере создается класс, названный <i><b>InputFile</b></i>, который открывает файл и позволяет читать из него по одной строке. Он использует классы <i><b>FileReader</b></i> и <i><b>BufferedReader</b></i> из стандартной библиотеки ввода/вывода <i>Java</i>, которая будет изучена далее, но эти классы достаточно просты, и у вас не возникнет особых сложностей при работе с ними:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/InputFile.java</span>
<span class="co1">// Специфика исключений в конструкторах</span>
<span class="kw2">import</span> <span class="co2">java.io.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> InputFile <span class="br0">{</span>
  <span class="kw2">private</span> <span class="kw20">BufferedReader</span> in<span class="sy0">;</span>
  <span class="kw2">public</span> InputFile<span class="br0">(</span><span class="kw21">String</span> fname<span class="br0">)</span> <span class="kw2">throws</span> <span class="kw21">Exception</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      in = <span class="kw2">new</span> <span class="kw20">BufferedReader</span><span class="br0">(</span><span class="kw2">new</span> <span class="kw20">FileReader</span><span class="br0">(</span>fname<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="co1">// Other code that might throw exceptions</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw20">FileNotFoundException</span> e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Could not open "</span> + fname<span class="br0">)</span><span class="sy0">;</span>
      <span class="co1">// Wasn't open, so don't close it</span>
      <span class="kw2">throw</span> e<span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">Exception</span> e<span class="br0">)</span> <span class="br0">{</span>
      <span class="co1">// All other exceptions must close it</span>
      <span class="kw2">try</span> <span class="br0">{</span>
        in.<span class="me1">close</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw20">IOException</span> e2<span class="br0">)</span> <span class="br0">{</span>
        <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"in.close() unsuccessful"</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span>
      <span class="kw2">throw</span> e<span class="sy0">;</span> <span class="co1">// Rethrow</span>
    <span class="br0">}</span> <span class="kw2">finally</span> <span class="br0">{</span>
      <span class="co1">// Don't close it here!!!</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw21">String</span> getLine<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw21">String</span> s<span class="sy0">;</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      s = in.<span class="me1">readLine</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw20">IOException</span> e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">RuntimeException</span><span class="br0">(</span><span class="st0">"readLine() failed"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw2">return</span> s<span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw3">void</span> dispose<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      in.<span class="me1">close</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"dispose() successful"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw20">IOException</span> e2<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">RuntimeException</span><span class="br0">(</span><span class="st0">"in.close() failed"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>Конструктор <i><b>InputFile</b></i> получает в качестве аргумента строку (<i><b>String</b></i>) с именем открываемого файла. Внутри блока <i><b>try</b></i> он создает объект <i><b>FileReader</b></i> для этого файла. Класс <i><b>FileReader</b></i> не особенно полезен сам по себе, поэтому мы встраиваем его в созданный <i><b>BufferedReader</b></i>, с которым и работаем, — одно из преимуществ <i><b>InputFile</b></i> состоит в том, что он объединяет эти два действия.
</p><p>Если при вызове конструктора <i><b>FileReader</b></i> произойдет сбой, возбуждается исключение <i><b>FileNotFoundException</b></i>.
 В этом случае закрывать файл не нужно, так как он и не открывался. Все 
остальные блоки catch обязаны закрыть файл, так как он уже был открыт во
 время входа в них. (Конечно, все было бы сложнее в случае, если бы 
несколько методов могли возбуждать <i><b>FileNotFoundException</b></i>. В таких ситуациях обычно требуется несколько блоков <i><b>try</b></i>.) Метод <i><b>close()</b></i>
 тоже может возбудить исключение, которое также проверяется и 
перехватывается — несмотря на то, что вызов находится в другом блоке <i><b>catch</b></i> — с точки зрения компилятора <i>Java</i>
 это всего лишь еще одна пара фигурных скобок. После выполнения всех 
необходимых локальных действий исключение возбуждается заново; ведь 
вызывающий метод не должен считать, что объект был благополучно создан.
</p><p>В этом примере блок <i><b>finally</b></i> определенно не подходит
 для закрытия файла, поскольку в таком варианте закрытие происходило бы 
каждый раз по завершении работы конструктора. Мы хотим, чтобы файл 
оставался открытым на протяжении всего жизненного цикла <i><b>InputFile</b></i>.
</p><p>Метод <i><b>getLine()</b></i> возвращает объект <i><b>String</b></i> со следующей строкой из файла. Он вызывает метод <i><b>readLine()</b></i>, способный возбуждать исключения, но они перехватываются; таким образом, сам <i><b>getLine()</b></i>
 исключений не возбуждает. При про­ектировании обработки исключений вы 
выбираете между полной обработкой исключения на определенном уровне, его
 частичной обработкой и передачей далее того же (или другого) исключения
 и, наконец, простой передачей далее. Там, где это возможно, передача 
исключения значительно упрощает программирование. В данной ситуации 
метод <i><b>getLine()</b></i> преобразует исключение в <i><b>RuntimeException</b></i>, чтобы указать на ошибку в программе.
</p><p>Метод <i><b>dispose()</b></i> должен вызываться пользователем при завершении работы с объектом <i><b>InputFile</b></i>. Он освобождает системные ресурсы (такие, как открытые файлы), закрепленные за объектами <i><b>BufferedReader</b></i> и (или) <i><b>FileReader</b></i>. Делать это следует только тогда, когда работа с объектом <i><b>InputFile</b></i> действительно будет завершена. Казалось бы, подобные действия удобно разместить в методе <i><b>finalize()</b></i>,
 но, как упоминалось в главе 5, вызов этого метода не гарантирован (и 
даже если вы знаете, что он будет вызван, то неизвестно, когда). Это 
один из недостатков <i>Java</i>: все завершающие действия, кроме 
освобождения памяти, не производятся автоматически, так что вам придется
 информировать пользователя о том, что он ответственен за их выполнение.
</p><p>Самый безопасный способ использования класса, который способен 
выдать исключение при конструировании и требует завершающих действий, 
основан на использовании вложенных блоков <i><b>try</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/Cleanup.java</span>
<span class="co1">// Гарантированное освобождение ресурсов.</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> Cleanup <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      InputFile in = <span class="kw2">new</span> InputFile<span class="br0">(</span><span class="st0">"Cleanup.java"</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw2">try</span> <span class="br0">{</span>
        <span class="kw21">String</span> s<span class="sy0">;</span>
        <span class="kw3">int</span> i = <span class="nu0">1</span><span class="sy0">;</span>
        <span class="kw1">while</span><span class="br0">(</span><span class="br0">(</span>s = in.<span class="me1">getLine</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="sy0">!</span>= <span class="kw4">null</span><span class="br0">)</span>
          <span class="sy0">;</span> <span class="co1">// Perform line-by-line processing here...</span>
      <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">Exception</span> e<span class="br0">)</span> <span class="br0">{</span>
        <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Caught Exception in main"</span><span class="br0">)</span><span class="sy0">;</span>
        e.<span class="me1">printStackTrace</span><span class="br0">(</span><span class="kw21">System</span>.<span class="me1">out</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span> <span class="kw2">finally</span> <span class="br0">{</span>
        in.<span class="me1">dispose</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">Exception</span> e<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"InputFile construction failed"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>dispose() successful
</pre>
<p>&lt;/spoiler&gt;
Присмотритесь к логике происходящего: конструирование объекта <i><b>InputFile</b></i> фактически заключено в собственный блок <i><b>try</b></i>. Если попытка завершается неудачей, мы входим во внешнюю секцию <i><b>catch</b></i> и метод <i><b>dispose()</b></i>
 не вызывается. Но, если конструирование прошло успешно, мы хотим 
обеспечить гарантированное завершение, поэтому сразу же после 
конструирования создается новый блок <i><b>try</b></i>. Блок <i><b>finally</b></i>, выполняющий завершение, связывается с внутренним блоком <i><b>try</b></i>; таким образом, блок <i><b>finally</b></i>
 не выполняется при неудачном конструировании и всегда выполняется, если
 конструирование прошло удачно.
Эта универсальная идиома применяется и в тех ситуациях, когда 
конструктор не выдает исключений. Основной принцип: сразу же после 
создания объекта, требующего завершения, начинается конструкция <i><b>try-finally</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/CleanupIdiom.java</span>
<span class="co1">// За каждым освобождаемым объектом следует try-finally</span>
&nbsp;
<span class="kw2">class</span> NeedsCleanup <span class="br0">{</span> <span class="co1">// Construction can't fail</span>
  <span class="kw2">private</span> <span class="kw2">static</span> <span class="kw3">long</span> counter = <span class="nu0">1</span><span class="sy0">;</span>
  <span class="kw2">private</span> <span class="kw2">final</span> <span class="kw3">long</span> id = counter++<span class="sy0">;</span>
  <span class="kw2">public</span> <span class="kw3">void</span> dispose<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"NeedsCleanup "</span> + id + <span class="st0">" disposed"</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span>
&nbsp;
<span class="kw2">class</span> ConstructionException <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span><span class="br0">}</span>
&nbsp;
<span class="kw2">class</span> NeedsCleanup2 <span class="kw2">extends</span> NeedsCleanup <span class="br0">{</span>
  <span class="co1">// Construction can fail:</span>
  <span class="kw2">public</span> NeedsCleanup2<span class="br0">(</span><span class="br0">)</span> <span class="kw2">throws</span> ConstructionException <span class="br0">{</span><span class="br0">}</span>
<span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> CleanupIdiom <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="co1">// Section 1:</span>
    NeedsCleanup nc1 = <span class="kw2">new</span> NeedsCleanup<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      <span class="co1">// ...</span>
    <span class="br0">}</span> <span class="kw2">finally</span> <span class="br0">{</span>
      nc1.<span class="me1">dispose</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
&nbsp;
    <span class="co1">// Section 2:</span>
    <span class="co1">// If construction cannot fail you can group objects:</span>
    NeedsCleanup nc2 = <span class="kw2">new</span> NeedsCleanup<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    NeedsCleanup nc3 = <span class="kw2">new</span> NeedsCleanup<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      <span class="co1">// ...</span>
    <span class="br0">}</span> <span class="kw2">finally</span> <span class="br0">{</span>
      nc3.<span class="me1">dispose</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Reverse order of construction</span>
      nc2.<span class="me1">dispose</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
&nbsp;
    <span class="co1">// Section 3:</span>
    <span class="co1">// If construction can fail you must guard each one:</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      NeedsCleanup2 nc4 = <span class="kw2">new</span> NeedsCleanup2<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw2">try</span> <span class="br0">{</span>
        NeedsCleanup2 nc5 = <span class="kw2">new</span> NeedsCleanup2<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw2">try</span> <span class="br0">{</span>
          <span class="co1">// ...</span>
        <span class="br0">}</span> <span class="kw2">finally</span> <span class="br0">{</span>
          nc5.<span class="me1">dispose</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="br0">}</span>
      <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>ConstructionException e<span class="br0">)</span> <span class="br0">{</span> <span class="co1">// nc5 constructor</span>
        <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>e<span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span> <span class="kw2">finally</span> <span class="br0">{</span>
        nc4.<span class="me1">dispose</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>ConstructionException e<span class="br0">)</span> <span class="br0">{</span> <span class="co1">// nc4 constructor</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>e<span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>NeedsCleanup 1 disposed
NeedsCleanup 3 disposed
NeedsCleanup 2 disposed
NeedsCleanup 5 disposed
NeedsCleanup 4 disposed
</pre>
<p>&lt;/spoiler&gt;
Секция 1 метода <i><b>main()</b></i> весьма прямолинейна: за созданием завершаемого объекта следует <i><b>try-finally</b></i>. Если конструирование не может завершиться неудачей, наличие <i><b>catch</b></i>
 не требуется. В секции 2 мы видим, что конструкторы, которые не могут 
завершиться неудачей, могут группироваться как для конструирования, так и
 для завершения.
</p><p>Секция 3 показывает, как поступать с объектами, при 
конструировании которых возможны сбои и которые нуждаются в завершении. 
Здесь программа усложняется, потому что каждое конструирование должно 
заключаться в отдельную копию <i><b>try-catch</b></i> и за ним должна следовать конструкция <i><b>try-finally</b></i>, обеспечивающая завершение.
</p><p>Неудобства обработки исключения в подобных случаях — веский 
аргумент в пользу создания конструкторов, выполнение которых заведомо 
обходится без сбоев (хотя это и не всегда возможно).
</p>
<h2><span class="mw-headline" id=".D0.98.D0.B4.D0.B5.D0.BD.D1.82.D0.B8.D1.84.D0.B8.D0.BA.D0.B0.D1.86.D0.B8.D1.8F_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9">Идентификация исключений</span></h2>
<p>Механизм обработки исключений ищет в списке «ближайший» подходящий 
обработчик в порядке их следования. Когда соответствие обнаруживается, 
исключение считается найденным и дальнейшего поиска не происходит.
Идентификация исключений не требует обязательного соответствия между 
исключением и обработчиком. Объект порожденного класса подойдет и для 
обработчика, изначально написанного для базового класса:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/Human.java</span>
<span class="co1">// Перехват иерархии исключений.</span>
&nbsp;
<span class="kw2">class</span> Annoyance <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span><span class="br0">}</span>
<span class="kw2">class</span> Sneeze <span class="kw2">extends</span> Annoyance <span class="br0">{</span><span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> Human <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="co1">// Catch the exact type:</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      <span class="kw2">throw</span> <span class="kw2">new</span> Sneeze<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>Sneeze s<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Caught Sneeze"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>Annoyance a<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Caught Annoyance"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="co1">// Catch the base type:</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      <span class="kw2">throw</span> <span class="kw2">new</span> Sneeze<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>Annoyance a<span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Caught Annoyance"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>Caught Sneeze
Caught Annoyance
</pre>
<p>&lt;/spoiler&gt;
Исключение <i><b>Sneeze</b></i> будет перехвачено в первом блоке <i><b>catch</b></i>, который ему соответствует — конечно, это будет первый блок. Но, если удалить первый блок <i><b>catch</b></i>, оставив только проверку <i><b>Annoyance</b></i>, программа все равно работает, потому что она перехватывает базовый класс <i><b>Sneeze</b></i>. Другими словами, блок <i><b>catch (Annoyance а)</b></i> поймает<i><b> Annoyance</b></i>
 или любой другой класс, унаследованный от него. Если вы добавите новые 
производные исключения в свой метод, программа пользователя этого метода
 не потребует изменений, так как клиент перехватывает исключения 
базового класса.
Если вы попытаетесь «замаскировать» исключения производного класса, 
поместив сначала блок <i><b>catch </b></i>базового класса:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"> <span class="kw2">try</span> <span class="br0">{</span> <span class="kw2">throw</span> <span class="kw2">new</span> Sneeze<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
     <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>Annoyance a<span class="br0">)</span> <span class="br0">{</span> 
       <span class="co1">// ..</span>
     <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>Sneeze s<span class="br0">)</span> <span class="br0">{</span> 
      <span class="co1">//...</span>
     <span class="br0">}</span></pre></div></div>
<p>компилятор выдаст сообщение об ошибке, так как он видит, что блок <i><b>catch</b></i> для исключения <i><b>Sneeze</b></i> никогда не выполнится.
</p>
<h2><span class="mw-headline" id=".D0.90.D0.BB.D1.8C.D1.82.D0.B5.D1.80.D0.BD.D0.B0.D1.82.D0.B8.D0.B2.D0.BD.D1.8B.D0.B5_.D1.80.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D1.8F">Альтернативные решения</span></h2>
<p>Система обработки исключений представляет собой «черный ход», 
позволяющий программе нарушить нормальную последовательность выполнения 
команд. «Черный ход» открывается при возникновении «исключительных 
ситуаций», когда обычная работа далее невозможна или нежелательна. 
Исключения представляют собой условия, с которыми текущий метод 
справиться не в состоянии. Причина, по которой возникают системы 
обработки исключений, кроется в том, что программисты не желали иметь 
дела с громоздкой проверкой всех возможных условий возникновения ошибок 
каждой функции. В результате ошибки ими просто игнорировались. Стоит 
отметить, что вопрос удобства программиста при обработке ошибок стоял на
 первом месте для разработчиков <i>Java</i>.
</p><p>Основное правило при использовании исключений гласит: «Не 
обрабатывайте исключение, если вы не знаете, что с ним делать». По сути,
 отделение кода, ответственного за обработку ошибок, от места, где 
ошибка возникает, является одной из главных целей обработки исключений. 
Это позволяет вам сконцентрироваться на том, что вы хотите сделать в 
одном фрагменте кода, и на том, как вы собираетесь поступить с ошибками в
 совершенно другом месте программы. В результате основной код не 
перемежается с логикой обработки ошибок, что упрощает его сопровождение и
 понимание. Исключения также сокращают объем кода, так как один 
обработчик может обслуживать несколько потенциальных источников ошибок.
</p><p>Контролируемые исключения немного усложняют ситуацию, поскольку 
они заставляют добавлять обрабатывающие исключения предложения там, где 
вы не всегда еще готовы справиться с ошибкой. В итоге возникает проблема
 «про­глоченных исключений»:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="kw2">try</span> <span class="br0">{</span>
      <span class="co1">// делает что-то полезное</span>
    <span class="br0">}</span> саtch <span class="br0">(</span>ОбязывающееИсключение е<span class="br0">)</span> <span class="br0">{</span><span class="br0">}</span> <span class="co1">// Проглотили!</span></pre></div></div>
<p>Программисты (и я в том числе, в первом издании книги), не долго 
думая, делали самое бросающееся в глаза и «проглатывали» исключение — 
зачастую непреднамеренно, но, как только дело было сделано, компилятор 
был удовлетворен, поэтому пока вы не вспоминали о необходимости 
пересмотреть и исправить код, не вспоминали и об исключении. Исключение 
происходит, но безвозвратно теряется. Из-за того что компилятор 
заставляет вас писать код для обработки исключений прямо на месте, это 
кажется самым простым решением, хотя на самом деле ничего хуже и 
придумать нельзя.
</p><p>Ужаснувшись тем, что я так поступил, во втором издании книги я 
«исправил» проблему, распечатыв в обработчике трассировку стека 
исключения (и сейчас это можно видеть — в подходящих местах — в 
некоторых примерах данной главы). Хотя это и полезно при отслеживании 
поведения исключений, трассировка фактически означает, что вы так и не 
знаете, что же делать с исключением в данном фрагменте кода. В этом 
разделе мы рассмотрим некоторые тонкости и осложнения, порождаемые 
контролируемыми исключениями, и варианты работы с последними.
</p><p>Несмотря на кажущуюся простоту, проблема не только очень сложна, 
но и к тому же неоднозначна. Существуют твердые приверженцы обеих точек 
зрения, которые считают, что верный ответ (их) очевиден и просто 
бросается в глаза. Вероятно, одна из точек зрения основана на 
несомненных преимуществах перехода от слабо типизированного языка 
(например, <i>C</i> до выхода стандарта ANSI) к языку с строгой статической проверкой типов (то есть с проверкой во время компиляции), подобному <i>C++</i> или <i>Java</i>.
 Преимущества такого перехода настолько очевидны, что строгая 
статическая проверка типов кажется панацеей от всех бед. Я надеюсь 
поставить под вопрос ту небольшую часть моей эволюции, отличающуюся 
абсолютной верой в строгую статическую проверку типов: без сомнения, 
большую часть времени она приносит пользу, но существует неформальная 
граница, за которой такая проверка становится препятствием на вашем пути
 (одна из моих любимых цитат такова: «Все модели неверны, но некоторые 
полезны»).
</p><p><b>Предыстория</b>
</p><p>Обработка исключений зародилась в таких системах, как <i>PL/1</i> и <i>Mesa</i>, а затем мигрировала в <i>CLU, Smalltalk, Modula-3, Ada, Eiffel, С++, Python, Java</i> и в появившиеся после <i>Java</i> языки <i>Ruby</i> и <i>С#</i>. Конструкции <i>Java</i> сходны с конструкциями <i>C++</i>, кроме тех аспектов, в которых решения <i>C++</i> приводили к проблемам.
</p><p>Обработка исключений была добавлена в <i>C++</i> на довольно позднем этапе стандартизации. Модель исключений в <i>C++</i> в основном была заимствована из <i>CLU</i>. Впрочем, в то время существовали и другие языки с поддержкой обработки исключений: <i>Ada, Smalltalk </i>(в обоих были исключения, но отсутствовали их спецификации) и <i>Modula-З</i> (в котором существовали и исключения, и их спецификации).
</p><p>Следуя подходу <i>CLU</i> при разработке исключений <i>C++</i>, 
Страуструп считал, что основной целью является сокращение объема кода 
восстановления после ошибки. Вероятно, он видел немало программистов, 
которые не писали код обработки ошибок на <i>C</i>, поскольку объем этого кода был устрашающим, а размещение выглядело нелогично. В результате все происходило в стиле <i>C</i>: ошибки в коде игнорировались, а с проблемами справлялись при помощи отладчиков. Чтобы исключения реально заработали, <i>C</i>-программисты
 должны были писать «лишний» код, без которого они обычно обходились. 
Таким образом, объем нового кода не должен быть чрезмерным. Важно 
помнить об этих целях, говоря об эффективности контролируемых исключений
 в <i>Java</i>.
</p><p><i>C++</i> добавил к идее <i>CLU</i> дополнительную возможность: 
спецификации исключений, то есть включение в сигнатуру метода информации
 об исключениях, возникающих при вызове. В действительности спецификация
 исключения несет двойной смысл. Она означает: «Я возбуждаю это 
исключение в коде, а вы его обрабатываете». Но она также может означать:
 «Я игнорирую исключение, которое может возникнуть в моем коде; 
обеспечьте его обработку». При освещении механизмов исключений мы 
концентрировались на «обеспечении обработки», но здесь мне хотелось бы 
поближе рассмотреть тот факт, что зачастую исключения игнорируются, и 
именно этот факт может быть отражен в спецификации исключения.
</p><p>В <i>C++</i> спецификация исключения не входит в информацию о 
типе функции. Единственная проверка, осуществляемая во время компиляции,
 относится к согласованному использованию исключений: к примеру, если 
функция или метод возбуждает исключения, то перегруженная или 
переопределенная версия должна возбуждать те же самые исключения. 
Однако, в отличие от <i>Java</i>, компилятор не проверяет, действительно
 ли функция или метод возбуждают данное исключение, или полноту 
спецификации (то есть описывает ли она все исключения, возможные для 
этого метода). Если возбуждается исключение, не входящее в спецификацию,
 программа на <i>C++</i> вызывает функцию <i>unexpected()</i> из стандартной библиотеки.
</p><p>Интересно отметить, что из-за использования шаблонов (<i>templates</i>) спецификации исключений отсутствуют в стандартной библиотеке <i>C++</i>. В <i>Java</i> существуют ограничения на использование параметризованных типов со спецификациями исключений.
</p><p><b>Перспективы</b>
</p><p>Во-первых, язык <i>Java</i>, по сути, стал первопроходцем в использовании контролируемых исключений (несомненно из-за спецификаций исключений <i>C++</i> и того факта, что программисты на <i>C++</i> не уделяли им слишком много внимания). Это был эксперимент, повторить который с тех пор пока не решился еще ни один язык.
</p><p>Во-вторых, контролируемые исключения однозначно хороши при 
рассмотрении вводных примеров и в небольших программах. Оказывается, что
 трудноуловимые проблемы начинают проявляться при разрастании программы.
 Конечно, программы не разрастаются тут же и сразу, но они имеют 
тенденцию расти незаметно. И когда языки, не предназначенные для больших
 проектов, используются для небольших, но растущих проектов, мы в 
некоторый момент с удивлением обнаруживаем, что ситуация изменилась с 
управляемой на затруднительную в управлении. Именно это, как я полагаю, 
может произойти, когда проверок типов слишком много, и особенно в 
отношении контролируемых исключений.
</p><p>Одним из важных достижений <i>Java</i> стала унификация модели передачи информации об ошибках, так как обо всех ошибках сообщается посредством исключений. В <i>C++</i> этого не было, из-за обратной совместимости с <i>C</i> и возможности задействовать старую модель простого игнорирования ошибок. Когда <i>Java</i> изменил модель <i>C++</i>
 так, что сообщать об ошибках стало возможно только посредством 
исключений, необходимость в дополнительных мерах принуждения в виде 
контролируемых исключений сократилась.
</p><p>В прошлом я твердо считал, что для разработки надежных программ 
необходимы и контролируемые исключения, и строгая статическая проверка 
типов. Однако опыт, полученный лично и со стороны1, с языками, более 
динамичными, чем статичными, привел меня к мысли, что на самом деле 
главные преимущества обусловлены следующими аспектами:
</p>
<ul>
<li>Унификация модели сообщения об ошибках посредством исключений 
(независимо от того, заставляет ли компилятор программиста их 
обрабатывать).
</li>
</ul>
<ul>
<li>Проверка типов, не привязанная к тому, когда она проводится — на стадии компиляции или во время работы программы.
</li>
</ul>
<p>Вдобавок снижение ограничений времени компиляции весьма положительно 
отражается на продуктивности программиста. С другой стороны, для 
компенсации чрезмерной жесткости статической проверки типов необходимы 
рефлексия и параметризация, как вы убедитесь в некоторых примерах книги.
Некоторые уверяли меня, что все сказанное является кощунством, 
безнадежно испортит мою репутацию, приведет к гибели цивилизации и 
провалу большой доли программных проектов. Вера в то, что выявление 
ошибок на стадии компиляции спасет ваш проект, весьма сильна, но гораздо
 важнее сознавать ограничения того, на что способен компьютер. Стоит 
помнить:
«Хороший язык программирования помогает программистам писать хорошие 
программы. Ни один из языков программирования не может запретить своим 
пользователям писать плохие программы».
В любом случае исчезновение когда-либо из <i>Java</i> контролируемых 
исключений весьма маловероятно. Это слишком радикальное изменение языка,
 и защитники их в Sun весьма сильны. История Sun неотделима от политики 
абсолютной обратной совместимости — фактически любое программное 
обеспечение Sun работает на любом оборудовании Sun, как бы старо оно ни 
было. Но, если вы чувствуете, что контролируемые исключения становятся 
для вас препятствием (особенно если вас заставляют обрабатывать 
исключение, а вы не знаете, как с ним поступить), существует несколько 
вариантов.
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.9F.D0.B5.D1.80.D0.B5.D0.B4.D0.B0.D1.87.D0.B0_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9_.D0.BD.D0.B0_.D0.BA.D0.BE.D0.BD.D1.81.D0.BE.D0.BB.D1.8C">Передача исключений на консоль</span></h2>
<p>В несложных программах, как во многих примерах данной книги, простейшим решением является передача исключения за пределы метода <i><b>main()</b></i>, на консоль. К примеру, при открытии файла для чтения (подробности вы вскоре узнаете) необходимо открыть и закрыть поток <i><b>FilelnputStream</b></i>,
 который возбуждает исключения. В небольшой программе можно поступить 
следующим образом (подобный подход характерен для многих примеров 
книги):
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/MainException.java</span>
<span class="kw2">import</span> <span class="co2">java.io.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> MainException <span class="br0">{</span>
  <span class="co1">// Передаем все исключения на консоль:</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="kw2">throws</span> <span class="kw21">Exception</span> <span class="br0">{</span>
    <span class="co1">// Открываем файл&nbsp;:</span>
    <span class="kw20">FileInputStream</span> file =
      <span class="kw2">new</span> <span class="kw20">FileInputStream</span><span class="br0">(</span><span class="st0">"MainException.java"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Используем файл ...</span>
    <span class="co1">// Закрываем файл:</span>
    file.<span class="me1">close</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>Заметьте, что <i><b>main()</b></i> — такой же метод, как и все прочие; он тоже может иметь спецификацию исключений, и здесь типом исключения является <i><b>Exception</b></i>,
 базовый класс всех контролируемых исключений. Передавая его на консоль,
 вы освобождаетесь от необходимости написания предложений <i><b>try-catch</b></i> в теле метода <i><b>main()</b></i>.
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.9F.D1.80.D0.B5.D0.BE.D0.B1.D1.80.D0.B0.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BA.D0.BE.D0.BD.D1.82.D1.80.D0.BE.D0.BB.D0.B8.D1.80.D1.83.D0.B5.D0.BC.D1.8B.D1.85_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9_.D0.B2_.D0.BD.D0.B5.D0.BA.D0.BE.D0.BD.D1.82.D1.80.D0.BE.D0.BB.D0.B8.D1.80.D1.83.D0.B5.D0.BC.D1.8B.D0.B5">Преобразование контролируемых исключений в неконтролируемые</span></h2>
<p>Рассмотренный выше подход хорош при написании метода <i><b>main()</b></i>,
 но в более общих ситуациях не слишком полезен. Подлинная проблема 
возникает при написании тела самого обычного метода, когда при вызове 
другого метода вы четко сознаете: «Понятия не имею, что делать с 
исключением дальше, но „съедать" мне его не хочется, так же как и 
печатать банальное сообщение». Проблема решается при помощи цепочек 
исключений. Управляемое исключение просто «заворачивается» в класс <i><b>RuntimeException</b></i> примерно так:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"> <span class="kw2">try</span> <span class="br0">{</span>
        <span class="co1">// ... делаем что-нибудь полезное </span>
     <span class="br0">}</span> саtch <span class="br0">(</span>НеЗнаюЧтоДелатьСЭтимКонтролируемымИсключением е<span class="br0">)</span> <span class="br0">{</span> <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">RuntimeException</span><span class="br0">(</span>e<span class="br0">)</span><span class="sy0">;</span>
 <span class="br0">}</span></pre></div></div>
<p>Решение идеально подходит для тех случаев, когда вы хотите «подавить»
 контролируемое исключение: вы не «съедаете» его, вам не приходится 
описывать его в своей спецификации исключений, и благодаря цепочке 
исключений вы не теряете информацию об исходном исключении.
</p><p>Описанная методика позволяет игнорировать исключение и пустить 
его «всплывать» вверх по стеку вызова без необходимости писать блоки <i><b>try-catch</b></i>
 и (или) спецификации исключения. Впрочем, при этом вы все равно можете 
перехватить и обработать конкретное исключение, используя метод <i><b>getCause()</b></i>, как показано ниже:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: exceptions/TurnOffChecking.java</span>
<span class="co1">// "Подавление" контролируемых исключений</span>
<span class="kw2">import</span> <span class="co2">java.io.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="kw2">static</span> <span class="co2">net.mindview.util.Print.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> WrapCheckedException <span class="br0">{</span>
  <span class="kw3">void</span> throwRuntimeException<span class="br0">(</span><span class="kw3">int</span> type<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">try</span> <span class="br0">{</span>
      <span class="kw1">switch</span><span class="br0">(</span>type<span class="br0">)</span> <span class="br0">{</span>
        <span class="kw1">case</span> <span class="nu0">0</span>: <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw20">FileNotFoundException</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="nu0">1</span>: <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw20">IOException</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw1">case</span> <span class="nu0">2</span>: <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">RuntimeException</span><span class="br0">(</span><span class="st0">"Where am I?"</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw1">default</span>: <span class="kw2">return</span><span class="sy0">;</span>
      <span class="br0">}</span>
    <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">Exception</span> e<span class="br0">)</span> <span class="br0">{</span> <span class="co1">// Превращаем в неконтролируемое:</span>
      <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">RuntimeException</span><span class="br0">(</span>e<span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span>
&nbsp;
<span class="kw2">class</span> SomeOtherException <span class="kw2">extends</span> <span class="kw21">Exception</span> <span class="br0">{</span><span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> TurnOffChecking <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    WrapCheckedException wce = <span class="kw2">new</span> WrapCheckedException<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Можно вызвать throwRuntimeException() без блока try</span>
    <span class="co1">// и позволить исключению RuntimeException покинуть метод:</span>
    wce.<span class="me1">throwRuntimeException</span><span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Или перехватить исключение:</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> <span class="nu0">4</span><span class="sy0">;</span> i++<span class="br0">)</span>
      <span class="kw2">try</span> <span class="br0">{</span>
        <span class="kw1">if</span><span class="br0">(</span>i <span class="sy0">&lt;</span> <span class="nu0">3</span><span class="br0">)</span>
          wce.<span class="me1">throwRuntimeException</span><span class="br0">(</span>i<span class="br0">)</span><span class="sy0">;</span>
        <span class="kw1">else</span>
          <span class="kw2">throw</span> <span class="kw2">new</span> SomeOtherException<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span>SomeOtherException e<span class="br0">)</span> <span class="br0">{</span>
          print<span class="br0">(</span><span class="st0">"SomeOtherException: "</span> + e<span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">RuntimeException</span> re<span class="br0">)</span> <span class="br0">{</span>
        <span class="kw2">try</span> <span class="br0">{</span>
          <span class="kw2">throw</span> re.<span class="me1">getCause</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw20">FileNotFoundException</span> e<span class="br0">)</span> <span class="br0">{</span>
          print<span class="br0">(</span><span class="st0">"FileNotFoundException: "</span> + e<span class="br0">)</span><span class="sy0">;</span>
        <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw20">IOException</span> e<span class="br0">)</span> <span class="br0">{</span>
          print<span class="br0">(</span><span class="st0">"IOException: "</span> + e<span class="br0">)</span><span class="sy0">;</span>
        <span class="br0">}</span> <span class="kw2">catch</span><span class="br0">(</span><span class="kw21">Throwable</span> e<span class="br0">)</span> <span class="br0">{</span>
          print<span class="br0">(</span><span class="st0">"Throwable: "</span> + e<span class="br0">)</span><span class="sy0">;</span>
        <span class="br0">}</span>
      <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>FileNotFoundException: java.io.FileNotFoundException
IOException: java.io.IOException
Throwable: java.lang.RuntimeException: Where am I?
SomeOtherException: SomeOtherException
</pre>
<p>&lt;/spoiler&gt;
Метод <i><b>WrapCheckedException.throwRuntimeException()</b></i> содержит код, генерирующий различные типы исключений. Они перехватываются и «заворачиваются» в объекты <i><b>RuntimeException</b></i>, становясь таким образом «причиной» этих ис­ключений.
При взгляде на класс <i><b>TurnOffChecking</b></i> нетрудно заметить, что вызвать метод <i><b>throwRuntimeException()</b></i> можно и без блока <i><b>try</b></i>,
 поскольку он не возбуждает никаких контролируемых исключений. Но когда 
вы будете готовы перехватить исключение, у вас будет возможность 
перехватить любое из них — достаточно поместить свой код в блок <i><b>try</b></i>. Начинаете вы с перехвата исключений, которые, как вы знаете, могут явно возникнуть в коде блока <i><b>try</b></i>, — в нашем случае первым делом перехватывается <i><b>SomeOtherException</b></i>. В конце вы перехватываете <i><b>RuntimeException</b></i> и заново возбуждаете исключение, являющееся его причиной (получая последнее методом <i><b>getCause()</b></i>, «завернутое» исключение). Так извлекаются из­начальные исключения, обрабатываемые в своих предложениях <i><b>catch</b></i>.
Методика «заворачивания» управляемых исключений в объекты <i><b>RuntimeException</b></i> встречается в некоторых примерах книги. Другое возможное решение — создание собственного класса, производного от <i><b>RuntimeException</b></i>. Перехватывать такое исключение не обязательно, но, если вы захотите, такая возможность существует.
</p>
<h2><span class="mw-headline" id=".D0.9E.D1.81.D0.BD.D0.BE.D0.B2.D0.BD.D1.8B.D0.B5_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D0.B0_.D0.BE.D0.B1.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.BA.D0.B8_.D0.B8.D1.81.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD.D0.B8.D0.B9">Основные правила обработки исключений</span></h2>
<p>Используйте исключения для того, чтобы:
</p>
<hr>
<ul>
<li><span style="color:#800000">обработать ошибку на текущем уровне (избегайте перехватывать исключения, если вы не знаете, как с ними поступить);</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">исправить проблему и снова вызвать метод, возбудивший исключение;</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">предпринять все необходимые действия и продолжить выполнение без повторного вызова метода;</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">попытаться найти альтернативный результат вместо того, который должен был бы произвести вызванный метод;</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">сделать все возможное в текущем контексте и заново возбудить это же исключение, перенаправив его на более высокий уровень;</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">сделать все, что можно в текущем контексте, и возбудить новое исключение, перенаправив его на более высокий уровень;</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">завершить работу программы;</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">упростить программу (если используемая 
вами схема обработки исключений делает все только сложнее, значит, она 
никуда не годится);</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">добавить вашей библиотеке и программе 
безопасности (сначала это поможет в отладке программы, а в дальнейшем 
окупится ее надежностью).</span>
</li>
</ul>
<h2><span class="mw-headline" id=".D0.A0.D0.B5.D0.B7.D1.8E.D0.BC.D0.B5">Резюме</span></h2>
<p>Исключения являются неотъемлемой частью программирования на <i>Java</i>;
 существует некий барьер, который невозможно преодолеть без умения 
работать с ними. По этой причине исключения были представлены именно в 
этой части книги — многими библиотеками (скажем, библиотекой 
ввода/вывода) просто невозможно нормально пользоваться без обработки 
исключений.
Одно из преимуществ обработки исключений состоит в том, что она 
позволяет сосредоточиться на решаемой проблеме, а затем обработать все 
ошибки в описанном коде в другом месте. Хотя исключения обычно 
описываются как средство передачи информации и восстановления после 
ошибок на стадии выполнения, я сильно сомневаюсь, что «восстановление» 
часто реализуется на практике. По моей оценке, это происходит не более 
чем в 10% случаев, и даже тогда в основном сводится к раскрутке стека к 
заведомо стабильному состоянию вместо реального выполнения действий по 
восстановлению. На мой взгляд, ценность исключений в основном 
обусловлена именно передачей информации. <i>Java</i> фактически 
настаивает, что программа должна сообщать обо всех ошибках в виде 
исключений, и именно это обстоятельство обеспечивает <i>Java</i> большое преимущество перед языками вроде <i>C++</i>, где программа может сообщать об ошибках разными способами (а то и не сообщать вовсе).

</p>
                <p><br>
                </p>
                <hr>
                <p><a href="http://wikijava.it-cache.net/index.php" title="Thinking in Java 4th edition">назад в Оглавление</a>
                </p><p><br>
                </p>
<!-- 
NewPP limit report
CPU time usage: 4.284 seconds
Real time usage: 4.321 seconds
Preprocessor visited node count: 466/1000000
Preprocessor generated node count: 960/1000000
Post‐expand include size: 243/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key wjava2-wj_:pcache:idhash:26-0!*!*!!ru!*!* and timestamp 20140813033343
 -->
</div>								<div class="printfooter">
				Источник — «<a href="http://wikijava.org.ua/index.php?title=Glava_12_Thinking_in_Java_4th_edition&amp;oldid=36">http://wikijava.org.ua/index.php?title=Глава_12_Thinking_in_Java_4th_edition&amp;oldid=36</a>»				</div>
                                <div id="catlinks" class="catlinks"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D0%B8" title="Служебная:Категории">Категории</a>: <ul><li><a href="http://wikijava.org.ua/index.php?title=%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D1%8F:%D0%9A%D0%BD%D0%B8%D0%B3%D0%B8" title="Категория:Книги">Книги</a></li><li><a href="http://wikijava.org.ua/index.php?title=%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D1%8F:Java" title="Категория:Java">Java</a></li></ul></div></div>												<div class="visualClear"></div>
            </div>
		</div>
		<div id="mw-navigation">
			<h2>Навигация</h2>
			<div id="mw-head">
				<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
	<h3 id="p-personal-label">Персональные инструменты</h3>
	<ul>
<li id="pt-login"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:%D0%92%D1%85%D0%BE%D0%B4&amp;returnto=%D0%93%D0%BB%D0%B0%D0%B2%D0%B0+12+Thinking+in+Java+4th+edition" title="Здесь можно зарегистрироваться в системе, но это необязательно. [o]" accesskey="o">Представиться системе</a></li>	</ul>
</div>
				<div id="left-navigation">
					<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
	<h3 id="p-namespaces-label">Пространства имён</h3>
	<ul>
					<!--<li  id="ca-nstab-main" class="selected"><span><a href="index.php@title=Glava_12_Thinking_in_Java_4th_edition.html"  title="Просмотр основной страницы [c]" accesskey="c">Статья</a></span></li>-->
					<!--<li  id="ca-talk" class="new"><span><a href="http://wikijava.org.ua/index.php?title=%D0%9E%D0%B1%D1%81%D1%83%D0%B6%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5:%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_12_Thinking_in_Java_4th_edition&amp;action=edit&amp;redlink=1"  title="Обсуждение основной страницы [t]" accesskey="t">Обсуждение</a></span></li>-->
			</ul>
</div>
<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
	<h3 id="mw-vector-current-variant">
		</h3>
	<h3 id="p-variants-label"><span>Варианты</span><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
				</div>
				<div id="right-navigation">
					<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
	<h3 id="p-views-label">Просмотры</h3>
	<ul>
					<!--<li id="ca-view" class="selected"><span><a href="index.php@title=Glava_12_Thinking_in_Java_4th_edition.html" >Читать</a></span></li>-->
					<!--<li id="ca-viewsource"><span><a href="http://wikijava.org.ua/index.php?title=%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_12_Thinking_in_Java_4th_edition&amp;action=edit"  title="Эта страница защищена от изменений, но вы можете посмотреть и скопировать её исходный текст [e]" accesskey="e">Просмотр</a></span></li>-->
					<!--<li id="ca-history" class="collapsible"><span><a href="http://wikijava.org.ua/index.php?title=%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_12_Thinking_in_Java_4th_edition&amp;action=history"  title="Журнал изменений страницы [h]" accesskey="h">История</a></span></li>-->
			</ul>
</div>
<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
	<h3 id="p-cactions-label"><span>Действия</span><a href="http://wikijava.it-cache.net/index.php@title=Glava_12_Thinking_in_Java_4th_edition.html#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
<div id="p-search" role="search">
	<h3><label for="searchInput">Поиск</label></h3>
	<form action="http://wikijava.org.ua/index.php" id="searchform">
				<div id="simpleSearch">
						<input name="search" placeholder="Поиск" title="Искать в WikiJava: Wiki of Java: викифицированные книги и статьи по Java [f]" accesskey="f" id="searchInput">						<button type="submit" name="button" title="Найти страницы, содержащие указанный текст" id="searchButton"><img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2012_files/search-ltr.asc" alt="Найти" height="13" width="12"></button>								<input name="title" value="Служебная:Поиск" type="hidden">
		</div>
	</form>
</div>
				</div>
			</div>
			<div id="mw-panel">
					<!--<div id="p-logo" role="banner"><a style="background-image: url(/skins/common/images/wikijava.png);" href="index.php@title=Заглавная_страница.html"  title="Перейти на заглавную страницу"></a></div>-->
				<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
	<h3 id="p-navigation-label">Навигация</h3>
	<div class="body">
        <ul>
            <li id="n-mainpage-description"><a href="http://wikijava.org.ua/index.php?title=%D0%97%D0%B0%D0%B3%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F_%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0" title="Перейти на заглавную страницу [z]" accesskey="z">Заглавная страница</a></li>
            <li id="n-recentchanges"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:%D0%A1%D0%B2%D0%B5%D0%B6%D0%B8%D0%B5_%D0%BF%D1%80%D0%B0%D0%B2%D0%BA%D0%B8" title="Список последних изменений [r]" accesskey="r">Свежие правки</a></li>
            <li id="n-.D0.9A.D0.BD.D0.B8.D0.B3.D0.B8-Java"><a href="http://wikijava.org.ua/index.php?title=%D0%9A%D0%BD%D0%B8%D0%B3%D0%B8_Java">Книги Java</a></li>
            <li id="n-.D0.A1.D1.82.D0.B0.D1.82.D1.8C.D0.B8-Java"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D1%82%D0%B0%D1%82%D1%8C%D0%B8_Java">Статьи Java</a></li>
            <li id="n-Java-.D0.BF.D0.BE.D1.80.D1.82.D0.B0.D0.BB"><a href="http://wikijava.org.ua/index.php?title=Java-portal">Java портал</a></li>
            <li id="n-help"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D0%BF%D1%80%D0%B0%D0%B2%D0%BA%D0%B0:%D0%A1%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B0%D0%BD%D0%B8%D0%B5" title="Место, где можно получить справку">Справка</a></li>
            <li id="n-.D0.A1.D1.82.D0.B0.D1.82.D0.B8.D1.81.D1.82.D0.B8.D0.BA.D0.B0"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D1%82%D0%B0%D1%82%D0%B8%D1%81%D1%82%D0%B8%D0%BA%D0%B0">Статистика</a></li>
        </ul>
	</div>
</div>
<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
	<h3 id="p-tb-label">Инструменты</h3>
	<div class="body">
		<ul>
			<li id="t-whatlinkshere"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:%D0%A1%D1%81%D1%8B%D0%BB%D0%BA%D0%B8_%D1%81%D1%8E%D0%B4%D0%B0/%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_12_Thinking_in_Java_4th_edition" title="Список всех страниц, ссылающихся на данную [j]" accesskey="j">Ссылки сюда</a></li>
			<li id="t-recentchangeslinked"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:%D0%A1%D0%B2%D1%8F%D0%B7%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5_%D0%BF%D1%80%D0%B0%D0%B2%D0%BA%D0%B8/%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_12_Thinking_in_Java_4th_edition" title="Последние изменения в страницах, на которые ссылается эта страница [k]" accesskey="k">Связанные правки</a></li>
			<li id="t-specialpages"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:%D0%A1%D0%BF%D0%B5%D1%86%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D1%8B" title="Список служебных страниц [q]" accesskey="q">Спецстраницы</a></li>
			<li id="t-print"><a href="http://wikijava.org.ua/index.php?title=%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_12_Thinking_in_Java_4th_edition&amp;printable=yes" rel="alternate" title="Версия этой страницы для печати [p]" accesskey="p">Версия для печати</a></li>
			<li id="t-permalink"><a href="http://wikijava.org.ua/index.php?title=%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_12_Thinking_in_Java_4th_edition&amp;oldid=36" title="Постоянная ссылка на эту версию страницы">Постоянная ссылка</a></li>
			<li id="t-info"><a href="http://wikijava.org.ua/index.php?title=%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_12_Thinking_in_Java_4th_edition&amp;action=info">Сведения о странице</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id="p-.D0.94.D1.80.D1.83.D0.B3.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D1.8B" aria-labelledby="p-.D0.94.D1.80.D1.83.D0.B3.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D1.8B-label">
	<h3 id="p-.D0.94.D1.80.D1.83.D0.B3.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D1.8B-label">Другие проекты</h3>
	<div class="body">
		<ul>
			<li id="n-rastafara.com.ua"><a href="http://rastafara.com.ua/" rel="nofollow">rastafara.com.ua</a></li>
			<li id="n-rastafara-blog"><a href="http://sergey-rastafara.blogspot.com/" rel="nofollow">rastafara blog</a></li>
			<li id="n-rastaban"><a href="http://rastaban.com.ua/" rel="nofollow">rastaban</a></li>
		</ul>
	</div>
</div>
			</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> Последнее изменение этой страницы: 21:48, 16 февраля 2014.</li>
											<li id="footer-info-viewcount">К этой странице обращались 1738 раза.</li>
											<li id="footer-info-copyright">Содержимое доступно по лицензии <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 или более поздняя</a> (если не указано иное).</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="http://wikijava.org.ua/index.php?title=WikiJava:_Wiki_of_Java:_%D0%B2%D0%B8%D0%BA%D0%B8%D1%84%D0%B8%D1%86%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5_%D0%BA%D0%BD%D0%B8%D0%B3%D0%B8_%D0%B8_%D1%81%D1%82%D0%B0%D1%82%D1%8C%D0%B8_%D0%BF%D0%BE_Java:%D0%9F%D0%BE%D0%BB%D0%B8%D1%82%D0%B8%D0%BA%D0%B0_%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B4%D0%B5%D0%BD%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8" title="WikiJava: Wiki of Java: викифицированные книги и статьи по Java:Политика конфиденциальности">Политика конфиденциальности</a></li>
											<li id="footer-places-about"><a href="http://wikijava.org.ua/index.php?title=WikiJava:_Wiki_of_Java:_%D0%B2%D0%B8%D0%BA%D0%B8%D1%84%D0%B8%D1%86%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5_%D0%BA%D0%BD%D0%B8%D0%B3%D0%B8_%D0%B8_%D1%81%D1%82%D0%B0%D1%82%D1%8C%D0%B8_%D0%BF%D0%BE_Java:%D0%9E%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5" title="WikiJava: Wiki of Java: викифицированные книги и статьи по Java:Описание">Описание WikiJava: Wiki of Java: викифицированные книги и статьи по Java</a></li>
											<li id="footer-places-disclaimer"><a href="http://wikijava.org.ua/index.php?title=WikiJava:_Wiki_of_Java:_%D0%B2%D0%B8%D0%BA%D0%B8%D1%84%D0%B8%D1%86%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5_%D0%BA%D0%BD%D0%B8%D0%B3%D0%B8_%D0%B8_%D1%81%D1%82%D0%B0%D1%82%D1%8C%D0%B8_%D0%BF%D0%BE_Java:%D0%9E%D1%82%D0%BA%D0%B0%D0%B7_%D0%BE%D1%82_%D0%BE%D1%82%D0%B2%D0%B5%D1%82%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D0%B8" title="WikiJava: Wiki of Java: викифицированные книги и статьи по Java:Отказ от ответственности">Отказ от ответственности</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
					<li id="footer-copyrightico">
						<a href="http://www.gnu.org/copyleft/fdl.html"><img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2012_files/gnu-fdl.png" alt="GNU Free Documentation License 1.3 или более поздняя" height="31" width="88"></a>
					</li>
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2012_files/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" height="31" width="88"></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.vector.collapsibleNav","ext.vector.collapsibleTabs","ext.vector.editWarning","ext.vector.simpleSearch","skins.vector.collapsibleNav"],null,true);
}</script>
<script>if(window.mw){
mw.loader.state({"site":"ready"});
}</script>
<!-- Served in 0.233 secs. -->
	

</body></html>