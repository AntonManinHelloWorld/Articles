<!DOCTYPE html>
<html dir="ltr" class="client-nojs" lang="ru"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8"><title>Глава 11 Thinking in Java 4th edition — WikiJava: Wiki of Java: викифицированные книги и статьи по Java</title>
<meta name="generator" content="MediaWiki 1.22.2">
<link rel="shortcut icon" href="http://wikijava.it-cache.net/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="http://wikijava.it-cache.net/opensearch_desc.php" title="WikiJava: Wiki of Java: викифицированные книги и статьи по Java (ru)">
<link rel="EditURI" type="application/rsd+xml" href="http://wikijava.it-cache.net/api.php@action=rsd">
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="WikiJava: Wiki of Java: викифицированные книги и статьи по Java&nbsp;— Atom-лента" href="http://wikijava.it-cache.net/index.php@title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F%253A%D0%A1%D0%B2%D0%B5%D0%B6%D0%B8%D0%B5_%D0%BF%D1%80%D0%B0%D0%B2%D0%BA%D0%B8&amp;feed=atom">
<link rel="stylesheet" href="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2011_files/style3.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<style>a:lang(ar),a:lang(ckb),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}
/* cache key: wjava2-wj_:resourceloader:filter:minify-css:7:32e7e505403c81fe0a24e297ef166436 */</style>

<script src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2011_files/style1.css"></script><script src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2011_files/load.html"></script>
<script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Глава_11_Thinking_in_Java_4th_edition","wgTitle":"Глава 11 Thinking in Java 4th edition","wgCurRevisionId":35,"wgRevisionId":35,"wgArticleId":25,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Книги","Java"],"wgBreakFrames":false,"wgPageContentLanguage":"ru","wgPageContentModel":"wikitext","wgSeparatorTransformTable":[",\t."," \t,"],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],"wgMonthNamesShort":["","янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"],"wgRelevantPageName":"Глава_11_Thinking_in_Java_4th_edition","wgIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgVectorEnabledModules":{"collapsiblenav":true,"collapsibletabs":true,"editwarning":true,"expandablesearch":false,"footercleanup":false,"sectioneditlinks":false,"simplesearch":true,"experiments":true}});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"vector","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"vector-simplesearch":1,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,
"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"useeditwarning":1,"prefershttps":1,"language":"ru","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"variant":"ru"});},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: wjava2-wj_:resourceloader:filter:minify-js:7:07bb1f4d2452379e70abca47c4cde6d9 */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax","skins.vector.js"]);
}</script>
<style type="text/css">/*<![CDATA[*/
.source-java5 {line-height: normal;}
.source-java5 li, .source-java5 pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for java5
 * CSS class: source-java5, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.java5.source-java5 .de1, .java5.source-java5 .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.java5.source-java5  {font-family:monospace;}
.java5.source-java5 .imp {font-weight: bold; color: red;}
.java5.source-java5 li, .java5.source-java5 .li1 {font-weight: normal; vertical-align:top;}
.java5.source-java5 .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.java5.source-java5 .li2 {font-weight: bold; vertical-align:top;}
.java5.source-java5 .kw1 {color: #000000;  font-weight: bold;}
.java5.source-java5 .kw2 {color: #000000; font-weight: bold;}
.java5.source-java5 .kw3 {color: #006600; font-weight: bold;}
.java5.source-java5 .kw4 {color: #006600; font-weight: bold;}
.java5.source-java5 .kw5 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw6 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw7 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw8 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw9 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw10 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw11 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw12 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw13 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw14 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw15 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw16 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw17 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw18 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw19 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw20 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw21 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw22 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw23 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw24 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw25 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw26 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw27 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw28 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw29 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw30 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw31 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw32 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw33 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw34 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw35 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw36 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw37 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw38 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw39 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw40 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw41 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw42 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw43 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw44 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw45 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw46 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw47 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw48 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw49 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw50 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw51 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw52 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw53 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw54 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw55 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw56 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw57 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw58 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw59 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw60 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw61 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw62 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw63 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw64 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw65 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw66 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw67 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw68 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw69 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw70 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw71 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw72 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw73 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw74 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw75 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw76 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw77 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw78 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw79 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw80 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw81 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw82 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw83 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw84 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw85 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw86 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw87 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw88 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw89 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw90 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw91 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw92 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw93 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw94 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw95 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw96 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw97 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw98 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw99 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw100 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw101 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw102 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw103 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw104 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw105 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw106 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw107 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw108 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw109 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw110 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw111 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw112 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw113 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw114 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw115 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw116 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw117 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw118 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw119 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw120 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw121 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw122 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw123 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw124 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw125 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw126 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw127 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw128 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw129 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw130 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw131 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw132 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw133 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw134 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw135 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw136 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw137 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw138 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw139 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw140 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw141 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw142 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw143 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw144 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw145 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw146 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw147 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw148 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw149 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw150 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw151 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw152 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw153 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw154 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw155 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw156 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw157 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw158 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw159 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw160 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw161 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw162 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw163 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw164 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw165 {color: #003399; font-weight: bold;}
.java5.source-java5 .kw166 {color: #003399; font-weight: bold;}
.java5.source-java5 .co1 {color: #666666; font-style: italic;}
.java5.source-java5 .co2 {color: #006699;}
.java5.source-java5 .co3 {color: #008000; font-style: italic; font-weight: bold;}
.java5.source-java5 .coMULTI {color: #666666; font-style: italic;}
.java5.source-java5 .es0 {color: #000099; font-weight: bold;}
.java5.source-java5 .br0 {color: #009900;}
.java5.source-java5 .sy0 {color: #339933;}
.java5.source-java5 .st0 {color: #0000ff;}
.java5.source-java5 .nu0 {color: #cc66cc;}
.java5.source-java5 .me1 {color: #006633;}
.java5.source-java5 .me2 {color: #006633;}
.java5.source-java5 .ln-xtra, .java5.source-java5 li.ln-xtra, .java5.source-java5 div.ln-xtra {background-color: #ffc;}
.java5.source-java5 span.xtra { display:block; }

/*]]>*/
</style><!--[if lt IE 7]><style type="text/css">body{behavior:url("/skins/vector/csshover.min.htc")}</style><![endif]--></head>
<body class="mediawiki ltr sitedir-ltr ns-0 ns-subject page-Глава_11_Thinking_in_Java_4th_edition skin-vector action-view vector-animateLayout">
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div id="mw-js-message" style="display:none;"></div>
						<h1 id="firstHeading" class="firstHeading" lang="ru"><span dir="auto">Глава 11 Thinking in Java 4th edition</span></h1>
			<div id="bodyContent">
								<div id="siteSub">Материал из WikiJava: Wiki of Java: викифицированные книги и статьи по Java</div>
								<div id="contentSub"></div>
												<div id="jump-to-nav" class="mw-jump">
					Перейти к:					<a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#mw-navigation">навигация</a>, 					<a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#p-search">поиск</a>
				</div>
				<div id="mw-content-text" dir="ltr" class="mw-content-ltr" lang="ru"><table style="clear: right; margin-bottom: .5em; float: right; padding: .5em 0 .8em 1.4em; background: none; width: auto;" cellpadding="0" cellspacing="0">
<tbody><tr>
<td> <div id="toc" class="toc"><div id="toctitle"><h2>Содержание</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#.D0.9A.D0.9E.D0.9D.D0.A2.D0.95.D0.99.D0.9D.D0.95.D0.A0.D0.AB_.D0.98_.D0.A5.D0.A0.D0.90.D0.9D.D0.95.D0.9D.D0.98.D0.95_.D0.9E.D0.91.D0.AA.D0.95.D0.9A.D0.A2.D0.9E.D0.92"><span class="tocnumber">1</span> <span class="toctext"><b>КОНТЕЙНЕРЫ И ХРАНЕНИЕ ОБЪЕКТОВ</b></span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#.D0.9F.D0.B0.D1.80.D0.B0.D0.BC.D0.B5.D1.82.D1.80.D0.B8.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D1.8B.D0.B5_.D0.B8_.D1.82.D0.B8.D0.BF.D0.B8.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D1.8B.D0.B5_.D0.BA.D0.BE.D0.BD.D1.82.D0.B5.D0.B9.D0.BD.D0.B5.D1.80.D1.8B"><span class="tocnumber">1.1</span> <span class="toctext"><b>Параметризованные и типизованные контейнеры</b></span></a></li>
<li class="toclevel-2 tocsection-3"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#.D0.9E.D1.81.D0.BD.D0.BE.D0.B2.D0.BD.D1.8B.D0.B5_.D0.BA.D0.BE.D0.BD.D1.86.D0.B5.D0.BF.D1.86.D0.B8.D0.B8"><span class="tocnumber">1.2</span> <span class="toctext"><b>Основные концепции</b></span></a></li>
<li class="toclevel-2 tocsection-4"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#.D0.94.D0.BE.D0.B1.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B3.D1.80.D1.83.D0.BF.D0.BF_.D1.8D.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82.D0.BE.D0.B2"><span class="tocnumber">1.3</span> <span class="toctext"><b>Добавление групп элементов</b></span></a></li>
<li class="toclevel-2 tocsection-5"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#.D0.92.D1.8B.D0.B2.D0.BE.D0.B4_.D1.81.D0.BE.D0.B4.D0.B5.D1.80.D0.B6.D0.B8.D0.BC.D0.BE.D0.B3.D0.BE_.D0.BA.D0.BE.D0.BD.D1.82.D0.B5.D0.B9.D0.BD.D0.B5.D1.80.D0.BE.D0.B2"><span class="tocnumber">1.4</span> <span class="toctext"><b>Вывод содержимого контейнеров</b></span></a></li>
<li class="toclevel-2 tocsection-6"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#List"><span class="tocnumber">1.5</span> <span class="toctext"><b>List</b></span></a></li>
<li class="toclevel-2 tocsection-7"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#.D0.98.D1.82.D0.B5.D1.80.D0.B0.D1.82.D0.BE.D1.80.D1.8B"><span class="tocnumber">1.6</span> <span class="toctext"><b>Итераторы</b></span></a></li>
<li class="toclevel-2 tocsection-8"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#Listlterator"><span class="tocnumber">1.7</span> <span class="toctext"><b>Listlterator</b></span></a></li>
<li class="toclevel-2 tocsection-9"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#LinkedList"><span class="tocnumber">1.8</span> <span class="toctext"><b>LinkedList</b></span></a></li>
<li class="toclevel-2 tocsection-10"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#.D0.A1.D1.82.D0.B5.D0.BA"><span class="tocnumber">1.9</span> <span class="toctext"><b>Стек</b></span></a></li>
<li class="toclevel-2 tocsection-11"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#.D0.9C.D0.BD.D0.BE.D0.B6.D0.B5.D1.81.D1.82.D0.B2.D0.BE"><span class="tocnumber">1.10</span> <span class="toctext"><b>Множество</b></span></a></li>
<li class="toclevel-2 tocsection-12"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#.D0.9A.D0.B0.D1.80.D1.82.D0.B0"><span class="tocnumber">1.11</span> <span class="toctext"><b>Карта</b></span></a></li>
<li class="toclevel-2 tocsection-13"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#.D0.9E.D1.87.D0.B5.D1.80.D0.B5.D0.B4.D1.8C"><span class="tocnumber">1.12</span> <span class="toctext"><b>Очередь</b></span></a></li>
<li class="toclevel-2 tocsection-14"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#PriorityQueue"><span class="tocnumber">1.13</span> <span class="toctext"><b>PriorityQueue</b></span></a></li>
<li class="toclevel-2 tocsection-15"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#Collection_.D0.B8_Iterator"><span class="tocnumber">1.14</span> <span class="toctext"><b>Collection и Iterator</b></span></a></li>
<li class="toclevel-2 tocsection-16"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#.D0.A1.D0.B8.D0.BD.D1.82.D0.B0.D0.BA.D1.81.D0.B8.D1.81_foreach_.D0.B8_.D0.B8.D1.82.D0.B5.D1.80.D0.B0.D1.82.D0.BE.D1.80.D1.8B"><span class="tocnumber">1.15</span> <span class="toctext"><b>Синтаксис foreach и итераторы</b></span></a></li>
<li class="toclevel-2 tocsection-17"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#.D0.98.D0.B4.D0.B8.D0.BE.D0.BC.D0.B0_.C2.AB.D0.BC.D0.B5.D1.82.D0.BE.D0.B4-.D0.B0.D0.B4.D0.B0.D0.BF.D1.82.D0.B5.D1.80.C2.BB"><span class="tocnumber">1.16</span> <span class="toctext"><b>Идиома «метод-адаптер»</b></span></a></li>
<li class="toclevel-2 tocsection-18"><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#.D0.A0.D0.B5.D0.B7.D1.8E.D0.BC.D0.B5"><span class="tocnumber">1.17</span> <span class="toctext"><b>Резюме</b></span></a></li>
</ul>
</li>
</ul>
</div>

</td></tr></tbody></table>
<h1><span class="mw-headline" id=".D0.9A.D0.9E.D0.9D.D0.A2.D0.95.D0.99.D0.9D.D0.95.D0.A0.D0.AB_.D0.98_.D0.A5.D0.A0.D0.90.D0.9D.D0.95.D0.9D.D0.98.D0.95_.D0.9E.D0.91.D0.AA.D0.95.D0.9A.D0.A2.D0.9E.D0.92"><b>КОНТЕЙНЕРЫ И ХРАНЕНИЕ ОБЪЕКТОВ</b></span></h1>
<p>Ограниченное количество объектов с фиксированным временем жизни 
характерно разве что для относительно простых программ.
В основном ваши программы будут создавать новые объекты на основании 
критериев, которые станут известны лишь во время их работы. До начала 
выполнения программы вы не знаете ни количества, ни даже типов нужных 
вам объектов. Следовательно, использовать именованную ссылку для каждого
 из возможных объектов не удастся:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"> МуТуре aReference<span class="sy0">;</span></pre></div></div>
<p>так как заранее неизвестно, сколько таких ссылок реально потребуется.
В большинстве языков существуют некоторые пути решения этой крайне насущной задачи. В <i>Java</i>
 предусмотрено несколько способов хранения объектов (или, точнее, ссылок
 на объекты). Встроенным типом является массив, который мы уже 
рассмотрели. Библиотека утилит <i>Java</i> (<i><b>java.util.*</b></i>) также содержит достаточно полный набор классов контейнеров (также известных, как классы кол­лекций, но, поскольку имя <i><b>Collection</b></i> (коллекция) используется для обозначения определенного подмножества библиотеки <i>Java</i>,
 я буду употреблять общий термин «контейнер»). Контейнеры обладают 
весьма изощренными возможностями для хранения объектов и работы с ними, и
 с их помощью удается решить огромное количество задач.
</p>
<h2><span class="mw-headline" id=".D0.9F.D0.B0.D1.80.D0.B0.D0.BC.D0.B5.D1.82.D1.80.D0.B8.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D1.8B.D0.B5_.D0.B8_.D1.82.D0.B8.D0.BF.D0.B8.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.BD.D1.8B.D0.B5_.D0.BA.D0.BE.D0.BD.D1.82.D0.B5.D0.B9.D0.BD.D0.B5.D1.80.D1.8B"><b>Параметризованные и типизованные контейнеры</b></span></h2>
<p>Одна из проблем, существовавших при работе с контейнерами до выхода <i>Java</i> <i>SE5</i>,
 заключалась в том, что компилятор позволял вставить в контейнер объект 
неверного типа. Для примера рассмотрим один из основных рабочих 
контейнеров
<i><b>ArrayList</b></i>, в котором мы собираемся хранить объекты <i><b>Apple</b></i>. Пока рассматривайте <i><b>ArrayList</b></i> как «автоматически расширяемый массив». Работать с ним несложно: создайте объект, вставляйте объекты методом <i><b>add()</b></i>, обращайтеcь к ним методом <i><b>get()</b></i>, используйте индексирование — так же, как для массивов, но без квадратных скобок. <i><b>ArrayList</b></i> также содержит метод <i><b>size()</b></i>, который возвращает текущее количество элементов в массиве.
В следующем примере в контейнере размещаются объекты <i><b>Apple</b></i> и <i><b>Orange</b></i>, которые затем извлекаются из него. Обычно компилятор <i>Java</i> выдает предупреждение, потому что в данном примере не используется параметризация, однако в <i>Java</i> <i>SE5</i> существует специальная директива <i><b>@SuppressWarnings</b></i> для подавления предупреждений. Директивы начинаются со знака <i><b>@</b></i> и могут получать аргументы; в данном случае аргумент означает, что подавляются только «непроверяемые» предупреждения:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/ApplesAndOrangesWithoutGenerics.java</span>
<span class="co1">// Простой пример работы с контейнером</span>
<span class="co1">// (компилятор выдает предупреждения).</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> Apple <span class="br0">{</span>
  <span class="kw2">private</span> <span class="kw2">static</span> <span class="kw3">long</span> counter<span class="sy0">;</span>
  <span class="kw2">private</span> <span class="kw2">final</span> <span class="kw3">long</span> id = counter++<span class="sy0">;</span>
  <span class="kw2">public</span> <span class="kw3">long</span> id<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> id<span class="sy0">;</span> <span class="br0">}</span>
<span class="br0">}</span>
&nbsp;
<span class="kw2">class</span> Orange <span class="br0">{</span><span class="br0">}</span>	
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> ApplesAndOrangesWithoutGenerics <span class="br0">{</span>
  @<span class="kw21">SuppressWarnings</span><span class="br0">(</span><span class="st0">"unchecked"</span><span class="br0">)</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">ArrayList</span> apples = <span class="kw2">new</span> <span class="kw46">ArrayList</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> <span class="nu0">3</span><span class="sy0">;</span> i++<span class="br0">)</span>
      apples.<span class="me1">add</span><span class="br0">(</span><span class="kw2">new</span> Apple<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// He препятствует добавлению объекта Orange:</span>
    apples.<span class="me1">add</span><span class="br0">(</span><span class="kw2">new</span> Orange<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> apples.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> i++<span class="br0">)</span>
      <span class="br0">(</span><span class="br0">(</span>Apple<span class="br0">)</span>apples.<span class="me1">get</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span>.<span class="me1">id</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="co1">// Объект Orange обнаруживается только во время выполнения</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>Директивы <i>Java</i> <i>SE5</i> будут рассмотрены позднее.
<i><b>Apple</b></i> и <i><b>Orange</b></i> — совершенно разные классы; они не имеют ничего общего, кроме происхождения от <i><b>Object</b></i> (напомню: если в программе явно не указан базовый класс, то в этом качестве используется <i><b>Object</b></i>). Так как в <i><b>ArrayList</b></i> хранятся объекты <i><b>Object</b></i>, метод <i><b>add()</b></i> может добавлять в контейнер не только объекты <i><b>Apple</b></i>, но и <i><b>Orange</b></i>, без ошибок компиляции или времени выполнения. Но при вызове метода <i><b>get()</b></i> класса <i><b>ArrayList</b></i> вы вместо объекта <i><b>Apple</b></i> получаете ссылку на <i><b>Object</b></i>, которую необходимо преобразовать в <i><b>Apple</b></i>. Все выражение должно быть заключено в круглые скобки, чтобы преобразование было выполнено перед вызовом метода <i><b>id()</b></i> класса <i><b>Apple</b></i>. Во время выполнения, при попытке преобразования объекта <i><b>Orange</b></i> в <i><b>Apple</b></i>,
 произойдет исключение.
В главе «параметризованные типы» вы узнаете, что создание классов, 
использующих механизм параметризации, может быть довольно сложной 
задачей. С другой стороны, с применением готовых параметризованных 
классов проблем обычно не бывает. Например, чтобы определить объект <i><b>ArrayList</b></i>, предназначенный для хранения объектов <i><b>Apple</b></i>, достаточно использовать вместо имени <i><b>ArrayList</b></i> запись <i><b>АrrayList&lt; Apple&gt;</b></i>.
 В угловых скобках перечисляются параметры типов (их может быть 
несколько), указывающие тип объектов, хранящихся в данном экземпляре 
контейнера.
Механизм параметризации предотвращает занесение объектов неверного типа в
 контейнер на стадии компиляции. Рассмотрим тот же пример, но с 
использованием параметризации:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/ApplesAndOrangesWithGenerics.java</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> ApplesAndOrangesWithGenerics <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">ArrayList</span><span class="sy0">&lt;</span>Apple<span class="sy0">&gt;</span> apples = <span class="kw2">new</span> <span class="kw46">ArrayList</span><span class="sy0">&lt;</span>Apple<span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> <span class="nu0">3</span><span class="sy0">;</span> i++<span class="br0">)</span>
      apples.<span class="me1">add</span><span class="br0">(</span><span class="kw2">new</span> Apple<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Ошибка компиляции:</span>
    <span class="co1">// apples.add(new Orange());</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> apples.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> i++<span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>apples.<span class="me1">get</span><span class="br0">(</span>i<span class="br0">)</span>.<span class="me1">id</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Использование foreach:</span>
    <span class="kw1">for</span><span class="br0">(</span>Apple c&nbsp;: apples<span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>c.<span class="me1">id</span><span class="br0">(</span><span class="br0">)</span> + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt; 
</p>
<pre>0 1 2 0 1 2
</pre>
<p>&lt;/spoiler&gt;
На этот раз компилятор не разрешит поместить объекты <i><b>Orange</b></i> в контейнер <i><b>apples</b></i>, поэтому вы получите ошибку на стадии компиляции (а не на стадии выполнения).
Также обратите внимание на то, что выборка данных из <i><b>List</b></i> 
не требует преобразования типов. Поскольку контейнер знает тип 
хранящихся в нем элементов, он автоматически выполняет преобразование 
при вызове <i><b>get()</b></i>. Таким образом, параметризация не только 
позволяет компилятору проверять тип объектов, помещаемых в контейнеры, 
но и упрощает синтаксис работы с объектами в контейнере. Пример также 
показывает, что, если индексы элементов вам не нужны, для перебора можно
 воспользоваться синтаксисом <i><b>foreach</b></i>.
Вы не обязаны точно соблюдать тип объекта, указанный в качестве 
параметра типа. Восходящее преобразование работает с параметризованными 
контейнерами точно так же, как и с другими типами:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/GenericsAndUpcasting.java</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> GrannySmith <span class="kw2">extends</span> Apple <span class="br0">{</span><span class="br0">}</span>
<span class="kw2">class</span> Gala <span class="kw2">extends</span> Apple <span class="br0">{</span><span class="br0">}</span>
<span class="kw2">class</span> Fuji <span class="kw2">extends</span> Apple <span class="br0">{</span><span class="br0">}</span>
<span class="kw2">class</span> Braeburn <span class="kw2">extends</span> Apple <span class="br0">{</span><span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> GenericsAndUpcasting <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">ArrayList</span><span class="sy0">&lt;</span>Apple<span class="sy0">&gt;</span> apples = <span class="kw2">new</span> <span class="kw46">ArrayList</span><span class="sy0">&lt;</span>Apple<span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    apples.<span class="me1">add</span><span class="br0">(</span><span class="kw2">new</span> GrannySmith<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    apples.<span class="me1">add</span><span class="br0">(</span><span class="kw2">new</span> Gala<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    apples.<span class="me1">add</span><span class="br0">(</span><span class="kw2">new</span> Fuji<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    apples.<span class="me1">add</span><span class="br0">(</span><span class="kw2">new</span> Braeburn<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span>Apple c&nbsp;: apples<span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>c<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt; (Sample)
</p>
<pre>GrannySmith@7d772e
Gala@11b86e7
Fuji@35ce36
Braeburn@757aef
</pre>
<p>&lt;/spoiler&gt;
Мы видим, что в контейнер, рассчитанный на хранение объектов <i><b>Apple</b></i>, можно помещать объекты типов, производных от <i><b>Apple</b></i>.
В результатах, полученных с использованием метода <i><b>toString()</b></i> объекта <i><b>Object</b></i>, выводится имя класса с беззнаковым шестнадцатеричным представлением хеш-кода объекта (сгенерированного методом <i><b>hashCode()</b></i>).
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.9E.D1.81.D0.BD.D0.BE.D0.B2.D0.BD.D1.8B.D0.B5_.D0.BA.D0.BE.D0.BD.D1.86.D0.B5.D0.BF.D1.86.D0.B8.D0.B8"><b>Основные концепции</b></span></h2>
<p>В библиотеке контейнеров <i>Java</i> проблема хранения объектов делится на две концепции, выраженные в виде базовых интерфейсов библиотеки:
</p>
<hr>
<ul>
<li><span style="color:#800000"><b>Коллекция:</b> группа отдельных элементов, сформированная по некоторым правилам. Класс <i><b>List</b></i> (список) хранит элементы в порядке вставки, в классе <i><b>Set</b></i> (множество) нельзя хранить повторяющиеся элементы, а класс <i><b>Queue</b></i> (очередь) выдает элементы в порядке, определяемом спецификой очереди (обычно это порядок вставки элементов в очередь).</span>
</li>
</ul>
<ul>
<li><span style="color:#800000"><b>Карта:</b> набор пар объектов «ключ-значение», с возможностью выборки по ключу. <i><b>ArrayList</b></i> позволяет искать объекты по порядковым номерам, поэтому в каком-то смысле он связывает числа с объектами. Класс <i><b>Map</b></i>
 (карта — также встречаются термины ассоциативный массив и словарь) 
позволяет искать объекты по другим объектам — например, получить объект 
значения по объекту ключа, по аналогии с поиском определения по слову.</span>
</li>
</ul>
<hr>
<p>Хотя на практике это не всегда возможно, в идеале весь программный 
код должен писаться в расчете на взаимодействие с этими интерфейсами, а 
точный тип указывается только в точке создания. Следовательно, объект 
List может быть создан так:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="kw166">List</span><span class="sy0">&lt;</span>Apple<span class="sy0">&gt;</span> apples = <span class="kw2">new</span> <span class="kw46">ArrayList</span><span class="sy0">&lt;</span>Apple<span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span></pre></div></div>
<p>Обратите внимание на восходящее преобразование <i><b>ArrayList</b></i> к <i><b>List</b></i>, в отличие от предыдущих примеров. Если позднее вы решите изменить реализацию, достаточно сделать это в точке создания:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="kw166">List</span><span class="sy0">&lt;</span>Apple<span class="sy0">&gt;</span> apples = <span class="kw2">new</span> <span class="kw46">LinkedList</span><span class="sy0">&lt;</span>Apple<span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span></pre></div></div>
<p>Итак, в типичной ситуации вы создаете объект реального класса, 
повышаете его до соответствующего интерфейса, а затем используете 
интерфейс во всем остальном коде.
Такой подход работает не всегда, потому что некоторые классы обладают 
дополнительной функциональностью. Например, <i><b>LinkedList</b></i> содержит дополнительные методы, не входящие в интерфейс <i><b>List</b></i>, а <i><b>ТrееМар</b></i> — методы, не входящие в <i><b>Map</b></i>. Если такие методы используются в программе, восходящее преобразование к обобщенному интерфейсу невозможно.
Интерфейс <i><b>Collection</b></i> представляет концепцию последовательности как способа хранения группы объектов. В следующем простом примере интерфейс <i><b>Collection</b></i> (представленный контейнером <i><b>ArrayList</b></i>) заполняется объектами <i><b>Integer</b></i>, с последующим выводом всех элементов полученного контейнера:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/SimpleCollection.java</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> SimpleCollection <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">Collection</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span> c = <span class="kw2">new</span> <span class="kw46">ArrayList</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> <span class="nu0">10</span><span class="sy0">;</span> i++<span class="br0">)</span>
      c.<span class="me1">add</span><span class="br0">(</span>i<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Autoboxing</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw21">Integer</span> i&nbsp;: c<span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>i + <span class="st0">", "</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
</pre>
<p>&lt;/spoiler&gt;
Поскольку в этом примере используются только методы <i><b>Collection</b></i>, подойдет объект любого класса, производного от <i><b>Collection</b></i>, но <i><b>ArrayList</b></i> является самым простейшим типом последовательности.
</p><p>Все коллекции поддерживают перебор в синтаксисе <i><b>foreach</b></i>, как в приведенном примере. Позднее в этой главе будет рассмотрена другая, более гибкая концепция итераторов.
</p>
<h2><span class="mw-headline" id=".D0.94.D0.BE.D0.B1.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B3.D1.80.D1.83.D0.BF.D0.BF_.D1.8D.D0.BB.D0.B5.D0.BC.D0.B5.D0.BD.D1.82.D0.BE.D0.B2"><b>Добавление групп элементов</b></span></h2>
<p>Семейства <i><b>Arrays</b></i> и <i><b>Collections</b></i> в <i><b>java.util</b></i> содержат вспомогательные методы для включения групп элементов в коллекции. Метод <i><b>Arrays.asList()</b></i> получает либо массив, либо список элементов, разделенных запятыми, и преобразует его в объект <i><b>List</b></i>. Метод <i><b>Collections.addAll()</b></i> получает объект <i><b>Collection</b></i> и либо массив, либо список, разделенный запятыми, и добавляет элементы в <i><b>Collection</b></i>. Пример:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/AddingGroups.java</span>
<span class="co1">// Добавление групп элементов в объекты Collection</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> AddingGroups <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">Collection</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span> collection =
      <span class="kw2">new</span> <span class="kw46">ArrayList</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span><span class="nu0">1</span>, <span class="nu0">2</span>, <span class="nu0">3</span>, <span class="nu0">4</span>, <span class="nu0">5</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">Integer</span><span class="br0">[</span><span class="br0">]</span> moreInts = <span class="br0">{</span> <span class="nu0">6</span>, <span class="nu0">7</span>, <span class="nu0">8</span>, <span class="nu0">9</span>, <span class="nu0">10</span> <span class="br0">}</span><span class="sy0">;</span>
    collection.<span class="me1">addAll</span><span class="br0">(</span><span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span>moreInts<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Работает намного быстрее, но таким способом </span>
    <span class="co1">// невозможно сконструировать Collection:</span>
    <span class="kw46">Collections</span>.<span class="me1">addAll</span><span class="br0">(</span>collection, <span class="nu0">11</span>, <span class="nu0">12</span>, <span class="nu0">13</span>, <span class="nu0">14</span>, <span class="nu0">15</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Collections</span>.<span class="me1">addAll</span><span class="br0">(</span>collection, moreInts<span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Produces a list "backed by" an array:</span>
    <span class="kw166">List</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span> list = <span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span><span class="nu0">16</span>, <span class="nu0">17</span>, <span class="nu0">18</span>, <span class="nu0">19</span>, <span class="nu0">20</span><span class="br0">)</span><span class="sy0">;</span>
    list.<span class="me1">set</span><span class="br0">(</span><span class="nu0">1</span>, <span class="nu0">99</span><span class="br0">)</span><span class="sy0">;</span><span class="co1">// Можно - изменение элемента </span>
    <span class="co1">// list.add(21); // Ошибка времени выполнения - нижележащий </span>
                    <span class="co1">// массив не должен изменяться в размерах</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>Конструктор <i><b>Collection</b></i> может получать другой объект <i><b>Collection</b></i>, используемый для его инициализации, поэтому для передачи исходных данных можно воспользоваться методом <i><b>Arrays.asList()</b></i>. Однако метод <i><b>Collections.addAll()</b></i> работает намного быстрее, и вы с таким же успехом можете сконструировать <i><b>Collection</b></i> без элементов, а затем вызвать <i><b>Collections.addAll</b></i> — этот способ считается предпочтительным.
Методу <i><b>Collection.addAll()</b></i> в аргументе может передаваться только другой объект <i><b>Collection</b></i>, поэтому он уступает в гибкости методам <i><b>Arrays.asList()</b></i> и <i><b>Collections.addAll()</b></i>, использующим переменные списки аргументов.
Также можно использовать вывод <i><b>Arrays.asList()</b></i> напрямую, в виде <i><b>List</b></i>, но в этом случае нижележащим представлением будет массив, не допускающий изменения размеров. Вызов <i><b>add()</b></i> или <i><b>delete()</b></i> для такого списка приведет к попытке изменения размера массива, а это приведет к ошибке во время выполнения.
Недостаток <i><b>Arrays.asList()</b></i> заключается в том, что он пытается «вычислить» итоговый тип <i><b>List</b></i>, не обращая внимания на то, что ему присваивается. Иногда это создает проблемы:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/AsListInference.java</span>
<span class="co1">// Arrays.asList() makes its best guess about type.</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> Snow <span class="br0">{</span><span class="br0">}</span>
<span class="kw2">class</span> Powder <span class="kw2">extends</span> Snow <span class="br0">{</span><span class="br0">}</span>
<span class="kw2">class</span> Light <span class="kw2">extends</span> Powder <span class="br0">{</span><span class="br0">}</span>
<span class="kw2">class</span> Heavy <span class="kw2">extends</span> Powder <span class="br0">{</span><span class="br0">}</span>
<span class="kw2">class</span> Crusty <span class="kw2">extends</span> Snow <span class="br0">{</span><span class="br0">}</span>
<span class="kw2">class</span> Slush <span class="kw2">extends</span> Snow <span class="br0">{</span><span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> AsListInference <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw166">List</span><span class="sy0">&lt;</span>Snow<span class="sy0">&gt;</span> snow1 = <span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span>
      <span class="kw2">new</span> Crusty<span class="br0">(</span><span class="br0">)</span>, <span class="kw2">new</span> Slush<span class="br0">(</span><span class="br0">)</span>, <span class="kw2">new</span> Powder<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// He компилируется-</span>
    <span class="co1">// List&lt;Snow&gt; snow2 = Arrays.asList(</span>
    <span class="co1">//   new Light(), new Heavy());</span>
    <span class="co1">// Сообщение компилятора:</span>
    <span class="co1">// found  &nbsp;: java.util.List&lt;Powder&gt;</span>
    <span class="co1">// required: java.util.List&lt;Snow&gt;</span>
&nbsp;
    <span class="co1">// Collections.addAll()  работает нормально:</span>
    <span class="kw166">List</span><span class="sy0">&lt;</span>Snow<span class="sy0">&gt;</span> snow3 = <span class="kw2">new</span> <span class="kw46">ArrayList</span><span class="sy0">&lt;</span>Snow<span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Collections</span>.<span class="me1">addAll</span><span class="br0">(</span>snow3, <span class="kw2">new</span> Light<span class="br0">(</span><span class="br0">)</span>, <span class="kw2">new</span> Heavy<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
    <span class="co1">// Передача информации посредством уточнения </span>
    <span class="co1">// типа аргумента</span>
    <span class="kw166">List</span><span class="sy0">&lt;</span>Snow<span class="sy0">&gt;</span> snow4 = <span class="kw46">Arrays</span>.<span class="sy0">&lt;</span>Snow<span class="sy0">&gt;</span>asList<span class="br0">(</span>
       <span class="kw2">new</span> Light<span class="br0">(</span><span class="br0">)</span>, <span class="kw2">new</span> Heavy<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>При попытке создания <i><b>snow2, Arrays.asList()</b></i> создает <i><b>List&lt;Powder&gt;</b></i> вместо <i><b>List &lt;Snow&gt;</b></i>, тогда как <i><b>Collections.addAll()</b></i> работает нормально, потому что целевой тип определяется первым аргументом. Как видно из создания <i><b>snow4</b></i>, в вызов <i><b>Arrays.asList()</b></i> можно вставить «подсказку», которая сообщает компилятору фактический тип объекта <i><b>List</b></i>, производимого <i><b>Arrays.asList()</b></i>.
С контейнерами <i><b>Map</b></i> дело обстоит сложнее, и стандартная библиотека <i>Java</i> не предоставляет средств их автоматической инициализации, кроме как по содержимому другого объекта <i><b>Map</b></i>.
</p>
<h2><span class="mw-headline" id=".D0.92.D1.8B.D0.B2.D0.BE.D0.B4_.D1.81.D0.BE.D0.B4.D0.B5.D1.80.D0.B6.D0.B8.D0.BC.D0.BE.D0.B3.D0.BE_.D0.BA.D0.BE.D0.BD.D1.82.D0.B5.D0.B9.D0.BD.D0.B5.D1.80.D0.BE.D0.B2"><b>Вывод содержимого контейнеров</b></span></h2>
<p>Для получения печатного представления массива необходимо использовать метод <i><b>Arrays.toString</b></i>,
 но контейнеры отлично выводятся и без посторонней помощи. Следующий 
пример демонстрирует использование основных типов контейнеров:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/PrintingContainers.java</span>
<span class="co1">// Вывод контейнеров по умолчанию </span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="kw2">static</span> <span class="co2">net.mindview.util.Print.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> PrintingContainers <span class="br0">{</span>
  <span class="kw2">static</span> <span class="kw46">Collection</span> fill<span class="br0">(</span><span class="kw46">Collection</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> collection<span class="br0">)</span> <span class="br0">{</span>
    collection.<span class="me1">add</span><span class="br0">(</span><span class="st0">"rat"</span><span class="br0">)</span><span class="sy0">;</span>
    collection.<span class="me1">add</span><span class="br0">(</span><span class="st0">"cat"</span><span class="br0">)</span><span class="sy0">;</span>
    collection.<span class="me1">add</span><span class="br0">(</span><span class="st0">"dog"</span><span class="br0">)</span><span class="sy0">;</span>
    collection.<span class="me1">add</span><span class="br0">(</span><span class="st0">"dog"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">return</span> collection<span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">static</span> <span class="kw46">Map</span> fill<span class="br0">(</span><span class="kw46">Map</span><span class="sy0">&lt;</span><span class="kw21">String</span>,<span class="kw21">String</span><span class="sy0">&gt;</span> map<span class="br0">)</span> <span class="br0">{</span>
    map.<span class="me1">put</span><span class="br0">(</span><span class="st0">"rat"</span>, <span class="st0">"Fuzzy"</span><span class="br0">)</span><span class="sy0">;</span>
    map.<span class="me1">put</span><span class="br0">(</span><span class="st0">"cat"</span>, <span class="st0">"Rags"</span><span class="br0">)</span><span class="sy0">;</span>
    map.<span class="me1">put</span><span class="br0">(</span><span class="st0">"dog"</span>, <span class="st0">"Bosco"</span><span class="br0">)</span><span class="sy0">;</span>
    map.<span class="me1">put</span><span class="br0">(</span><span class="st0">"dog"</span>, <span class="st0">"Spot"</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw2">return</span> map<span class="sy0">;</span>
  <span class="br0">}</span>	
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    print<span class="br0">(</span>fill<span class="br0">(</span><span class="kw2">new</span> <span class="kw46">ArrayList</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span>fill<span class="br0">(</span><span class="kw2">new</span> <span class="kw46">LinkedList</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span>fill<span class="br0">(</span><span class="kw2">new</span> <span class="kw46">HashSet</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span>fill<span class="br0">(</span><span class="kw2">new</span> <span class="kw46">TreeSet</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span>fill<span class="br0">(</span><span class="kw2">new</span> <span class="kw46">LinkedHashSet</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span>fill<span class="br0">(</span><span class="kw2">new</span> <span class="kw46">HashMap</span><span class="sy0">&lt;</span><span class="kw21">String</span>,<span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span>fill<span class="br0">(</span><span class="kw2">new</span> <span class="kw46">TreeMap</span><span class="sy0">&lt;</span><span class="kw21">String</span>,<span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span>fill<span class="br0">(</span><span class="kw2">new</span> <span class="kw46">LinkedHashMap</span><span class="sy0">&lt;</span><span class="kw21">String</span>,<span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>[rat, cat, dog, dog]
[rat, cat, dog, dog]
[dog, cat, rat]
[cat, dog, rat]
[rat, cat, dog]
{dog=Spot, cat=Rags, rat=Fuzzy}
{cat=Rags, dog=Spot, rat=Fuzzy}
{rat=Fuzzy, cat=Rags, dog=Spot}
</pre>
<p>&lt;/spoiler&gt;
Как уже было упомянуто, в библиотеке контейнеров <i>Java</i> существует 
две основные категории, различающиеся прежде всего тем, сколько в одной 
ячейке контейнера «помещается» элементов. Коллекции (<i><b>Collection</b></i>) содержат только один элемент в каждой ячейке. К этой категории относятся список (<i><b>List</b></i>), где в определенной последовательности хранится группа элементов, множество (<i><b>Set</b></i>), в которое можно добавлять только по одному элементу определенного типа, и очередь (<i><b>Queue</b></i>). В контейнерах <i><b>Map</b></i> (карта) хранятся два объекта: ключ и связанное с ним значение.
Из выходных данных программы видно, что вывод по умолчанию (обеспечиваемый методом <i><b>toString()</b></i> каждого контейнера) дает вполне приличные результаты. Содержимое <i><b>Collection</b></i> выводится в квадратных скобках, с разделением элементов запятыми. Содержимое <i><b>Map</b></i> заключается в фигурные скобки, ключи и значения разделяются знаком равенства (ключи слева, значения справа).
Контейнеры <i><b>ArrayList</b></i> и <i><b>LinkedList</b></i> принадлежат к семейству <i><b>List</b></i>,
 и из выходных данных видно, что элементы в них хранятся в порядке 
вставки. Они различаются не только скоростью выполнения тех или иных 
операций, но и тем, что <i><b>LinkedList</b></i> содержит больше операций, чем <i><b>ArrayList</b></i>.
<i><b>HashSet, TreeSet</b></i> и <i><b>LinkedHashSet</b></i> относятся к семейству <i><b>Set</b></i>. Из выходных данных видно, что в множествах <i><b>Set</b></i> каждый элемент хранится только в одном экземпляре, а разные реализации <i><b>Set</b></i> используют разный порядок хранения элементов. В <i><b>HashSet</b></i>
 порядок элементов определяется по довольно сложному алгоритму — пока 
достаточно знать, что этот алгоритм обеспечивает минимальное время 
выборки элементов, но порядок следования элементов на первый взгляд 
выглядит хаотично. Если порядок хранения для вас важен, используйте 
контейнер <i><b>TreeSet</b></i>, в котором объекты хранятся отсортированными по возрастанию в порядке сравнения, или <i><b>LinkedHashSet</b></i> с хранением элементов в порядке добавления.
Карта (<i><b>Map</b></i>) позволяет искать объекты по ключу, как 
несложная база данных. Объект, ассоциированный с ключом, называется 
значением. (Карты также называют ассоциативными массивами.)
В нашем примере используются три основные разновидности <i><b>Map: HashMap, TreeMap</b></i> и <i><b>LinkedHashMap</b></i>. Как и <i><b>HashSet, HashMap</b></i> обеспечивает максимальную скорость выборки, а порядок хранения его элементов не очевиден. <i><b>TreeMap</b></i> хра­нит ключи отсортированными по возрастанию, a <i><b>LinkedHashMap</b></i> хранит ключи в порядке вставки, но обеспечивает скорость поиска <i><b>HashMap</b></i>.
</p><p><br>
</p>
<h2><span class="mw-headline" id="List"><b>List</b></span></h2>
<p>Контейнеры <i><b>List</b></i> гарантируют определенный порядок следования элементов. Интерфейс <i><b>List</b></i> дополняет <i><b>Collection</b></i> несколькими методами, обеспечивающими вставку и удаление элементов в середине списка. Существует две основные разновидности <i><b>List</b></i>:
</p>
<hr>
<ul>
<li><span style="color:#800000"><b>Базовый контейнер ArrayList</b>, 
оптимизированный для произвольного доступа к элементам, но с 
относительно медленнными операциями вставки (удаления) элементов в 
середине списка.</span>
</li>
</ul>
<ul>
<li><span style="color:#800000"><b>Контейнер LinkedList</b>, 
оптимизированный для последовательного доступа, с быстрыми операциями 
вставки (удаления) в середине списка; Произвольный доступ к элементам <i><b>LinkedList</b></i> выполняется относительно медленно, но по широте возможностей он превосходит <i><b>ArrayList</b></i>.</span>
</li>
</ul>
<hr>
<p>В следующем примере используется библиотека <i><b>typenfo.pets</b></i> из главы «Информация о типе». Она содержит иерархию классов домашних животных <i><b>Pet</b></i>, а также ряд вспомогательных средств для случайного построения объектов <i><b>Pet</b></i>. Пока достаточно знать, что (1) библиотека содержит класс <i><b>Pet</b></i> и производные типы, и (2) статический метод <i><b>Pets.arrayList()</b></i> возвращает контейнер <i><b>ArrayList</b></i>, заполненный случайно выбранными объектами <i><b>Pet</b></i>.
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/ListFeatures.java</span>
<span class="kw2">import</span> <span class="co2">typeinfo.pets.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="kw2">static</span> <span class="co2">net.mindview.util.Print.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> ListFeatures <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">Random</span> rand = <span class="kw2">new</span> <span class="kw46">Random</span><span class="br0">(</span><span class="nu0">47</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw166">List</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> pets = Pets.<span class="me1">arrayList</span><span class="br0">(</span><span class="nu0">7</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"1: "</span> + pets<span class="br0">)</span><span class="sy0">;</span>
    Hamster h = <span class="kw2">new</span> Hamster<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    pets.<span class="me1">add</span><span class="br0">(</span>h<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Автоматическое изменение размера </span>
    print<span class="br0">(</span><span class="st0">"2: "</span> + pets<span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"3: "</span> + pets.<span class="me1">contains</span><span class="br0">(</span>h<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    pets.<span class="me1">remove</span><span class="br0">(</span>h<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Удаление объекта</span>
    Pet p = pets.<span class="me1">get</span><span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"4: "</span> +  p + <span class="st0">" "</span> + pets.<span class="me1">indexOf</span><span class="br0">(</span>p<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    Pet cymric = <span class="kw2">new</span> Cymric<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"5: "</span> + pets.<span class="me1">indexOf</span><span class="br0">(</span>cymric<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"6: "</span> + pets.<span class="me1">remove</span><span class="br0">(</span>cymric<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Точно заданный объект:</span>
    print<span class="br0">(</span><span class="st0">"7: "</span> + pets.<span class="me1">remove</span><span class="br0">(</span>p<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"8: "</span> + pets<span class="br0">)</span><span class="sy0">;</span>
    pets.<span class="me1">add</span><span class="br0">(</span><span class="nu0">3</span>, <span class="kw2">new</span> Mouse<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Вставка no индексу </span>
    print<span class="br0">(</span><span class="st0">"9: "</span> + pets<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw166">List</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> sub = pets.<span class="me1">subList</span><span class="br0">(</span><span class="nu0">1</span>, <span class="nu0">4</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"subList: "</span> + sub<span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"10: "</span> + pets.<span class="me1">containsAll</span><span class="br0">(</span>sub<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Collections</span>.<span class="me1">sort</span><span class="br0">(</span>sub<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Сортировка "на месте"</span>
    print<span class="br0">(</span><span class="st0">"sorted subList: "</span> + sub<span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Для containsAll() порядок неважен:</span>
    print<span class="br0">(</span><span class="st0">"11: "</span> + pets.<span class="me1">containsAll</span><span class="br0">(</span>sub<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Collections</span>.<span class="me1">shuffle</span><span class="br0">(</span>sub, rand<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Случайная перестановка</span>
    print<span class="br0">(</span><span class="st0">"shuffled subList: "</span> + sub<span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"12: "</span> + pets.<span class="me1">containsAll</span><span class="br0">(</span>sub<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw166">List</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> copy = <span class="kw2">new</span> <span class="kw46">ArrayList</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span><span class="br0">(</span>pets<span class="br0">)</span><span class="sy0">;</span>
    sub = <span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span>pets.<span class="me1">get</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span>, pets.<span class="me1">get</span><span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"sub: "</span> + sub<span class="br0">)</span><span class="sy0">;</span>
    copy.<span class="me1">retainAll</span><span class="br0">(</span>sub<span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"13: "</span> + copy<span class="br0">)</span><span class="sy0">;</span>
    copy = <span class="kw2">new</span> <span class="kw46">ArrayList</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span><span class="br0">(</span>pets<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Получение новой копии </span>
    copy.<span class="me1">remove</span><span class="br0">(</span><span class="nu0">2</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Удаление по индексу</span>
    print<span class="br0">(</span><span class="st0">"14: "</span> + copy<span class="br0">)</span><span class="sy0">;</span>
    copy.<span class="me1">removeAll</span><span class="br0">(</span>sub<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Удаление заданных элементов print("15: " + copy);</span>
    print<span class="br0">(</span><span class="st0">"15: "</span> + copy<span class="br0">)</span><span class="sy0">;</span>
    copy.<span class="me1">set</span><span class="br0">(</span><span class="nu0">1</span>, <span class="kw2">new</span> Mouse<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Замена элемента</span>
    print<span class="br0">(</span><span class="st0">"16: "</span> + copy<span class="br0">)</span><span class="sy0">;</span>
    copy.<span class="me1">addAll</span><span class="br0">(</span><span class="nu0">2</span>, sub<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Вставка в середину списка</span>
    print<span class="br0">(</span><span class="st0">"17: "</span> + copy<span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"18: "</span> + pets.<span class="me1">isEmpty</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    pets.<span class="me1">clear</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Удаление всех элементов</span>
    print<span class="br0">(</span><span class="st0">"19: "</span> + pets<span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"20: "</span> + pets.<span class="me1">isEmpty</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    pets.<span class="me1">addAll</span><span class="br0">(</span>Pets.<span class="me1">arrayList</span><span class="br0">(</span><span class="nu0">4</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"21: "</span> + pets<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw166">Object</span><span class="br0">[</span><span class="br0">]</span> o = pets.<span class="me1">toArray</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"22: "</span> + o<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span>
    Pet<span class="br0">[</span><span class="br0">]</span> pa = pets.<span class="me1">toArray</span><span class="br0">(</span><span class="kw2">new</span> Pet<span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"23: "</span> + pa<span class="br0">[</span><span class="nu0">3</span><span class="br0">]</span>.<span class="me1">id</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>1: [Rat, Manx, Cymric, Mutt, Pug, Cymric, Pug]
2: [Rat, Manx, Cymric, Mutt, Pug, Cymric, Pug, Hamster]
3: true
4: Cymric 2
5: -1
6: false
7: true
8: [Rat, Manx, Mutt, Pug, Cymric, Pug]
9: [Rat, Manx, Mutt, Mouse, Pug, Cymric, Pug]
subList: [Manx, Mutt, Mouse]
10: true
sorted subList: [Manx, Mouse, Mutt]
11: true
shuffled subList: [Mouse, Manx, Mutt]
12: true
sub: [Mouse, Pug]
13: [Mouse, Pug]
14: [Rat, Mouse, Mutt, Pug, Cymric, Pug]
15: [Rat, Mutt, Cymric, Pug]
16: [Rat, Mouse, Cymric, Pug]
17: [Rat, Mouse, Mouse, Pug, Cymric, Pug]
18: false
19: []
20: true
21: [Manx, Cymric, Rat, EgyptianMau]
22: EgyptianMau
23: 14
</pre>
<p>&lt;/spoiler&gt;
Строки вывода пронумерованы, чтобы вам было удобнее связывать результат с исходным кодом.
В первой строке выводится исходный контейнер <i><b>List</b></i> с объектами <i><b>Pets</b></i>. В отличие от массивов, <i><b>List</b></i> поддерживает добавление и удаление элементов с изменением размеров списка. Результат добавления <i><b>Hamster</b></i> виден в строке 2: объект появляется в конце списка.
</p><p>Метод <i><b>contains()</b></i> проверяет, присутствует ли объект в списке. Чтобы удалить объект, передайте ссылку на него методу <i><b>remove()</b></i>. Кроме того, при наличии ссылки на объект можно узнать его индекс в списке при помощи метода <i><b>indexOf()</b></i>, как показано в строке 4.
</p><p>При проверке вхождения элемента в <i><b>List</b></i>, проверке индекса элемента и удаления элемента из <i><b>List</b></i> по ссылке используется метод <i><b>equals()</b></i> (из корневого класса <i><b>Object</b></i>). Все объекты <i><b>Pet</b></i> считаются уникальными, поэтому несмотря на присутствие двух объектов <i><b>Cymric</b></i> в списке, если я создам новый объект <i><b>Cymric</b></i> и передам его <i><b>indexOf()</b></i>, результат будет равен <i>-1</i> (элемент не найден), а вызов <i><b>remove()</b></i> вернет <i><b>false</b></i>. Для других классов метод <i><b>equals()</b></i> может быть определен иначе — например, объекты <i><b>String</b></i> считаются равными в случае совпадения содержимого.
</p><p>В строках 7 и 8 из <i><b>List</b></i> успешно удаляется заданный объект. Строка 9 и предшествующий ей код демонстрируют вставку элемента в середину списка. Метод <i><b>subList()</b></i> позволяет легко создать «срез» из подмножества элементов списка; естественно, при передаче его методу <i><b>containsAll()</b></i> большего списка будет получен истинный результат. Вызовы <i><b>Collections.sort()</b></i> и <i><b>Collections.shuffle()</b></i> для <i><b>sub</b></i> не влияют на результат вызова <i><b>containsAll()</b></i>.
</p><p>Метод <i><b>retainAll()</b></i> фактически выполняет операцию «пересечения множеств», то есть определения всех элементов сору, которые также присутствуют в <i><b>sub</b></i>. И снова поведение метода зависит от реализации <i><b>equals()</b></i>.
</p><p>В строке 14 представлен результат удаления элемента по индексу — 
это проще, чем удаление по ссылке на объект, потому что вам не придется 
беспокоиться о поведении <i><b>equals()</b></i>.
Работа метода <i><b>removeAll()</b></i> также зависит от <i><b>equals()</b></i>. Как подсказывает название, метод удаляет из <i><b>List</b></i> все объекты, входящие в <i><b>List</b></i>-аргумент.
</p><p>Название метода <i><b>set()</b></i> выбрано неудачно, потому что оно совпадает с именем класса <i><b>Set</b></i> — возможно, лучше было бы назвать метод «<i>replace</i>», потому что он заменяет элемент с заданным индексом (первый аргумент) вторым аргументом.
</p><p>В строке вывода 17 показано, что для <i><b>List</b></i> существует перегруженный метод <i><b>addAll()</b></i>, вставляющий новый список в середину исходного списка (вместо простого добавления в конец методом <i><b>addAll()</b></i>, унаследованным от <i><b>Collection</b></i>).
</p><p>В строках 18-20 представлен результат вызова методов <i><b>isEmpty()</b></i> и <i><b>clear()</b></i>. Строки 22 и 23 демонстрируют, что любой объект <i><b>Collection</b></i> можно преобразовать в массив с использованием <i><b>toArray()</b></i>.
</p>
<h2><span class="mw-headline" id=".D0.98.D1.82.D0.B5.D1.80.D0.B0.D1.82.D0.BE.D1.80.D1.8B"><b>Итераторы</b></span></h2>
<p>У любого контейнера должен существовать механизм вставки и выборки 
элементов. В конце концов, контейнер предназначен именно для хранения 
объектов. При работе с <i><b>List</b></i> для вставки может использоваться метод <i><b>add()</b></i>, а для выборки — метод <i><b>get()</b></i> (впрочем, существуют и другие способы).
</p><p>Если взглянуть на ситуацию с более высокого уровня, 
обнаруживается проблема: чтобы использовать контейнер в программе, 
необходимо знать его точный тип. Что, если вы начали использовать в 
программе контейнер <i><b>List</b></i>, а затем обнаружили, что в вашем случае будет удобнее применить тот же код к множеству (<i><b>Set</b></i>)? Или если вы хотите написать универсальный код, который не зависит от типа контейнера и может применяться к любому контейнеру?
</p><p>С данной абстракцией хорошо согласуется концепция итератора (<i>iterator</i>).
 Итератор — это объект, обеспечивающий перемещение по последовательности
 объектов с выбором каждого объекта этой последовательности, при этом 
про­граммисту-клиенту не надо знать или заботиться о лежащей в ее основе
 структуре. Вдобавок, итератор обычно является так называемым 
«легковесным» (<i>lightweight</i>) объектом: его создание должно 
обходиться без заметных затрат ресурсов. Из-за этого итераторы часто 
имеют ограничения; например, <i><b>Iterator</b></i> в <i>Java</i> 
поддерживает перемещение только в одном направлении. Его возможности не 
так уж широки, но с его помощью можно сделать следующее:
</p>
<hr>
<ul>
<li><span style="color:#800000">Запросить у контейнера итератор вызовом метода <i><b>iterator()</b></i>. Полученный итератор готов вернуть начальный элемент последовательности при первом вызове своего метода <i><b>next()</b></i>.</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">Получить следующий элемент последовательности вызовом метода <i><b>next()</b></i>.</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">Проверить, остались ли еще объекты в последовательности (метод <i><b>hasNext()</b></i>).</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">Удалить из последовательности последний элемент, возвращенный итератором, методом  <i><b>remove()</b></i>.</span>
</li>
</ul>
<hr>
<p>Чтобы увидеть итератор в действии, мы снова воспользуемся иерархией <i><b>Pets</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/SimpleIteration.java</span>
<span class="kw2">import</span> <span class="co2">typeinfo.pets.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> SimpleIteration <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw166">List</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> pets = Pets.<span class="me1">arrayList</span><span class="br0">(</span><span class="nu0">12</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Iterator</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> it = pets.<span class="me1">iterator</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">while</span><span class="br0">(</span>it.<span class="me1">hasNext</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
      Pet p = it.<span class="me1">next</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>p.<span class="me1">id</span><span class="br0">(</span><span class="br0">)</span> + <span class="st0">":"</span> + p + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Более простой способ (если подходит):</span>
    <span class="kw1">for</span><span class="br0">(</span>Pet p&nbsp;: pets<span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>p.<span class="me1">id</span><span class="br0">(</span><span class="br0">)</span> + <span class="st0">":"</span> + p + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>	
    <span class="co1">// Итератор также способен удалять элементы:</span>
    it = pets.<span class="me1">iterator</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> <span class="nu0">6</span><span class="sy0">;</span> i++<span class="br0">)</span> <span class="br0">{</span>
      it.<span class="me1">next</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      it.<span class="me1">remove</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>pets<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx 8:Cymric 9:Rat 10:EgyptianMau 11:Hamster
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx 8:Cymric 9:Rat 10:EgyptianMau 11:Hamster
[Pug, Manx, Cymric, Rat, EgyptianMau, Hamster]
</pre>
<p>&lt;/spoiler&gt;
Мы видим, что с <i><b>Iterator</b></i> можно не беспокоиться о количестве элементов в последовательности. Проверка осуществляется методами <i><b>hasNext()</b></i> и <i><b>next()</b></i>.
Если вы просто перебираете элементы списка в одном направлении, не пытаясь модифицировать его содержимое, «синтаксис <i><b>foreach</b></i>» обеспечивает более компактную запись.
<i><b>Iterator</b></i> удаляет последний элемент, полученный при помощи <i><b>next()</b></i>, поэтому перед вызовом <i><b>remove()</b></i> необходимо вызвать <i><b>next()</b></i>.
Теперь рассмотрим задачу создания метода <i><b>display()</b></i>, не зависящего от типа контейнера:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/CrossContainerIteration.java</span>
<span class="kw2">import</span> <span class="co2">typeinfo.pets.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> CrossContainerIteration <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> display<span class="br0">(</span><span class="kw46">Iterator</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> it<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw1">while</span><span class="br0">(</span>it.<span class="me1">hasNext</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
      Pet p = it.<span class="me1">next</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>p.<span class="me1">id</span><span class="br0">(</span><span class="br0">)</span> + <span class="st0">":"</span> + p + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>	
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">ArrayList</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> pets = Pets.<span class="me1">arrayList</span><span class="br0">(</span><span class="nu0">8</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">LinkedList</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> petsLL = <span class="kw2">new</span> <span class="kw46">LinkedList</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span><span class="br0">(</span>pets<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">HashSet</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> petsHS = <span class="kw2">new</span> <span class="kw46">HashSet</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span><span class="br0">(</span>pets<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">TreeSet</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> petsTS = <span class="kw2">new</span> <span class="kw46">TreeSet</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span><span class="br0">(</span>pets<span class="br0">)</span><span class="sy0">;</span>
    display<span class="br0">(</span>pets.<span class="me1">iterator</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    display<span class="br0">(</span>petsLL.<span class="me1">iterator</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    display<span class="br0">(</span>petsHS.<span class="me1">iterator</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    display<span class="br0">(</span>petsTS.<span class="me1">iterator</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
4:Pug 6:Pug 3:Mutt 1:Manx 5:Cymric 7:Manx 2:Cymric 0:Rat
5:Cymric 2:Cymric 7:Manx 1:Manx 3:Mutt 6:Pug 4:Pug 0:Rat
</pre>
<p>&lt;/spoiler&gt;
В методе <i><b>display()</b></i> отсутствует информация о типе 
последовательности, и в этом проявляется истинная мощь итераторов: 
операция перемещения по последовательности отделяется от фактической 
структуры этой последовательности. Иногда говорят, что итераторы 
унифицируют доступ к контейнерам.
</p>
<h2><span class="mw-headline" id="Listlterator"><b>Listlterator</b></span></h2>
<p>Listlterator — более мощная разновидность <i><b>Iterator</b></i>, поддерживаемая только классами <i><b>List</b></i>. Если <i><b>Iterator</b></i> поддерживает перемещение только вперед, <i><b>ListIterator</b></i>
 является двусторонним. Кроме того, он может выдавать индексы следующего
 и предыдущего элементов по отношению к текущей позиции итератора в 
списке и заменять последний посещенный элемент методом <i><b>set()</b></i>. Вызов <i><b>listIterator()</b></i> возвращает <i><b>ListIterator</b></i>, указывающий в начало <i><b>List</b></i>, а для создания итератора <i><b>ListIterator</b></i>, изначально установленного на элемент с индексом <i><b>n</b></i>, используется вызов <i><b>listIterator(n)</b></i>. Все перечисленные возможности продемонстрированы в следующем примере:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/ListIteration.java</span>
<span class="kw2">import</span> <span class="co2">typeinfo.pets.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> ListIteration <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw166">List</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> pets = Pets.<span class="me1">arrayList</span><span class="br0">(</span><span class="nu0">8</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">ListIterator</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> it = pets.<span class="me1">listIterator</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">while</span><span class="br0">(</span>it.<span class="me1">hasNext</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>it.<span class="me1">next</span><span class="br0">(</span><span class="br0">)</span> + <span class="st0">", "</span> + it.<span class="me1">nextIndex</span><span class="br0">(</span><span class="br0">)</span> +
        <span class="st0">", "</span> + it.<span class="me1">previousIndex</span><span class="br0">(</span><span class="br0">)</span> + <span class="st0">"; "</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// В обратном направлении</span>
    <span class="kw1">while</span><span class="br0">(</span>it.<span class="me1">hasPrevious</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>it.<span class="me1">previous</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">id</span><span class="br0">(</span><span class="br0">)</span> + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>pets<span class="br0">)</span><span class="sy0">;</span>	
    it = pets.<span class="me1">listIterator</span><span class="br0">(</span><span class="nu0">3</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">while</span><span class="br0">(</span>it.<span class="me1">hasNext</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
      it.<span class="me1">next</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      it.<span class="me1">set</span><span class="br0">(</span>Pets.<span class="me1">randomPet</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>pets<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>Rat, 1, 0; Manx, 2, 1; Cymric, 3, 2; Mutt, 4, 3; Pug, 5, 4; Cymric, 6, 5; Pug, 7, 6; Manx, 8, 7;
7 6 5 4 3 2 1 0
[Rat, Manx, Cymric, Mutt, Pug, Cymric, Pug, Manx]
[Rat, Manx, Cymric, Cymric, Rat, EgyptianMau, Hamster, EgyptianMau]
</pre>
<p>&lt;/spoiler&gt;
Метод <i><b>Pets.randomPet()</b></i> используется для замены всех объектов <i><b>Pet</b></i> в списке, начиная с позиции 3 и далее.
</p>
<h2><span class="mw-headline" id="LinkedList"><b>LinkedList</b></span></h2>
<p><i><b>LinkedList</b></i> тоже реализует базовый интерфейс <i><b>List</b></i>, как и <i><b>ArrayList</b></i>, но выполняет некоторые операции (например, вставку и удаление в середине списка) более эффективно, чем <i><b>ArrayList</b></i>. И наоборот, операции произвольного доступа выпол­няются им с меньшей эффективностью.
Класс <i><b>LinkedList</b></i> также содержит методы, позволяющие использовать его в качестве стека, очереди (<i><b>Queue</b></i>)
 или двусторонней очереди (дека).
Некоторые из этих методов являются псевдонимами или модификациями для 
получения имен, более знакомых в контексте некоторого использования. 
Например, методы <i><b>getFirst()</b></i> и <i><b>element()</b></i> идентичны — они возвращают начало (первый элемент) списка без его удаления и выдают исключение <i><b>NoSuchElementException</b></i> для пустого списка. Метод <i><b>peek()</b></i> представляет собой небольшую модификацию этих двух методов: он возвращает <i><b>null</b></i> для пустого списка.
Метод <i><b>addFirst()</b></i> вставляет элемент в начало списка. Метод <i><b>offer()</b></i> делает то же, что <i><b>add()</b></i> и <i><b>addLast()</b></i> — он добавляет элемент в конец списка. Метод <i><b>removeLast(</b></i>) удаляет и возвращает последний элемент списка.
Следующий пример демонстрирует схожие и различающиеся аспекты этих методов:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/LinkedListFeatures.java</span>
<span class="kw2">import</span> <span class="co2">typeinfo.pets.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="kw2">static</span> <span class="co2">net.mindview.util.Print.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> LinkedListFeatures <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">LinkedList</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> pets =
      <span class="kw2">new</span> <span class="kw46">LinkedList</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span><span class="br0">(</span>Pets.<span class="me1">arrayList</span><span class="br0">(</span><span class="nu0">5</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span>pets<span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Идентично</span>
    print<span class="br0">(</span><span class="st0">"pets.getFirst(): "</span> + pets.<span class="me1">getFirst</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"pets.element(): "</span> + pets.<span class="me1">element</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Различие проявляется только для пустых списков:</span>
    print<span class="br0">(</span><span class="st0">"pets.peek(): "</span> + pets.<span class="me1">peek</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Идентично, удаление и возврат первого элемента.</span>
    print<span class="br0">(</span><span class="st0">"pets.remove(): "</span> + pets.<span class="me1">remove</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"pets.removeFirst(): "</span> + pets.<span class="me1">removeFirst</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Различие проявляется только для пустых списков:</span>
    print<span class="br0">(</span><span class="st0">"pets.poll(): "</span> + pets.<span class="me1">poll</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span>pets<span class="br0">)</span><span class="sy0">;</span>
    pets.<span class="me1">addFirst</span><span class="br0">(</span><span class="kw2">new</span> Rat<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"After addFirst(): "</span> + pets<span class="br0">)</span><span class="sy0">;</span>
    pets.<span class="me1">offer</span><span class="br0">(</span>Pets.<span class="me1">randomPet</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"After offer(): "</span> + pets<span class="br0">)</span><span class="sy0">;</span>
    pets.<span class="me1">add</span><span class="br0">(</span>Pets.<span class="me1">randomPet</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"After add(): "</span> + pets<span class="br0">)</span><span class="sy0">;</span>
    pets.<span class="me1">addLast</span><span class="br0">(</span><span class="kw2">new</span> Hamster<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"After addLast(): "</span> + pets<span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"pets.removeLast(): "</span> + pets.<span class="me1">removeLast</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>[Rat, Manx, Cymric, Mutt, Pug]
pets.getFirst(): Rat
pets.element(): Rat
pets.peek(): Rat
pets.remove(): Rat
pets.removeFirst(): Manx
pets.poll(): Cymric
[Mutt, Pug]
After addFirst(): [Rat, Mutt, Pug]
After offer(): [Rat, Mutt, Pug, Cymric]
After add(): [Rat, Mutt, Pug, Cymric, Pug]
After addLast(): [Rat, Mutt, Pug, Cymric, Pug, Hamster]
pets.removeLast(): Hamster
</pre>
<p>&lt;/spoiler&gt;
Результат <i><b>Pets.arrayList()</b></i> передается конструктору <i><b>LinkedList</b></i> для заполнения. Присмотревшись к интерфейсу <i><b>Queue</b></i>, вы найдете в нем методы <i><b>element()</b></i>, <i><b>offer()</b></i>, <i><b>peek()</b></i>, <i><b>poll()</b></i> и <i><b>remove()</b></i>, добавленные в <i><b>LinkedList</b></i> для использования в реализации очереди (см. далее).
</p>
<h2><span class="mw-headline" id=".D0.A1.D1.82.D0.B5.D0.BA"><b>Стек</b></span></h2>
<p>Стек часто называют контейнером, работающим по принципу «первым вошел, последним вышел» (<i>LIFO</i>). То есть элемент, последним занесенный в стек, будет первым, полученным при извлечении из стека.
В классе <i><b>LinkedList</b></i> имеются методы, напрямую реализующие функциональность стека, поэтому вы просто используете <i><b>LinkedList</b></i>, не создавая для стека новый класс. Впрочем, иногда отдельный класс для контейнера-стека лучше справляется с задачей:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: net/mindview/util/Stack.java</span>
<span class="co1">// Making a stack from a LinkedList.</span>
<span class="kw2">package</span> <span class="co2">net.mindview.util</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">java.util.LinkedList</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> <span class="kw46">Stack</span><span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> <span class="br0">{</span>
  <span class="kw2">private</span> <span class="kw46">LinkedList</span><span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> storage = <span class="kw2">new</span> <span class="kw46">LinkedList</span><span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="kw2">public</span> <span class="kw3">void</span> push<span class="br0">(</span>T v<span class="br0">)</span> <span class="br0">{</span> storage.<span class="me1">addFirst</span><span class="br0">(</span>v<span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
  <span class="kw2">public</span> T peek<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> storage.<span class="me1">getFirst</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
  <span class="kw2">public</span> T pop<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> storage.<span class="me1">removeFirst</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw3">boolean</span> empty<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> storage.<span class="me1">isEmpty</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw21">String</span> toString<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> storage.<span class="me1">toString</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>Это простейший пример определения класса с использованием параметризации. Суффикс <i><b>&lt;Т&gt;</b></i> после имени класса сообщает компилятору, что тип является параметризованным по типу <i><b>Т</b></i> — при использовании класса на место <i><b>Т</b></i> будет подставлен фактический тип. Фактически такое определение означает: «Мы определяем класс <i><b>Stack</b></i> для хранения объектов типа <i><b>Т</b></i>». <i><b>Stack</b></i> реализуется на базе <i><b>LinkedList</b></i>, также предназначенного для хранения типа <i><b>Т</b></i>. Обратите внимание: метод <i><b>push()</b></i> получает объект типа <i><b>Т</b></i>, а методы <i><b>реек()</b></i> и <i><b>рор()</b></i> возвращают объект типа <i><b>Т</b></i>. Метод <i><b>реек()</b></i> возвращает верхний элемент без извлечения из стека, а метод <i><b>рор()</b></i> удаляет и возвращает верхний элемент. Простой пример использования нового класса <i><b>Stack</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/StackTest.java</span>
<span class="kw2">import</span> <span class="co2">net.mindview.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> StackTest <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">Stack</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> stack = <span class="kw2">new</span> <span class="kw46">Stack</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw21">String</span> s&nbsp;: <span class="st0">"My dog has fleas"</span>.<span class="me1">split</span><span class="br0">(</span><span class="st0">" "</span><span class="br0">)</span><span class="br0">)</span>
      stack.<span class="me1">push</span><span class="br0">(</span>s<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">while</span><span class="br0">(</span><span class="sy0">!</span>stack.<span class="me1">empty</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>stack.<span class="me1">pop</span><span class="br0">(</span><span class="br0">)</span> + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>fleas has dog My
</pre>
<p>&lt;/spoiler&gt;
Если вы хотите использовать класс <i><b>Stack</b></i> в своем коде, вам 
придется либо полностью указать пакет, либо изменить имя класса при 
создании объекта; в противном случае, скорее всего, возникнет конфликт с
 классом <i><b>Stack</b></i> из пакета <i><b>java.util</b></i>. Пример использования имен пакетов при импортировании <i><b>java.util.*</b></i> в предыдущем примере:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/StackCollision.java</span>
<span class="kw2">import</span> <span class="co2">net.mindview.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> StackCollision <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    net.<span class="me1">mindview</span>.<span class="me1">util</span>.<span class="kw46">Stack</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> stack =
      <span class="kw2">new</span> net.<span class="me1">mindview</span>.<span class="me1">util</span>.<span class="kw46">Stack</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw21">String</span> s&nbsp;: <span class="st0">"My dog has fleas"</span>.<span class="me1">split</span><span class="br0">(</span><span class="st0">" "</span><span class="br0">)</span><span class="br0">)</span>
      stack.<span class="me1">push</span><span class="br0">(</span>s<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">while</span><span class="br0">(</span><span class="sy0">!</span>stack.<span class="me1">empty</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>stack.<span class="me1">pop</span><span class="br0">(</span><span class="br0">)</span> + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    java.<span class="me1">util</span>.<span class="kw46">Stack</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> stack2 =
      <span class="kw2">new</span> java.<span class="me1">util</span>.<span class="kw46">Stack</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw21">String</span> s&nbsp;: <span class="st0">"My dog has fleas"</span>.<span class="me1">split</span><span class="br0">(</span><span class="st0">" "</span><span class="br0">)</span><span class="br0">)</span>
      stack2.<span class="me1">push</span><span class="br0">(</span>s<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">while</span><span class="br0">(</span><span class="sy0">!</span>stack2.<span class="me1">empty</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>stack2.<span class="me1">pop</span><span class="br0">(</span><span class="br0">)</span> + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
fleas has dog My
fleas has dog My
&lt;/spoiler&gt;
В <i><b>java.util</b></i> нет общего интерфейса <i><b>Stack</b></i> — вероятно, из-за того, что имя было задействовано в исходной, неудачно спроектированной версии <i><b>java.util.Stack</b></i> для <i>Java</i> 1.0. Хотя класс <i><b>java.util.Stack</b></i> существует, <i><b>LinkedList</b></i> обеспечивает более качественную реализацию стека, и решение <i><b>net.mindview.util.Stack</b></i> является предпочтительным.
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.9C.D0.BD.D0.BE.D0.B6.D0.B5.D1.81.D1.82.D0.B2.D0.BE"><b>Множество</b></span></h2>
<p>В множествах (<i><b>Set</b></i>) каждое значение может храниться 
только в одном экземпляре. Попытки добавить новый экземпляр 
эквивалентного объекта блокируются. Множества часто используются для 
проверки принадлежности, чтобы вы могли легко проверить, принадлежит ли 
объект заданному множеству. Следовательно, важнейшей операцией <i><b>Set</b></i> является операция поиска, поэтому на практике обычно выбирается реализация <i><b>HashSet</b></i>, оптимизированная для быстрого поиска.
</p><p><i><b>Set</b></i> имеет такой же интерфейс, что и <i><b>Collection</b></i>. В сущности, <i><b>Set</b></i> и является <i><b>Collection</b></i>,
 но обладает несколько иным поведением (кстати, идеальный пример 
использования наследования и полиморфизма: выражение разных концепций 
поведения). Пример использования <i><b>HashSet</b></i> с объектами <i><b>Integer</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/SetOfInteger.java</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> SetOfInteger <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">Random</span> rand = <span class="kw2">new</span> <span class="kw46">Random</span><span class="br0">(</span><span class="nu0">47</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Set</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span> intset = <span class="kw2">new</span> <span class="kw46">HashSet</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> <span class="nu0">10000</span><span class="sy0">;</span> i++<span class="br0">)</span>
      intset.<span class="me1">add</span><span class="br0">(</span>rand.<span class="me1">nextInt</span><span class="br0">(</span><span class="nu0">30</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>intset<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<pre>&lt;spoiler text="Output:"&gt;
[15, 8, 23, 16, 7, 22, 9, 21, 6, 1, 29, 14, 24, 4, 19, 26, 11, 18, 3, 12, 27, 17, 2, 13, 
28, 20, 25, 10, 5, 0]
</pre>
<p>&lt;/spoiler&gt;
В множество включаются десять тысяч случайных чисел от <i>0</i> до <i>29</i>;
 естественно, числа должны многократно повторяться. Но при этом мы 
видим, что в результатах каждое число присутствует только в одном 
экземпляре.
</p><p>Также обратите внимание на непредсказуемый порядок следования чисел в выводе. Это объясняется тем, что <i><b>HashSet</b></i> использует хеширование для ускорения выборки. Порядок, поддерживаемый <i><b>HashSet</b></i>, отличается от порядка <i><b>TreeSet</b></i> или <i><b>LinkedHashSet</b></i>,
 поскольку каждая реализация упорядочивает элементы по-своему. Если вы 
хотите, чтобы результат был отсортирован, воспользуйтесь <i><b>TreeSet</b></i> вместо <i><b>HashSet</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/SortedSetOfInteger.java</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> SortedSetOfInteger <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">Random</span> rand = <span class="kw2">new</span> <span class="kw46">Random</span><span class="br0">(</span><span class="nu0">47</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">SortedSet</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span> intset = <span class="kw2">new</span> <span class="kw46">TreeSet</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> <span class="nu0">10000</span><span class="sy0">;</span> i++<span class="br0">)</span>
      intset.<span class="me1">add</span><span class="br0">(</span>rand.<span class="me1">nextInt</span><span class="br0">(</span><span class="nu0">30</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>intset<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 
23, 24, 25, 26, 27, 28, 29]
</pre>
<p>&lt;/spoiler&gt;
Одной из наиболее распространенных операций со множествами является проверка принадлежности методом <i><b>contains()</b></i>, но существуют и другие операции, которые напомнят вам диаграммы Венна из школьного курса:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/SetOperations.java</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="kw2">static</span> <span class="co2">net.mindview.util.Print.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> SetOperations <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">Set</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> set1 = <span class="kw2">new</span> <span class="kw46">HashSet</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Collections</span>.<span class="me1">addAll</span><span class="br0">(</span>set1,
      <span class="st0">"A B C D E F G H I J K L"</span>.<span class="me1">split</span><span class="br0">(</span><span class="st0">" "</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    set1.<span class="me1">add</span><span class="br0">(</span><span class="st0">"M"</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"H: "</span> + set1.<span class="me1">contains</span><span class="br0">(</span><span class="st0">"H"</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"N: "</span> + set1.<span class="me1">contains</span><span class="br0">(</span><span class="st0">"N"</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Set</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> set2 = <span class="kw2">new</span> <span class="kw46">HashSet</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Collections</span>.<span class="me1">addAll</span><span class="br0">(</span>set2, <span class="st0">"H I J K L"</span>.<span class="me1">split</span><span class="br0">(</span><span class="st0">" "</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"set2 in set1: "</span> + set1.<span class="me1">containsAll</span><span class="br0">(</span>set2<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    set1.<span class="me1">remove</span><span class="br0">(</span><span class="st0">"H"</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"set1: "</span> + set1<span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"set2 in set1: "</span> + set1.<span class="me1">containsAll</span><span class="br0">(</span>set2<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    set1.<span class="me1">removeAll</span><span class="br0">(</span>set2<span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"set2 removed from set1: "</span> + set1<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Collections</span>.<span class="me1">addAll</span><span class="br0">(</span>set1, <span class="st0">"X Y Z"</span>.<span class="me1">split</span><span class="br0">(</span><span class="st0">" "</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"'X Y Z' added to set1: "</span> + set1<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>H: true
N: false
set2 in set1: true
set1: [D, K, C, B, L, G, I, M, A, F, J, E]
set2 in set1: false
set2 removed from set1: [D, C, B, G, M, A, F, E]
'X Y Z' added to set1: [Z, D, C, B, G, M, A, F, Y, X, E]
</pre>
<p>&lt;/spoiler&gt;
Имена методов говорят за себя. Информацию о других методах <i><b>Set</b></i> можно найти в документации <i>JDK</i>.
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.9A.D0.B0.D1.80.D1.82.D0.B0"><b>Карта</b></span></h2>
<p>Возможность отображения одних объектов на другие (ассоциация) 
чрезвычайно полезна при решении широкого класса задач программирования. В
 качестве примера рассмотрим программу, анализирующую качество 
распределения класса <i>Java</i> <i><b>Random</b></i>. В идеале класс <i><b>Random</b></i>
 должен выдавать абсолютно равномерное распределение чисел, но чтобы 
убедиться в этом, необходимо сгенерировать большое количество случайных 
чисел и подсчитать их количество в разных интервалах. Множества упрощают
 эту задачу: ключом в данном случае является число, сгенерированное при 
помощи <i><b>Random</b></i>, а значением — количество его вхождений:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/Statistics.java</span>
<span class="co1">// Простой пример использования HashMap</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> Statistics <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">Random</span> rand = <span class="kw2">new</span> <span class="kw46">Random</span><span class="br0">(</span><span class="nu0">47</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Map</span><span class="sy0">&lt;</span><span class="kw21">Integer</span>,<span class="kw21">Integer</span><span class="sy0">&gt;</span> m =
      <span class="kw2">new</span> <span class="kw46">HashMap</span><span class="sy0">&lt;</span><span class="kw21">Integer</span>,<span class="kw21">Integer</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> <span class="nu0">10000</span><span class="sy0">;</span> i++<span class="br0">)</span> <span class="br0">{</span>
      <span class="co1">// Получение случайного числа от 0 до 20.</span>
      <span class="kw3">int</span> r = rand.<span class="me1">nextInt</span><span class="br0">(</span><span class="nu0">20</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw21">Integer</span> freq = m.<span class="me1">get</span><span class="br0">(</span>r<span class="br0">)</span><span class="sy0">;</span>
      m.<span class="me1">put</span><span class="br0">(</span>r, freq == <span class="kw4">null</span> <span class="sy0">?</span> <span class="nu0">1</span>&nbsp;: freq + <span class="nu0">1</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>m<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>{15=497. 4=481. 19=464. 8=468. 11=531. 16=533. 18=478. 3=508, 7=471. 12=521. 17=509. 2=489,  
13=506, 9=549, 6=519, 1=502, 14=477, 10=513, 5=503, 0=481}
</pre>
<p>&lt;/spoiler&gt; 
В <i><b>main()</b></i> механизм автоматической упаковки преобразует 
случайно сгенерированое целое число в ссылку на Integer, которая может 
использоваться с <i><b>HashMap</b></i> (контейнеры не могут использоваться для хранения примитивов). 
</p><p>Метод <i><b>get()</b></i> возвращает <i><b>null</b></i>, если элемент отсутствует в контейнере (то есть если число было сгенерировано впервые. В противном случае метод <i><b>get()</b></i> возвращает значение <i><b>Integer</b></i>, связанное с ключом, и последнее увеличивается на <i>1</i> (автоматическая упаковка снова упрощает вычисления, но в действительности при этом выполняются преобразования к <i><b>Integer</b></i> и обратно).
</p><p>Следующий пример демонстрирует поиск объектов <i><b>Pet</b></i> по строковому описанию <i><b>String</b></i>. Он также показывает, как проверить присутствие некоторого ключа или значения в <i><b>Map</b></i> методами <i><b>containsKey()</b></i> и <i><b>containsValue()</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/PetMap.java</span>
<span class="kw2">import</span> <span class="co2">typeinfo.pets.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="kw2">static</span> <span class="co2">net.mindview.util.Print.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> PetMap <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">Map</span><span class="sy0">&lt;</span><span class="kw21">String</span>,Pet<span class="sy0">&gt;</span> petMap = <span class="kw2">new</span> <span class="kw46">HashMap</span><span class="sy0">&lt;</span><span class="kw21">String</span>,Pet<span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    petMap.<span class="me1">put</span><span class="br0">(</span><span class="st0">"My Cat"</span>, <span class="kw2">new</span> Cat<span class="br0">(</span><span class="st0">"Molly"</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    petMap.<span class="me1">put</span><span class="br0">(</span><span class="st0">"My Dog"</span>, <span class="kw2">new</span> Dog<span class="br0">(</span><span class="st0">"Ginger"</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    petMap.<span class="me1">put</span><span class="br0">(</span><span class="st0">"My Hamster"</span>, <span class="kw2">new</span> Hamster<span class="br0">(</span><span class="st0">"Bosco"</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span>petMap<span class="br0">)</span><span class="sy0">;</span>
    Pet dog = petMap.<span class="me1">get</span><span class="br0">(</span><span class="st0">"My Dog"</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span>dog<span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span>petMap.<span class="me1">containsKey</span><span class="br0">(</span><span class="st0">"My Dog"</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span>petMap.<span class="me1">containsValue</span><span class="br0">(</span>dog<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>{My Cat=Cat Molly, My Hamster=Hamster Bosco, My Dog=Dog Ginger}
Dog Ginger
true
true
</pre>
<p>&lt;/spoiler&gt;
<i><b>Map</b></i>, по аналогии с массивами и <i><b>Collection</b></i>, легко расширяются до нескольких измерений; достаточно создать <i><b>Map</b></i> со значениями типа <i><b>Map</b></i> (причем значениями этих <i><b>Map</b></i> могут быть другие контейнеры, и даже другие <i><b>Map</b></i>).
 Контейнеры легко комбинируются друг с другом, что позволяет быстро 
создавать сложные структуры данных. Например, если нам потребуется 
сохранить информацию о владельцах сразу нескольких домашних животных, 
для этого будет достаточно создать контейнер <i><b>Map&lt;Person,List&lt;Pet&gt;&gt;</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/MapOfList.java</span>
<span class="kw2">package</span> <span class="co2">holding</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">typeinfo.pets.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="kw2">static</span> <span class="co2">net.mindview.util.Print.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> MapOfList <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw46">Map</span><span class="sy0">&lt;</span>Person, <span class="kw166">List</span><span class="sy0">&lt;?</span> <span class="kw2">extends</span> Pet<span class="sy0">&gt;&gt;</span>
    petPeople = <span class="kw2">new</span> <span class="kw46">HashMap</span><span class="sy0">&lt;</span>Person, <span class="kw166">List</span><span class="sy0">&lt;?</span> <span class="kw2">extends</span> Pet<span class="sy0">&gt;&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="kw2">static</span> <span class="br0">{</span>
    petPeople.<span class="me1">put</span><span class="br0">(</span><span class="kw2">new</span> Person<span class="br0">(</span><span class="st0">"Dawn"</span><span class="br0">)</span>,
      <span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span><span class="kw2">new</span> Cymric<span class="br0">(</span><span class="st0">"Molly"</span><span class="br0">)</span>,<span class="kw2">new</span> Mutt<span class="br0">(</span><span class="st0">"Spot"</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    petPeople.<span class="me1">put</span><span class="br0">(</span><span class="kw2">new</span> Person<span class="br0">(</span><span class="st0">"Kate"</span><span class="br0">)</span>,
      <span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span><span class="kw2">new</span> Cat<span class="br0">(</span><span class="st0">"Shackleton"</span><span class="br0">)</span>,
        <span class="kw2">new</span> Cat<span class="br0">(</span><span class="st0">"Elsie May"</span><span class="br0">)</span>, <span class="kw2">new</span> Dog<span class="br0">(</span><span class="st0">"Margrett"</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    petPeople.<span class="me1">put</span><span class="br0">(</span><span class="kw2">new</span> Person<span class="br0">(</span><span class="st0">"Marilyn"</span><span class="br0">)</span>,
      <span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span>
       <span class="kw2">new</span> Pug<span class="br0">(</span><span class="st0">"Louie aka Louis Snorkelstein Dupree"</span><span class="br0">)</span>,
       <span class="kw2">new</span> Cat<span class="br0">(</span><span class="st0">"Stanford aka Stinky el Negro"</span><span class="br0">)</span>,
       <span class="kw2">new</span> Cat<span class="br0">(</span><span class="st0">"Pinkola"</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>	
    petPeople.<span class="me1">put</span><span class="br0">(</span><span class="kw2">new</span> Person<span class="br0">(</span><span class="st0">"Luke"</span><span class="br0">)</span>,
      <span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span><span class="kw2">new</span> Rat<span class="br0">(</span><span class="st0">"Fuzzy"</span><span class="br0">)</span>, <span class="kw2">new</span> Rat<span class="br0">(</span><span class="st0">"Fizzy"</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    petPeople.<span class="me1">put</span><span class="br0">(</span><span class="kw2">new</span> Person<span class="br0">(</span><span class="st0">"Isaac"</span><span class="br0">)</span>,
      <span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span><span class="kw2">new</span> Rat<span class="br0">(</span><span class="st0">"Freckly"</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    print<span class="br0">(</span><span class="st0">"People: "</span> + petPeople.<span class="me1">keySet</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    print<span class="br0">(</span><span class="st0">"Pets: "</span> + petPeople.<span class="me1">values</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span>Person person&nbsp;: petPeople.<span class="me1">keySet</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
      print<span class="br0">(</span>person + <span class="st0">" has:"</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw1">for</span><span class="br0">(</span>Pet pet&nbsp;: petPeople.<span class="me1">get</span><span class="br0">(</span>person<span class="br0">)</span><span class="br0">)</span>
        print<span class="br0">(</span><span class="st0">"    "</span> + pet<span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;	
</p>
<pre>People: [Person Luke, Person Marilyn, Person Isaac, Person Dawn, Person Kate]
Pets: [[Rat Fuzzy, Rat Fizzy], [Pug Louie aka Louis Snorkelstein Dupree, Cat Stanford aka Stinky
el Negro, Cat Pinkola], [Rat Freckly], [Cymric Molly, Mutt Spot], [Cat Shackleton, Cat Elsie May,
Dog Margrett]]
Person Luke has:
   Rat Fuzzy
   Rat Fizzy
Person Marilyn has:
   Pug Louie aka Louis Snorkelstein Dupree
   Cat Stanford aka Stinky el Negro
   Cat Pinkola
Person Isaac has:
   Rat Freckly
Person Dawn has:
   Cymric Molly
   Mutt Spot
Person Kate has:
   Cat Shackleton
   Cat Elsie May
   Dog Margrett
</pre>
<p>&lt;/spoiler&gt;
<i><b>Map</b></i> может вернуть множество (<i><b>Set</b></i>) своих ключей, коллекцию (<i><b>Collection</b></i>) значений или множество (<i><b>Set</b></i>) всех пар «ключ-значение». Метод <i><b>keySet()</b></i> создает множество всех ключей, которое затем используется в синтаксисе <i><b>foreach</b></i> для перебора <i><b>Map</b></i>.
</p>
<h2><span class="mw-headline" id=".D0.9E.D1.87.D0.B5.D1.80.D0.B5.D0.B4.D1.8C"><b>Очередь</b></span></h2>
<p>Очередь обычно представляет собой контейнер, работающий по принципу «первым вошел, первым вышел» (<i>FIFO</i>).
 Иначе говоря, элементы заносятся в очередь с одного «конца» и 
извлекаются с другого в порядке их поступления. Очереди часто 
применяются для реализации надежной передачи объектов между разными 
областями программы.
Класс <i><b>LinkedList</b></i> содержит методы, поддерживающие поведение очереди, и реализует интерфейс <i><b>Queue</b></i>, поэтому <i><b>LinkedList</b></i> может использоваться в качестве реализации <i><b>Queue</b></i>. В следующем примере <i><b>LinkedList</b></i> повышается восходящим преобразованием до <i><b>Queue</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/QueueDemo.java</span>
<span class="co1">// Восходящее преобразование LinkedList в Queue</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> QueueDemo <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> printQ<span class="br0">(</span><span class="kw46">Queue</span> queue<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw1">while</span><span class="br0">(</span>queue.<span class="me1">peek</span><span class="br0">(</span><span class="br0">)</span> <span class="sy0">!</span>= <span class="kw4">null</span><span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>queue.<span class="me1">remove</span><span class="br0">(</span><span class="br0">)</span> + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">Queue</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span> queue = <span class="kw2">new</span> <span class="kw46">LinkedList</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Random</span> rand = <span class="kw2">new</span> <span class="kw46">Random</span><span class="br0">(</span><span class="nu0">47</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> <span class="nu0">10</span><span class="sy0">;</span> i++<span class="br0">)</span>
      queue.<span class="me1">offer</span><span class="br0">(</span>rand.<span class="me1">nextInt</span><span class="br0">(</span>i + <span class="nu0">10</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    printQ<span class="br0">(</span>queue<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Queue</span><span class="sy0">&lt;</span><span class="kw21">Character</span><span class="sy0">&gt;</span> qc = <span class="kw2">new</span> <span class="kw46">LinkedList</span><span class="sy0">&lt;</span><span class="kw21">Character</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">char</span> c&nbsp;: <span class="st0">"Brontosaurus"</span>.<span class="me1">toCharArray</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>
      qc.<span class="me1">offer</span><span class="br0">(</span>c<span class="br0">)</span><span class="sy0">;</span>
    printQ<span class="br0">(</span>qc<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>8 1 1 1 5 14 3 1 0 1
B r o n t o s a u r u s
</pre>
<p>&lt;/spoiler&gt;
Метод <i><b>offer()</b></i>, один из методов <i><b>Queue</b></i>, вставляет элемент в конец очереди, а если вставка невозможна — возвращает <i><b>false</b></i>. Методы <i><b>реек()</b></i> и <i><b>element()</b></i> возвращают начальный элемент без его удаления из очереди, но <i><b>реек()</b></i> для пустой очереди возвращает <i><b>null</b></i>, a <i><b>element()</b></i> выдает исключение <i><b>NoSuchElementException</b></i>. Методы <i><b>poll()</b></i> и <i><b>remove()</b></i> удаляют и возвращают начальный элемент очереди, но <i><b>poll()</b></i> для пустой очереди возвращает <i><b>null</b></i>, a <i><b>remove()</b></i> выдает <i><b>NoSuchElementException</b></i>.
Автоматическая упаковка преобразует результат <i><b>int</b></i> вызова <i><b>nextInt()</b></i> в объект <i><b>Integer</b></i>, необходимый для <i><b>queue</b></i>, a <i><b>char с </b></i>— в объект <i><b>Character</b></i>, необходимый для <i><b>qc</b></i>. Интерфейс <i><b>Queue</b></i> сужает доступ к методам <i><b>LinkedList</b></i> так, что доступными остаются только соответствующие методы и у пользователя остается меньше возможностей для вызова методов <i><b>LinkedList</b></i> (конечно, queue можно преобразовать обратно в <i><b>LinkedList</b></i>, но это создает дополнительные затруднения).
</p><p><br>
</p>
<h2><span class="mw-headline" id="PriorityQueue"><b>PriorityQueue</b></span></h2>
<p>Принцип FIFO описывает наиболее типичную организацию очереди. Именно 
организация очереди определяет, какой элемент будет следующим для 
заданного состояния очереди. Правило FIFO означает, что следующим 
элементом будет тот, который дольше всего находится в очереди.
</p><p>В приоритетной очереди следующим элементом считается элемент, 
обладающий наивысшим приоритетом. Например, в аэропорту пассажира, 
самолет которого скоро улетит, могут пропустить без очереди. В системах 
обработки сообще­ний некоторые сообщения могут быть важнее других и 
должны обрабатываться как можно скорее, независимо от момента их 
поступления. Параметризованный класс <i><b>PriorityQueue</b></i> был добавлен в <i>Java</i> <i>SE5</i> как механизм автоматической реали­зации этого поведения.
</p><p>При помещении объекта в <i><b>PriorityQueue</b></i> вызовом <i><b>offer()</b></i>
 объект сортируется в очереди. По умолчанию используется естественный 
порядок помещения объектов в очередь, однако вы можете изменить его, 
предоставив собственную реа­лизацию <i><b>Comparator</b></i>. <i><b>PriorityQueue</b></i> гарантирует, что при вызове <i><b>peek(), poll()</b></i> или <i><b>remove()</b></i> вы получите элемент с наивысшим приоритетом.
</p><p>Создание приоритетной очереди для встроенных типов — <i><b>Integer, String, Character</b></i> и т. д. — является делом тривиальным. В следующем примере используются те же значения, что и в предыдущем, но <i><b>PriorityQueue</b></i> выдает их в другом порядке:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/PriorityQueueDemo.java</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> PriorityQueueDemo <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">PriorityQueue</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span> priorityQueue =
      <span class="kw2">new</span> <span class="kw46">PriorityQueue</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Random</span> rand = <span class="kw2">new</span> <span class="kw46">Random</span><span class="br0">(</span><span class="nu0">47</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> <span class="nu0">10</span><span class="sy0">;</span> i++<span class="br0">)</span>
      priorityQueue.<span class="me1">offer</span><span class="br0">(</span>rand.<span class="me1">nextInt</span><span class="br0">(</span>i + <span class="nu0">10</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    QueueDemo.<span class="me1">printQ</span><span class="br0">(</span>priorityQueue<span class="br0">)</span><span class="sy0">;</span>
&nbsp;
    <span class="kw166">List</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span> ints = <span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span><span class="nu0">25</span>, <span class="nu0">22</span>, <span class="nu0">20</span>,
      <span class="nu0">18</span>, <span class="nu0">14</span>, <span class="nu0">9</span>, <span class="nu0">3</span>, <span class="nu0">1</span>, <span class="nu0">1</span>, <span class="nu0">2</span>, <span class="nu0">3</span>, <span class="nu0">9</span>, <span class="nu0">14</span>, <span class="nu0">18</span>, <span class="nu0">21</span>, <span class="nu0">23</span>, <span class="nu0">25</span><span class="br0">)</span><span class="sy0">;</span>
    priorityQueue = <span class="kw2">new</span> <span class="kw46">PriorityQueue</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span><span class="br0">(</span>ints<span class="br0">)</span><span class="sy0">;</span>
    QueueDemo.<span class="me1">printQ</span><span class="br0">(</span>priorityQueue<span class="br0">)</span><span class="sy0">;</span>
    priorityQueue = <span class="kw2">new</span> <span class="kw46">PriorityQueue</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span><span class="br0">(</span>
        ints.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span>, <span class="kw46">Collections</span>.<span class="me1">reverseOrder</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    priorityQueue.<span class="me1">addAll</span><span class="br0">(</span>ints<span class="br0">)</span><span class="sy0">;</span>
    QueueDemo.<span class="me1">printQ</span><span class="br0">(</span>priorityQueue<span class="br0">)</span><span class="sy0">;</span>
&nbsp;
    <span class="kw21">String</span> fact = <span class="st0">"EDUCATION SHOULD ESCHEW OBFUSCATION"</span><span class="sy0">;</span>
    <span class="kw166">List</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> strings = <span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span>fact.<span class="me1">split</span><span class="br0">(</span><span class="st0">""</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">PriorityQueue</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> stringPQ =
      <span class="kw2">new</span> <span class="kw46">PriorityQueue</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span>strings<span class="br0">)</span><span class="sy0">;</span>
    QueueDemo.<span class="me1">printQ</span><span class="br0">(</span>stringPQ<span class="br0">)</span><span class="sy0">;</span>
    stringPQ = <span class="kw2">new</span> <span class="kw46">PriorityQueue</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span>
      strings.<span class="me1">size</span><span class="br0">(</span><span class="br0">)</span>, <span class="kw46">Collections</span>.<span class="me1">reverseOrder</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    stringPQ.<span class="me1">addAll</span><span class="br0">(</span>strings<span class="br0">)</span><span class="sy0">;</span>
    QueueDemo.<span class="me1">printQ</span><span class="br0">(</span>stringPQ<span class="br0">)</span><span class="sy0">;</span>
&nbsp;
    <span class="kw46">Set</span><span class="sy0">&lt;</span><span class="kw21">Character</span><span class="sy0">&gt;</span> charSet = <span class="kw2">new</span> <span class="kw46">HashSet</span><span class="sy0">&lt;</span><span class="kw21">Character</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">char</span> c&nbsp;: fact.<span class="me1">toCharArray</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>
      charSet.<span class="me1">add</span><span class="br0">(</span>c<span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Autoboxing</span>
    <span class="kw46">PriorityQueue</span><span class="sy0">&lt;</span><span class="kw21">Character</span><span class="sy0">&gt;</span> characterPQ =
      <span class="kw2">new</span> <span class="kw46">PriorityQueue</span><span class="sy0">&lt;</span><span class="kw21">Character</span><span class="sy0">&gt;</span><span class="br0">(</span>charSet<span class="br0">)</span><span class="sy0">;</span>
    QueueDemo.<span class="me1">printQ</span><span class="br0">(</span>characterPQ<span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>0 1 1 1 1 1 3 5 8 14
1 1 2 3 3 9 9 14 14 18 18 20 21 22 23 25 25
25 25 23 22 21 20 18 18 14 14 9 9 3 3 2 1 1
      A A B C C C D D E E E F H H I I L N N O O O O S S S T T U U U W
W U U U T T S S S O O O O N N L I I H H F E E E D D C C C B A A
 A B C D E F H I L N O S T U W
</pre>
<p>&lt;/spoiler&gt;
Мы видим, что дубликаты разрешены, а меньшие значения обладают более 
высокими приоритетами. Чтобы показать, как изменить порядок элементов 
посредством передачи собственного объекта <i><b>Comparator</b></i>, при третьем вызове кон­структора <i><b>PriorityQueue&lt;Integer&gt;</b></i> и втором — <i><b>PriorityQueue&lt;String&gt;</b></i> используется
<i><b>Comparator</b></i> с обратной сортировкой, полученный вызовом <i><b>Collections.reverseOrder()</b></i> (одно из новшеств <i>Java</i> <i>SE5</i>).
В последней части добавляется <i><b>HashSet</b></i> для уничтожения дубликатов <i><b>Character</b></i> — просто для того, чтобы пример был чуть более интересным.
<i><b>Integer, String и Character</b></i> изначально работают с <i><b>PriorityQueue</b></i>, потому что они обладают «встроенным» естественным упорядочением. Если вы хотите использовать собственный класс с <i><b>PriorityQueue</b></i>, включите дополнительную реализацию естественного упорядочения или предоставьте собственный объект <i><b>Comparator</b></i>.
</p>
<h2><span class="mw-headline" id="Collection_.D0.B8_Iterator"><b>Collection и Iterator</b></span></h2>
<p><i><b>Collection</b></i> — корневой интерфейс, описывающий общую 
функциональность всех последовательных контейнеров. Его можно 
рассматривать как «вторичный интерфейс», появившийся вследствие сходства
 между другими интерфейсами. Кроме того, класс <i><b>java.util.AbstractCollection</b></i> предоставляет реализацию <i><b>Collection</b></i> по умолчанию, поэтому вы можете создать новый подтип <i><b>AbstractCollection</b></i> без избыточного дублирования кода.
</p><p>Один из доводов в пользу интерфейсов заключается в том, что они 
позволяют создавать более универсальный код. Код, написанный для 
интерфейса, а не для его реализации, может быть применен к более 
широкому кругу объектов. Таким образом, если я пишу метод, которому при 
вызове передается <i><b>Collection</b></i>, этот метод будет работать с любым типом, реализующим <i><b>Collection</b></i>, — следовательно, если новый класс реализует <i><b>Collection</b></i>, он будет совместим с моим методом. Однако интересно заметить, что стандартная библиотека <i>C++</i> не имеет общего базового класса для своих контейнеров — вся общность контейнеров обеспечивается итераторами. Казалось бы, в <i>Java</i> будет логично последовать примеру <i>C++</i> и выражать сходство между контейнерами при помощи итераторов, а не <i><b>Collection</b></i>. Тем не менее эти два подхода взаимосвязаны, потому что реализация <i><b>Collection</b></i> также означает поддержку метода <i><b>iterator()</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/InterfaceVsIterator.java</span>
<span class="kw2">import</span> <span class="co2">typeinfo.pets.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> InterfaceVsIterator <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> display<span class="br0">(</span><span class="kw46">Iterator</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> it<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw1">while</span><span class="br0">(</span>it.<span class="me1">hasNext</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
      Pet p = it.<span class="me1">next</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>p.<span class="me1">id</span><span class="br0">(</span><span class="br0">)</span> + <span class="st0">":"</span> + p + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> display<span class="br0">(</span><span class="kw46">Collection</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> pets<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw1">for</span><span class="br0">(</span>Pet p&nbsp;: pets<span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>p.<span class="me1">id</span><span class="br0">(</span><span class="br0">)</span> + <span class="st0">":"</span> + p + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>	
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw166">List</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> petList = Pets.<span class="me1">arrayList</span><span class="br0">(</span><span class="nu0">8</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Set</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> petSet = <span class="kw2">new</span> <span class="kw46">HashSet</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span><span class="br0">(</span>petList<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Map</span><span class="sy0">&lt;</span><span class="kw21">String</span>,Pet<span class="sy0">&gt;</span> petMap =
      <span class="kw2">new</span> <span class="kw46">LinkedHashMap</span><span class="sy0">&lt;</span><span class="kw21">String</span>,Pet<span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> names = <span class="br0">(</span><span class="st0">"Ralph, Eric, Robin, Lacey, "</span> +
      <span class="st0">"Britney, Sam, Spot, Fluffy"</span><span class="br0">)</span>.<span class="me1">split</span><span class="br0">(</span><span class="st0">", "</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw3">int</span> i = <span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> names.<span class="me1">length</span><span class="sy0">;</span> i++<span class="br0">)</span>
      petMap.<span class="me1">put</span><span class="br0">(</span>names<span class="br0">[</span>i<span class="br0">]</span>, petList.<span class="me1">get</span><span class="br0">(</span>i<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    display<span class="br0">(</span>petList<span class="br0">)</span><span class="sy0">;</span>
    display<span class="br0">(</span>petSet<span class="br0">)</span><span class="sy0">;</span>
    display<span class="br0">(</span>petList.<span class="me1">iterator</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    display<span class="br0">(</span>petSet.<span class="me1">iterator</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>petMap<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>petMap.<span class="me1">keySet</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    display<span class="br0">(</span>petMap.<span class="me1">values</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    display<span class="br0">(</span>petMap.<span class="me1">values</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">iterator</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>	
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
4:Pug 6:Pug 3:Mutt 1:Manx 5:Cymric 7:Manx 2:Cymric 0:Rat
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
4:Pug 6:Pug 3:Mutt 1:Manx 5:Cymric 7:Manx 2:Cymric 0:Rat
{Ralph=Rat, Eric=Manx, Robin=Cymric, Lacey=Mutt, Britney=Pug, Sam=Cymric, Spot=Pug, Fluffy=Manx}
[Ralph, Eric, Robin, Lacey, Britney, Sam, Spot, Fluffy]
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</pre>
<p>&lt;/spoiler&gt;
Обе версии <i><b>display()</b></i> работают как с объектами <i><b>Map</b></i>, так и с подтипами <i><b>Collection</b></i>; при этом как <i><b>Collection</b></i>, так и <i><b>Iterator</b></i> изолируют методы <i><b>display()</b></i> от знания конкретной реализации используемого контейнера.
В данном случае два решения примерно равноценны. Использование <i><b>Iterator</b></i> становится предпочтительным при реализации постороннего класса, для которого реализация интерфейса <i><b>Collection</b></i> затруднена или нежелательна. Например, если мы создаем реализацию <i><b>Collection</b></i> наследованием от класса, содержащего объекты <i><b>Pet</b></i>, нам придется реализовать все методы <i><b>Collection</b></i>, даже если они не будут использоваться в методе <i><b>display()</b></i>. Хотя проблема легко решается наследованием от <i><b>AbstractCollection</b></i>, вам все равно придется реализовать <i><b>iterator()</b></i> вместе с <i><b>size()</b></i>, чтобы предоставить методы, не реализованные <i><b>AbstractCollection</b></i>, но используемые другими методами <i><b>AbstractCollection</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/CollectionSequence.java</span>
<span class="kw2">import</span> <span class="co2">typeinfo.pets.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> CollectionSequence
<span class="kw2">extends</span> <span class="kw46">AbstractCollection</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> <span class="br0">{</span>
  <span class="kw2">private</span> Pet<span class="br0">[</span><span class="br0">]</span> pets = Pets.<span class="me1">createArray</span><span class="br0">(</span><span class="nu0">8</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="kw2">public</span> <span class="kw3">int</span> size<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> pets.<span class="me1">length</span><span class="sy0">;</span> <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw46">Iterator</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> iterator<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">return</span> <span class="kw2">new</span> <span class="kw46">Iterator</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
      <span class="kw2">private</span> <span class="kw3">int</span> index = <span class="nu0">0</span><span class="sy0">;</span>
      <span class="kw2">public</span> <span class="kw3">boolean</span> hasNext<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="kw2">return</span> index <span class="sy0">&lt;</span> pets.<span class="me1">length</span><span class="sy0">;</span>
      <span class="br0">}</span>
      <span class="kw2">public</span> Pet next<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> pets<span class="br0">[</span>index++<span class="br0">]</span><span class="sy0">;</span> <span class="br0">}</span>
      <span class="kw2">public</span> <span class="kw3">void</span> remove<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="co1">// Not implemented</span>
        <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">UnsupportedOperationException</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span>
    <span class="br0">}</span><span class="sy0">;</span>
  <span class="br0">}</span>	
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    CollectionSequence c = <span class="kw2">new</span> CollectionSequence<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    InterfaceVsIterator.<span class="me1">display</span><span class="br0">(</span>c<span class="br0">)</span><span class="sy0">;</span>
    InterfaceVsIterator.<span class="me1">display</span><span class="br0">(</span>c.<span class="me1">iterator</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</pre>
<p>&lt;/spoiler&gt;
Метод <i><b>remove()</b></i> является необязательной операцией. В нашем примере реализовывать его не нужно, и в случае вызова он выдает исключение.
Из приведенного примера видно, что при реализации <i><b>Collection</b></i> вы также реализуете <i><b>iterator()</b></i>, а простая отдельная реализация <i><b>iterator()</b></i> требует чуть меньших усилий, чем наследование от <i><b>AbstractCollection</b></i>. Но, если класс уже наследует от другого класса, наследование еще и от <i><b>AbstractCollection</b></i> невозможно. В этом случае для реализации <i><b>Collection</b></i>
 придется реализовать все методы интерфейса, и тогда гораздо проще 
ограничиться наследованием и добавить возможность создания итератора:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/NonCollectionSequence.java</span>
<span class="kw2">import</span> <span class="co2">typeinfo.pets.*</span><span class="sy0">;</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> PetSequence <span class="br0">{</span>
  <span class="kw2">protected</span> Pet<span class="br0">[</span><span class="br0">]</span> pets = Pets.<span class="me1">createArray</span><span class="br0">(</span><span class="nu0">8</span><span class="br0">)</span><span class="sy0">;</span>
<span class="br0">}</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> NonCollectionSequence <span class="kw2">extends</span> PetSequence <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw46">Iterator</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span> iterator<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">return</span> <span class="kw2">new</span> <span class="kw46">Iterator</span><span class="sy0">&lt;</span>Pet<span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
      <span class="kw2">private</span> <span class="kw3">int</span> index = <span class="nu0">0</span><span class="sy0">;</span>
      <span class="kw2">public</span> <span class="kw3">boolean</span> hasNext<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="kw2">return</span> index <span class="sy0">&lt;</span> pets.<span class="me1">length</span><span class="sy0">;</span>
      <span class="br0">}</span>
      <span class="kw2">public</span> Pet next<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> pets<span class="br0">[</span>index++<span class="br0">]</span><span class="sy0">;</span> <span class="br0">}</span>
      <span class="kw2">public</span> <span class="kw3">void</span> remove<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="co1">// Not implemented</span>
        <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">UnsupportedOperationException</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span>
    <span class="br0">}</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    NonCollectionSequence nc = <span class="kw2">new</span> NonCollectionSequence<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    InterfaceVsIterator.<span class="me1">display</span><span class="br0">(</span>nc.<span class="me1">iterator</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>0:Rat 1:Manx 2:Cymric 3:Mutt 4:Pug 5:Cymric 6:Pug 7:Manx
</pre>
<p>&lt;/spoiler&gt;
Создание <i><b>Iterator</b></i> обеспечивает минимальную логическую 
привязку между последовательностью и методом, использующим эту 
последовательность, а также налагает гораздо меньше ограничений на класс
 последовательности, реализующий <i><b>Collection</b></i>.
</p><p><br>
</p>
<h2><span class="mw-headline" id=".D0.A1.D0.B8.D0.BD.D1.82.D0.B0.D0.BA.D1.81.D0.B8.D1.81_foreach_.D0.B8_.D0.B8.D1.82.D0.B5.D1.80.D0.B0.D1.82.D0.BE.D1.80.D1.8B"><b>Синтаксис foreach и итераторы</b></span></h2>
<p>До настоящего момента «синтаксис <i><b>foreach</b></i>» использовался в основном с массивами, но он также будет работать с любым объектом <i><b>Collection</b></i>. Некоторые примеры уже встречались нам при работе с <i><b>ArrayList</b></i>, но можно привести и более об­щее подтверждение:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/ForEachCollections.java</span>
<span class="co1">// Синтаксис foreach работает с любыми коллекциями</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> ForEachCollections <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">Collection</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> cs = <span class="kw2">new</span> <span class="kw46">LinkedList</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Collections</span>.<span class="me1">addAll</span><span class="br0">(</span>cs,
      <span class="st0">"Take the long way home"</span>.<span class="me1">split</span><span class="br0">(</span><span class="st0">" "</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw21">String</span> s&nbsp;: cs<span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span><span class="st0">"'"</span> + s + <span class="st0">"' "</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>'Take' 'the' 'long' 'way' 'home' 
</pre>
<p>&lt;/spoiler&gt;
Поскольку <i><b>cs</b></i> является <i><b>Collection</b></i>, этот пример показывает, что поддержка <i><b>foreach</b></i> является характеристикой всех объектов <i><b>Collection</b></i>.
Работа этой конструкции объясняется тем, что в <i>Java</i> <i>SE5</i> появился новый интерфейс <i><b>Iterable</b></i>, который содержит метод <i><b>iterator()</b></i> для создания <i><b>Iterator</b></i>, и именно интерфейс <i><b>Iterable</b></i> используется при переборе последовательности в синтаксисе <i><b>foreach</b></i>. Следовательно, создав любой класс, реализующий <i><b>Iterable</b></i>, вы сможете использовать его в синтаксисе <i><b>foreach</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/IterableClass.java</span>
<span class="co1">// Любой Iterable работает с foreach.</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> IterableClass <span class="kw2">implements</span> <span class="kw21">Iterable</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> <span class="br0">{</span>
  <span class="kw2">protected</span> <span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> words = <span class="br0">(</span><span class="st0">"And that is how "</span> +
    <span class="st0">"we know the Earth to be banana-shaped."</span><span class="br0">)</span>.<span class="me1">split</span><span class="br0">(</span><span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="kw2">public</span> <span class="kw46">Iterator</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> iterator<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">return</span> <span class="kw2">new</span> <span class="kw46">Iterator</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
      <span class="kw2">private</span> <span class="kw3">int</span> index = <span class="nu0">0</span><span class="sy0">;</span>
      <span class="kw2">public</span> <span class="kw3">boolean</span> hasNext<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="kw2">return</span> index <span class="sy0">&lt;</span> words.<span class="me1">length</span><span class="sy0">;</span>
      <span class="br0">}</span>
      <span class="kw2">public</span> <span class="kw21">String</span> next<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> words<span class="br0">[</span>index++<span class="br0">]</span><span class="sy0">;</span> <span class="br0">}</span>
      <span class="kw2">public</span> <span class="kw3">void</span> remove<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="co1">// Не реализован</span>
        <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">UnsupportedOperationException</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span>
    <span class="br0">}</span><span class="sy0">;</span>
  <span class="br0">}</span>	
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw21">String</span> s&nbsp;: <span class="kw2">new</span> IterableClass<span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>s + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>And that is how we know the Earth to be banana-shaped.
</pre>
<p>&lt;/spoiler&gt;
Метод <i><b>iterator()</b></i> возвращает экземпляр анонимной внутренней реализации <i><b>Iterator&lt;String&gt;</b></i>, последовательно доставляющей каждое слово в массиве. В <i><b>main()</b></i> мы видим, что <i><b>IterableClass</b></i> действительно работает в синтаксисе <i><b>foreach</b></i>.
В <i>Java</i> <i>SE5</i> многие классы реализуют <i><b>Iterable</b></i>, прежде всего все классы <i><b>Collection</b></i> (но не <i><b>Map</b></i>). Например, следующий код выводит все переменные окружения (<i>environment</i>) операционной системы:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/EnvironmentVariables.java</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> EnvironmentVariables <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw46">Map.<span class="me1">Entry</span></span> entry: <span class="kw21">System</span>.<span class="me1">getenv</span><span class="br0">(</span><span class="br0">)</span>.<span class="me1">entrySet</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span>entry.<span class="me1">getKey</span><span class="br0">(</span><span class="br0">)</span> + <span class="st0">": "</span> +
        entry.<span class="me1">getValue</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
  <span class="br0">}</span>
<span class="br0">}</span> <span class="coMULTI">/* (Execute to see output) */</span></pre></div></div>
<p><i><b>System.getenv()</b></i> возвращает <i><b>Map, entrySet()</b></i> создает <i><b>Set</b></i> с элементами <i><b>Map.Entry</b></i>, a <i><b>Set</b></i> поддерживает <i><b>Iterable</b></i> и поэтому может использоваться в цикле <i><b>foreach</b></i>.
Синтаксис <i><b>foreach</b></i> работает с массивами и всем, что поддерживает <i><b>Iterable</b></i>, но это не означает, что массив автоматически поддерживает <i><b>Iterable</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/ArrayIsNotIterable.java</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> ArrayIsNotIterable <span class="br0">{</span>
  <span class="kw2">static</span> <span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> <span class="kw3">void</span> test<span class="br0">(</span><span class="kw21">Iterable</span><span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> ib<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw1">for</span><span class="br0">(</span>T t&nbsp;: ib<span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>t + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    test<span class="br0">(</span><span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span><span class="nu0">1</span>, <span class="nu0">2</span>, <span class="nu0">3</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> strings = <span class="br0">{</span> <span class="st0">"A"</span>, <span class="st0">"B"</span>, <span class="st0">"C"</span> <span class="br0">}</span><span class="sy0">;</span>
    <span class="co1">// Массив работает в foreach. но не является Iterable:</span>
    <span class="co1">//! test(strings);</span>
    <span class="co1">// его необходимо явно преобразовать к Iterable:</span>
    test<span class="br0">(</span><span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span>strings<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>1 2 3 A B C
</pre>
<p>&lt;/spoiler&gt;
Попытка передачи массива в аргументе <i><b>Iterable</b></i> завершается неудачей. Автоматическое преобразование в <i><b>Iterable</b></i> не производится; его необходимо выполнять вручную.
</p>
<h2><span class="mw-headline" id=".D0.98.D0.B4.D0.B8.D0.BE.D0.BC.D0.B0_.C2.AB.D0.BC.D0.B5.D1.82.D0.BE.D0.B4-.D0.B0.D0.B4.D0.B0.D0.BF.D1.82.D0.B5.D1.80.C2.BB"><b>Идиома «метод-адаптер»</b></span></h2>
<p>Что делать, если у вас имеется существующий класс, реализующий <i><b>Iterable</b></i>, и вы хотите добавить новые способы использования этого класса в синтаксисе <i><b>foreach</b></i>?
 Допустим, вы хотите иметь возможность выбора между перебором списка 
слов в прямом или обратном направлении. Если просто воспользоваться 
наследованием от класса и переопределить метод <i><b>iterator</b></i>, 
то существующий метод будет заменен и никакого выбора не будет.
Одно из решений этой проблемы основано на использовании идиомы, которую я
 называю «методом-адаптером». Термин «адаптер» происходит от 
одноименного паттерна: вы должны предоставить интерфейс, необходимый для
 работы синтаксиса <i><b>foreach</b></i>. Если у вас имеется один 
интерфейс, а нужен другой, проблема решается написанием адаптера. В 
данном случае требуется добавить к стандартному «прямому» итератору 
обратный, так что переопределение исключено. Вместо этого мы добавим 
метод, создающий объект <i><b>Iterable</b></i>, который может использоваться в синтаксисе <i><b>foreach</b></i>. Как будет показано далее, это позволит нам предоставить несколько вариантов использования <i><b>foreach</b></i>:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/AdapterMethodIdiom.java</span>
<span class="co1">// Идиома "метод-адаптер" позволяет использовать foreach</span>
<span class="co1">// с дополнительными разновидностями Iterable.</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">class</span> ReversibleArrayList<span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> <span class="kw2">extends</span> <span class="kw46">ArrayList</span><span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> <span class="br0">{</span>
  <span class="kw2">public</span> ReversibleArrayList<span class="br0">(</span><span class="kw46">Collection</span><span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> c<span class="br0">)</span> <span class="br0">{</span> <span class="kw2">super</span><span class="br0">(</span>c<span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
  <span class="kw2">public</span> <span class="kw21">Iterable</span><span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> reversed<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">return</span> <span class="kw2">new</span> <span class="kw21">Iterable</span><span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
      <span class="kw2">public</span> <span class="kw46">Iterator</span><span class="sy0">&lt;</span>T<span class="sy0">&gt;</span> iterator<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="kw2">return</span> <span class="kw2">new</span> <span class="kw46">Iterator</span><span class="sy0">&lt;</span>T<span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
          <span class="kw3">int</span> current = size<span class="br0">(</span><span class="br0">)</span> - <span class="nu0">1</span><span class="sy0">;</span>
          <span class="kw2">public</span> <span class="kw3">boolean</span> hasNext<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> current <span class="sy0">&gt;</span> -<span class="nu0">1</span><span class="sy0">;</span> <span class="br0">}</span>
          <span class="kw2">public</span> T next<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> get<span class="br0">(</span>current--<span class="br0">)</span><span class="sy0">;</span> <span class="br0">}</span>
          <span class="kw2">public</span> <span class="kw3">void</span> remove<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="co1">// // He реализован</span>
            <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">UnsupportedOperationException</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
          <span class="br0">}</span>
        <span class="br0">}</span><span class="sy0">;</span>
      <span class="br0">}</span>
    <span class="br0">}</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span>	
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> AdapterMethodIdiom <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    ReversibleArrayList<span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> ral =
      <span class="kw2">new</span> ReversibleArrayList<span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span>
        <span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span><span class="st0">"To be or not to be"</span>.<span class="me1">split</span><span class="br0">(</span><span class="st0">" "</span><span class="br0">)</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Получаем обычный итератор, полученный при помощи iterator():</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw21">String</span> s&nbsp;: ral<span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>s + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Передаем выбранный нами Iterable</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw21">String</span> s&nbsp;: ral.<span class="me1">reversed</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>s + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>To be or not to be 
be to not or be To 
</pre>
<p>&lt;/spoiler&gt;
Если просто поместить объект <i><b>ral</b></i> в синтаксис <i><b>foreach</b></i>, мы получим (стандартный) «прямой» итератор. Но если вызвать для объекта <i><b>reversed()</b></i>, поведение изменится.
Использовав этот прием, можно добавить в пример <i><b>IterableClass.java</b></i> два метода-адаптера:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/MultiIterableClass.java</span>
<span class="co1">// Adding several Adapter Methods.</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> MultiIterableClass <span class="kw2">extends</span> IterableClass <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw21">Iterable</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> reversed<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">return</span> <span class="kw2">new</span> <span class="kw21">Iterable</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
      <span class="kw2">public</span> <span class="kw46">Iterator</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> iterator<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="kw2">return</span> <span class="kw2">new</span> <span class="kw46">Iterator</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
          <span class="kw3">int</span> current = words.<span class="me1">length</span> - <span class="nu0">1</span><span class="sy0">;</span>
          <span class="kw2">public</span> <span class="kw3">boolean</span> hasNext<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> current <span class="sy0">&gt;</span> -<span class="nu0">1</span><span class="sy0">;</span> <span class="br0">}</span>
          <span class="kw2">public</span> <span class="kw21">String</span> next<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> <span class="kw2">return</span> words<span class="br0">[</span>current--<span class="br0">]</span><span class="sy0">;</span> <span class="br0">}</span>
          <span class="kw2">public</span> <span class="kw3">void</span> remove<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span> He реализован
            <span class="kw2">throw</span> <span class="kw2">new</span> <span class="kw21">UnsupportedOperationException</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
          <span class="br0">}</span>
        <span class="br0">}</span><span class="sy0">;</span>
      <span class="br0">}</span>
    <span class="br0">}</span><span class="sy0">;</span>
  <span class="br0">}</span>	
  <span class="kw2">public</span> <span class="kw21">Iterable</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> randomized<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="kw2">return</span> <span class="kw2">new</span> <span class="kw21">Iterable</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
      <span class="kw2">public</span> <span class="kw46">Iterator</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> iterator<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="kw166">List</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span> shuffled =
          <span class="kw2">new</span> <span class="kw46">ArrayList</span><span class="sy0">&lt;</span><span class="kw21">String</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span>words<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw46">Collections</span>.<span class="me1">shuffle</span><span class="br0">(</span>shuffled, <span class="kw2">new</span> <span class="kw46">Random</span><span class="br0">(</span><span class="nu0">47</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw2">return</span> shuffled.<span class="me1">iterator</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
      <span class="br0">}</span>
    <span class="br0">}</span><span class="sy0">;</span>
  <span class="br0">}</span>	
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    MultiIterableClass mic = <span class="kw2">new</span> MultiIterableClass<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw21">String</span> s&nbsp;: mic.<span class="me1">reversed</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>s + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw21">String</span> s&nbsp;: mic.<span class="me1">randomized</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>s + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw21">String</span> s&nbsp;: mic<span class="br0">)</span>
      <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">print</span><span class="br0">(</span>s + <span class="st0">" "</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>banana-shaped. be to Earth the know we how is that And
is banana-shaped. Earth that how the be And we know to
And that is how we know the Earth to be banana-shaped.
</pre>
<p>&lt;/spoiler&gt;
Из выходных данных видно, что метод <i><b>Collections.shuffle</b></i> не изменяет исходный массив, а только переставляет ссылки в <i><b>shuffled</b></i>. Так происходит только потому, что метод <i><b>randomized()</b></i> создает для результата <i><b>Arrays.asList()</b></i> «обертку» в виде <i><b>ArrayList</b></i>. Если бы операция выполнялась непосредственно с объектом <i><b>List</b></i>, полученным от <i><b>Arrays.asList()</b></i>, то это привело бы к изменению нижележащего массива:
</p>
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr"><div class="java5 source-java5"><pre class="de1"><span class="co1">//: holding/ModifyingArraysAsList.java</span>
<span class="kw2">import</span> <span class="co2">java.util.*</span><span class="sy0">;</span>
&nbsp;
<span class="kw2">public</span> <span class="kw2">class</span> ModifyingArraysAsList <span class="br0">{</span>
  <span class="kw2">public</span> <span class="kw2">static</span> <span class="kw3">void</span> main<span class="br0">(</span><span class="kw21">String</span><span class="br0">[</span><span class="br0">]</span> args<span class="br0">)</span> <span class="br0">{</span>
    <span class="kw46">Random</span> rand = <span class="kw2">new</span> <span class="kw46">Random</span><span class="br0">(</span><span class="nu0">47</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">Integer</span><span class="br0">[</span><span class="br0">]</span> ia = <span class="br0">{</span> <span class="nu0">1</span>, <span class="nu0">2</span>, <span class="nu0">3</span>, <span class="nu0">4</span>, <span class="nu0">5</span>, <span class="nu0">6</span>, <span class="nu0">7</span>, <span class="nu0">8</span>, <span class="nu0">9</span>, <span class="nu0">10</span> <span class="br0">}</span><span class="sy0">;</span>
    <span class="kw166">List</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span> list1 =
      <span class="kw2">new</span> <span class="kw46">ArrayList</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span><span class="br0">(</span><span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span>ia<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"До перестановки&nbsp;: "</span> + list1<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Collections</span>.<span class="me1">shuffle</span><span class="br0">(</span>list1, rand<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"После перестановки&nbsp;: "</span> + list1<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Массив: "</span> + <span class="kw46">Arrays</span>.<span class="me1">toString</span><span class="br0">(</span>ia<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
&nbsp;
    <span class="kw166">List</span><span class="sy0">&lt;</span><span class="kw21">Integer</span><span class="sy0">&gt;</span> list2 = <span class="kw46">Arrays</span>.<span class="me1">asList</span><span class="br0">(</span>ia<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"До перестановки&nbsp;: "</span> + list2<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw46">Collections</span>.<span class="me1">shuffle</span><span class="br0">(</span>list2, rand<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"После перестановки&nbsp;: "</span> + list2<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw21">System</span>.<span class="me1">out</span>.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Массив: "</span> + <span class="kw46">Arrays</span>.<span class="me1">toString</span><span class="br0">(</span>ia<span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
  <span class="br0">}</span>
<span class="br0">}</span></pre></div></div>
<p>&lt;spoiler text="Output:"&gt;
</p>
<pre>До перестановки&nbsp;: [1, 2, 3. 4, 5. 6. 7. 8, 9, 10] 
После перестановки&nbsp;: [4. 6, 3, 1. 8. 7, 2, 5. 10. 9]
Массив: [1, 2. 3. 4. 5. 6. 7, 8. 9. 10]
До перестановки&nbsp;: [1, 2. 3, 4, 5. 6. 7. 8, 9, 10]
После перестановки&nbsp;: [9. 1. 6. 3. 7, 2. 5, 10, 4. 8]
Массив: [9. 1, 6. 3. 7, 2, 5. 10. 4. 8]
</pre>
<p>&lt;/spoiler&gt;
В первом случае вывод <i><b>Arrays.asList()</b></i> передается конструктору <i><b>ArrayList()</b></i>, а последний создает объект <i><b>ArrayList</b></i>, ссылающийся на элементы <i><b>ia</b></i>. Перестановка этих ссылок не изменяет массива. Но, если мы используем результат <i><b>Arrays.asList(ia)</b></i> напрямую, перестановка изменит порядок <i><b>ia</b></i>. Важно учитывать, что <i><b>Arrays.asList()</b></i> создает объект <i><b>List</b></i>, который использует нижележащий массив в качестве своей физической реализации. Если с этим объектом <i><b>List</b></i> выполняются какие-либо изменяющие операции, но вы не хотите изменения исходного массива, создайте копию в другом контейнере.
</p>
<h2><span class="mw-headline" id=".D0.A0.D0.B5.D0.B7.D1.8E.D0.BC.D0.B5"><b>Резюме</b></span></h2>
<p>В <i>Java</i> существует несколько способов хранения объектов:
</p>
<ul>
<li><span style="color:#800000">В массивах объектам назначаются числовые
 индексы. Массив содержит объекты заранее известного типа, поэтому 
преобразование типа при выборке объекта не требуется. Массив может быть 
многомерным и может использоваться для хранения примитивных типов. Тем 
не менее изменить размер созданного массива невозможно.</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">В <i><b>Collection</b></i> хранятся отдельные элементы, а в<i><b> Map</b></i>
 — пары ассоциированных элементов. Механизм параметризации позволяет 
задать тип объектов, хранимых в контейнере, поэтому поместить в 
контейнер объект неверного типа невозможно, и элементы не нуждаются в 
преобразовании типа при выборке. И <i><b>Collection</b></i>, и <i><b>Map</b></i>
 автоматически изменяются в размерах при добавлении новых элементов. В  
контейнерах не могут храниться примитивы, но механизм автоматической 
упаковки автоматически создает объектные «обертки», сохраняемые в 
контейнере.</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">В контейнере <i><b>List</b></i>, как и в массиве, объектам назначаются числовые индексы — таким образом, массивы и <i><b>List</b></i> являются упорядоченными контейнерами.</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">Используйте <i><b>ArrayList</b></i> при частом использовании произвольного доступа к элементам или <i><b>LinkedList</b></i> при частом выполнении операций вставки и удаления в середине списка.</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">Поведение очередей и стеков обеспечивается контейнером <i><b>LinkedList</b></i>.</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">Контейнер <i><b>Map</b></i> связывает с объектом не целочисленный индекс, а другой объект. Контейнеры <i><b>HashMap</b></i> оптимизированы для быстрого доступа, а контейнер <i><b>TreeMap</b></i> хранит ключи в отсортированном порядке, но уступает по скорости <i><b>HashMap</b></i>. В контейнере <i><b>LinkedHashMap</b></i> элементы хранятся в порядке вставки, но хеширование обеспечивает быстрый доступ.</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">В контейнере <i><b>Set</b></i> каждый объект может храниться только в одном экземпляре. Контейнер <i><b>HashSet</b></i> обеспечивает максимальную скорость поиска, а в <i><b>TreeSet</b></i> элементы хранятся в отсортированном порядке. В контейнере <i><b>LinkedHashSet</b></i> элементы хранятся в порядке вставки.</span>
</li>
</ul>
<ul>
<li><span style="color:#800000">Использовать старые классы <i><b>Vector, Hashtable</b></i> и <i><b>Stack</b></i> в новом коде не нужно.</span>
</li>
</ul>
<hr>
<p>Контейнеры <i>Java</i> — необходимый инструмент, которым вы будете 
постоянно пользоваться в своей повседневной работе; благодаря им ваш код
 станет более простым, мощным и эффективным. Возможно, на освоение 
некоторых аспектов контейнеров потребуется время, но вы быстро 
привыкнете к классам этой библиотеки и начнете использовать их.

</p>
                <p><br>
                </p>
                <hr>
                <p><a href="http://wikijava.it-cache.net/index.php" title="Thinking in Java 4th edition">назад в Оглавление</a>
                </p><p><br>
                </p>
<!-- 
NewPP limit report
CPU time usage: 3.696 seconds
Real time usage: 3.701 seconds
Preprocessor visited node count: 426/1000000
Preprocessor generated node count: 910/1000000
Post‐expand include size: 243/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key wjava2-wj_:pcache:idhash:25-0!*!*!!ru!*!* and timestamp 20140812171102
 -->
</div>								<div class="printfooter">
				Источник — «<a href="http://wikijava.org.ua/index.php?title=Glava_11_Thinking_in_Java_4th_edition&amp;oldid=35">http://wikijava.org.ua/index.php?title=Глава_11_Thinking_in_Java_4th_edition&amp;oldid=35</a>»				</div>
                                <div id="catlinks" class="catlinks"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D0%B8" title="Служебная:Категории">Категории</a>: <ul><li><a href="http://wikijava.org.ua/index.php?title=%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D1%8F:%D0%9A%D0%BD%D0%B8%D0%B3%D0%B8" title="Категория:Книги">Книги</a></li><li><a href="http://wikijava.org.ua/index.php?title=%D0%9A%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D1%8F:Java" title="Категория:Java">Java</a></li></ul></div></div>												<div class="visualClear"></div>
            </div>
		</div>
		<div id="mw-navigation">
			<h2>Навигация</h2>
			<div id="mw-head">
				<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
	<h3 id="p-personal-label">Персональные инструменты</h3>
	<ul>
<li id="pt-login"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:%D0%92%D1%85%D0%BE%D0%B4&amp;returnto=%D0%93%D0%BB%D0%B0%D0%B2%D0%B0+11+Thinking+in+Java+4th+edition" title="Здесь можно зарегистрироваться в системе, но это необязательно. [o]" accesskey="o">Представиться системе</a></li>	</ul>
</div>
				<div id="left-navigation">
					<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
	<h3 id="p-namespaces-label">Пространства имён</h3>
	<ul>
					<!--<li  id="ca-nstab-main" class="selected"><span><a href="index.php@title=Glava_11_Thinking_in_Java_4th_edition.html"  title="Просмотр основной страницы [c]" accesskey="c">Статья</a></span></li>-->
					<!--<li  id="ca-talk" class="new"><span><a href="http://wikijava.org.ua/index.php?title=%D0%9E%D0%B1%D1%81%D1%83%D0%B6%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5:%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_11_Thinking_in_Java_4th_edition&amp;action=edit&amp;redlink=1"  title="Обсуждение основной страницы [t]" accesskey="t">Обсуждение</a></span></li>-->
			</ul>
</div>
<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
	<h3 id="mw-vector-current-variant">
		</h3>
	<h3 id="p-variants-label"><span>Варианты</span><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
				</div>
				<div id="right-navigation">
					<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
	<h3 id="p-views-label">Просмотры</h3>
	<ul>
					<!--<li id="ca-view" class="selected"><span><a href="index.php@title=Glava_11_Thinking_in_Java_4th_edition.html" >Читать</a></span></li>-->
					<!--<li id="ca-viewsource"><span><a href="http://wikijava.org.ua/index.php?title=%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_11_Thinking_in_Java_4th_edition&amp;action=edit"  title="Эта страница защищена от изменений, но вы можете посмотреть и скопировать её исходный текст [e]" accesskey="e">Просмотр</a></span></li>-->
					<!--<li id="ca-history" class="collapsible"><span><a href="http://wikijava.org.ua/index.php?title=%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_11_Thinking_in_Java_4th_edition&amp;action=history"  title="Журнал изменений страницы [h]" accesskey="h">История</a></span></li>-->
			</ul>
</div>
<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
	<h3 id="p-cactions-label"><span>Действия</span><a href="http://wikijava.it-cache.net/index.php@title=Glava_11_Thinking_in_Java_4th_edition.html#"></a></h3>
	<div class="menu">
		<ul>
					</ul>
	</div>
</div>
<div id="p-search" role="search">
	<h3><label for="searchInput">Поиск</label></h3>
	<form action="http://wikijava.org.ua/index.php" id="searchform">
				<div id="simpleSearch">
						<input name="search" placeholder="Поиск" title="Искать в WikiJava: Wiki of Java: викифицированные книги и статьи по Java [f]" accesskey="f" id="searchInput">						<button type="submit" name="button" title="Найти страницы, содержащие указанный текст" id="searchButton"><img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2011_files/search-ltr.asc" alt="Найти" height="13" width="12"></button>								<input name="title" value="Служебная:Поиск" type="hidden">
		</div>
	</form>
</div>
				</div>
			</div>
			<div id="mw-panel">
					<!--<div id="p-logo" role="banner"><a style="background-image: url(/skins/common/images/wikijava.png);" href="index.php@title=Заглавная_страница.html"  title="Перейти на заглавную страницу"></a></div>-->
				<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
	<h3 id="p-navigation-label">Навигация</h3>
	<div class="body">
        <ul>
            <li id="n-mainpage-description"><a href="http://wikijava.org.ua/index.php?title=%D0%97%D0%B0%D0%B3%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F_%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0" title="Перейти на заглавную страницу [z]" accesskey="z">Заглавная страница</a></li>
            <li id="n-recentchanges"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:%D0%A1%D0%B2%D0%B5%D0%B6%D0%B8%D0%B5_%D0%BF%D1%80%D0%B0%D0%B2%D0%BA%D0%B8" title="Список последних изменений [r]" accesskey="r">Свежие правки</a></li>
            <li id="n-.D0.9A.D0.BD.D0.B8.D0.B3.D0.B8-Java"><a href="http://wikijava.org.ua/index.php?title=%D0%9A%D0%BD%D0%B8%D0%B3%D0%B8_Java">Книги Java</a></li>
            <li id="n-.D0.A1.D1.82.D0.B0.D1.82.D1.8C.D0.B8-Java"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D1%82%D0%B0%D1%82%D1%8C%D0%B8_Java">Статьи Java</a></li>
            <li id="n-Java-.D0.BF.D0.BE.D1.80.D1.82.D0.B0.D0.BB"><a href="http://wikijava.org.ua/index.php?title=Java-portal">Java портал</a></li>
            <li id="n-help"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D0%BF%D1%80%D0%B0%D0%B2%D0%BA%D0%B0:%D0%A1%D0%BE%D0%B4%D0%B5%D1%80%D0%B6%D0%B0%D0%BD%D0%B8%D0%B5" title="Место, где можно получить справку">Справка</a></li>
            <li id="n-.D0.A1.D1.82.D0.B0.D1.82.D0.B8.D1.81.D1.82.D0.B8.D0.BA.D0.B0"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D1%82%D0%B0%D1%82%D0%B8%D1%81%D1%82%D0%B8%D0%BA%D0%B0">Статистика</a></li>
        </ul>
	</div>
</div>
<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
	<h3 id="p-tb-label">Инструменты</h3>
	<div class="body">
		<ul>
			<li id="t-whatlinkshere"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:%D0%A1%D1%81%D1%8B%D0%BB%D0%BA%D0%B8_%D1%81%D1%8E%D0%B4%D0%B0/%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_11_Thinking_in_Java_4th_edition" title="Список всех страниц, ссылающихся на данную [j]" accesskey="j">Ссылки сюда</a></li>
			<li id="t-recentchangeslinked"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:%D0%A1%D0%B2%D1%8F%D0%B7%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5_%D0%BF%D1%80%D0%B0%D0%B2%D0%BA%D0%B8/%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_11_Thinking_in_Java_4th_edition" title="Последние изменения в страницах, на которые ссылается эта страница [k]" accesskey="k">Связанные правки</a></li>
			<li id="t-specialpages"><a href="http://wikijava.org.ua/index.php?title=%D0%A1%D0%BB%D1%83%D0%B6%D0%B5%D0%B1%D0%BD%D0%B0%D1%8F:%D0%A1%D0%BF%D0%B5%D1%86%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D1%8B" title="Список служебных страниц [q]" accesskey="q">Спецстраницы</a></li>
			<li id="t-print"><a href="http://wikijava.org.ua/index.php?title=%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_11_Thinking_in_Java_4th_edition&amp;printable=yes" rel="alternate" title="Версия этой страницы для печати [p]" accesskey="p">Версия для печати</a></li>
			<li id="t-permalink"><a href="http://wikijava.org.ua/index.php?title=%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_11_Thinking_in_Java_4th_edition&amp;oldid=35" title="Постоянная ссылка на эту версию страницы">Постоянная ссылка</a></li>
			<li id="t-info"><a href="http://wikijava.org.ua/index.php?title=%D0%93%D0%BB%D0%B0%D0%B2%D0%B0_11_Thinking_in_Java_4th_edition&amp;action=info">Сведения о странице</a></li>
		</ul>
	</div>
</div>
<div class="portal" role="navigation" id="p-.D0.94.D1.80.D1.83.D0.B3.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D1.8B" aria-labelledby="p-.D0.94.D1.80.D1.83.D0.B3.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D1.8B-label">
	<h3 id="p-.D0.94.D1.80.D1.83.D0.B3.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B5.D0.BA.D1.82.D1.8B-label">Другие проекты</h3>
	<div class="body">
		<ul>
			<li id="n-rastafara.com.ua"><a href="http://rastafara.com.ua/" rel="nofollow">rastafara.com.ua</a></li>
			<li id="n-rastafara-blog"><a href="http://sergey-rastafara.blogspot.com/" rel="nofollow">rastafara blog</a></li>
			<li id="n-rastaban"><a href="http://rastaban.com.ua/" rel="nofollow">rastaban</a></li>
		</ul>
	</div>
</div>
			</div>
		</div>
		<div id="footer" role="contentinfo">
							<ul id="footer-info">
											<li id="footer-info-lastmod"> Последнее изменение этой страницы: 21:47, 16 февраля 2014.</li>
											<li id="footer-info-viewcount">К этой странице обращались 2845 раза.</li>
											<li id="footer-info-copyright">Содержимое доступно по лицензии <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 или более поздняя</a> (если не указано иное).</li>
									</ul>
							<ul id="footer-places">
											<li id="footer-places-privacy"><a href="http://wikijava.org.ua/index.php?title=WikiJava:_Wiki_of_Java:_%D0%B2%D0%B8%D0%BA%D0%B8%D1%84%D0%B8%D1%86%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5_%D0%BA%D0%BD%D0%B8%D0%B3%D0%B8_%D0%B8_%D1%81%D1%82%D0%B0%D1%82%D1%8C%D0%B8_%D0%BF%D0%BE_Java:%D0%9F%D0%BE%D0%BB%D0%B8%D1%82%D0%B8%D0%BA%D0%B0_%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B4%D0%B5%D0%BD%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8" title="WikiJava: Wiki of Java: викифицированные книги и статьи по Java:Политика конфиденциальности">Политика конфиденциальности</a></li>
											<li id="footer-places-about"><a href="http://wikijava.org.ua/index.php?title=WikiJava:_Wiki_of_Java:_%D0%B2%D0%B8%D0%BA%D0%B8%D1%84%D0%B8%D1%86%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5_%D0%BA%D0%BD%D0%B8%D0%B3%D0%B8_%D0%B8_%D1%81%D1%82%D0%B0%D1%82%D1%8C%D0%B8_%D0%BF%D0%BE_Java:%D0%9E%D0%BF%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5" title="WikiJava: Wiki of Java: викифицированные книги и статьи по Java:Описание">Описание WikiJava: Wiki of Java: викифицированные книги и статьи по Java</a></li>
											<li id="footer-places-disclaimer"><a href="http://wikijava.org.ua/index.php?title=WikiJava:_Wiki_of_Java:_%D0%B2%D0%B8%D0%BA%D0%B8%D1%84%D0%B8%D1%86%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5_%D0%BA%D0%BD%D0%B8%D0%B3%D0%B8_%D0%B8_%D1%81%D1%82%D0%B0%D1%82%D1%8C%D0%B8_%D0%BF%D0%BE_Java:%D0%9E%D1%82%D0%BA%D0%B0%D0%B7_%D0%BE%D1%82_%D0%BE%D1%82%D0%B2%D0%B5%D1%82%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D0%B8" title="WikiJava: Wiki of Java: викифицированные книги и статьи по Java:Отказ от ответственности">Отказ от ответственности</a></li>
									</ul>
										<ul id="footer-icons" class="noprint">
					<li id="footer-copyrightico">
						<a href="http://www.gnu.org/copyleft/fdl.html"><img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2011_files/gnu-fdl.png" alt="GNU Free Documentation License 1.3 или более поздняя" height="31" width="88"></a>
					</li>
					<li id="footer-poweredbyico">
						<a href="http://www.mediawiki.org/"><img src="%D0%93%D0%BB%D0%B0%D0%B2%D0%B0%2011_files/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" height="31" width="88"></a>
					</li>
				</ul>
						<div style="clear:both"></div>
		</div>
		<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"loading","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.vector.collapsibleNav","ext.vector.collapsibleTabs","ext.vector.editWarning","ext.vector.simpleSearch","skins.vector.collapsibleNav"],null,true);
}</script>
<script>if(window.mw){
mw.loader.state({"site":"ready"});
}</script>
<!-- Served in 0.233 secs. -->
	

</body></html>